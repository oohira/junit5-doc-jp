[[running-tests]]
== ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã™ã‚‹

[[running-tests-ide]]
=== IDEã®ã‚µãƒãƒ¼ãƒˆ

[[running-tests-ide-intellij-idea]]
==== IntelliJ IDEA

IntelliJ IDEAã¯ã€ãƒãƒ¼ã‚¸ãƒ§ãƒ³2016.2ã‹ã‚‰JUnit Platformä¸Šã§ã®ãƒ†ã‚¹ãƒˆå®Ÿè¡Œã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã¾ã™ã€‚
è©³ç´°ã¯ã€
https://blog.jetbrains.com/idea/2016/08/using-junit-5-in-intellij-idea/[IntelliJ IDEAãƒ–ãƒ­ã‚°ã®æŠ•ç¨¿]
ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚ãŸã ã—ã€å®Ÿéš›ã«ã¯IntelliJ IDEA 2017.3ã¾ãŸã¯ãã‚Œã‚ˆã‚Šæ–°ã—ã„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®
åˆ©ç”¨ãŒæ¨å¥¨ã•ã‚Œã‚‹ç‚¹ã«æ³¨æ„ã—ã¦ãã ã•ã„ã€‚ã¨ã„ã†ã®ã‚‚ã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§åˆ©ç”¨ã•ã‚Œã‚‹APIãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«å¿œã˜ã¦
`junit-platform-launcher`, `junit-jupiter-engine`, `junit-vintage-engine`
ã®JARã‚’è‡ªå‹•çš„ã«ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¦ãã‚Œã‚‹ã‹ã‚‰ã§ã™ã€‚

WARNING: IntelliJ IDEAã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³2017.3ã‚ˆã‚Šå‰ã®ãƒªãƒªãƒ¼ã‚¹ã¯ã€JUnit 5
ã®ç‰¹å®šã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’åŒæ¢±ã—ã¦ã„ã‚‹ç‚¹ã«æ³¨æ„ã—ã¦ãã ã•ã„ã€‚ã‚‚ã—ã‚‚JUnit Jupiter
ã®æ–°ã—ã„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ä½¿ã„ãŸã„å ´åˆã€IDEå†…ã§ã®ãƒ†ã‚¹ãƒˆå®Ÿè¡Œã¯ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®ã‚³ãƒ³ãƒ•ãƒªã‚¯ãƒˆã§
å¤±æ•—ã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚ãã®ã‚ˆã†ãªå ´åˆã¯ã€IntelliJ IDEAã«åŒæ¢±ã•ã‚Œã¦ã„ã‚‹
JUnit 5ã‚ˆã‚Šæ–°ã—ã„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ä½¿ã†ãŸã‚ã«ã€ä»¥ä¸‹ã®æ‰‹é †ã«å¾“ã£ã¦ãã ã•ã„ã€‚

JUnit 5ã®ç•°ãªã‚‹ãƒãƒ¼ã‚¸ãƒ§ãƒ³ (ä¾‹ãˆã°ã€ {jupiter-version}) ã‚’ä½¿ã†ã«ã¯ã€
`junit-platform-launcher`, `junit-jupiter-engine`, `junit-vintage-engine`
ã®å¯¾å¿œã™ã‚‹ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®JARã‚’ã‚¯ãƒ©ã‚¹ãƒ‘ã‚¹ã«è¿½åŠ ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

.Gradleã®è¿½åŠ ã®ä¾å­˜é–¢ä¿‚
[source,groovy]
[subs=attributes+]
----
// Only needed to run tests in a version of IntelliJ IDEA that bundles older versions
testRuntime("org.junit.platform:junit-platform-launcher:{platform-version}")
testRuntime("org.junit.jupiter:junit-jupiter-engine:{jupiter-version}")
testRuntime("org.junit.vintage:junit-vintage-engine:{vintage-version}")
----

.Mavenã®è¿½åŠ ã®ä¾å­˜é–¢ä¿‚
[source,xml]
[subs=attributes+]
----
<!-- Only needed to run tests in a version of IntelliJ IDEA that bundles older versions -->
<dependency>
	<groupId>org.junit.platform</groupId>
	<artifactId>junit-platform-launcher</artifactId>
	<version>{platform-version}</version>
	<scope>test</scope>
</dependency>
<dependency>
	<groupId>org.junit.jupiter</groupId>
	<artifactId>junit-jupiter-engine</artifactId>
	<version>{jupiter-version}</version>
	<scope>test</scope>
</dependency>
<dependency>
	<groupId>org.junit.vintage</groupId>
	<artifactId>junit-vintage-engine</artifactId>
	<version>{vintage-version}</version>
	<scope>test</scope>
</dependency>
----

[[running-tests-ide-eclipse]]
==== Eclipse

Eclipse IDEã¯ã€Oxygen.1a (4.7.1a)ãƒªãƒªãƒ¼ã‚¹ã‹ã‚‰JUnit Platformã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã¾ã™ã€‚

Eclipseã§JUnit 5ã‚’ä½¿ã†ãŸã‚ã®æƒ…å ±ã¯ã€å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
https://www.eclipse.org/eclipse/news/4.7.1a/#junit-5-support[Eclipse Project Oxygen.1a
(4.7.1a) - New and Noteworthy] ã® _Eclipse support for JUnit 5_ ã®ç¯€ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

[[running-tests-ide-other]]
==== ãã®ä»–ã®IDE

æœ¬æ›¸åŸ·ç­†æ™‚ç‚¹ã§ã¯ã€IntelliJ IDEAã¨Eclipseä»¥å¤–ã®IDEã¯ã€JUnit Platform
ä¸Šã§ã®ãƒ†ã‚¹ãƒˆå®Ÿè¡Œã‚’ç›´æ¥ã¯ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã¾ã›ã‚“ã€‚ã—ã‹ã—ã€JUnitãƒãƒ¼ãƒ ã¯
ã‚ãªãŸãŒä½¿ã£ã¦ã„ã‚‹IDEã§JUnit 5ã‚’è©¦ã›ã‚‹ã‚ˆã†ã«ã€2ã¤ã®ä¸­é–“è§£ã‚’æä¾›ã—ã¦ã„ã¾ã™ã€‚
<<running-tests-console-launcher>> ã‚’æ‰‹å‹•ã§ä½¿ã†ã‹ã€
<<running-tests-junit-platform-runner,JUnit 4ãƒ™ãƒ¼ã‚¹ã®ãƒ©ãƒ³ãƒŠãƒ¼>>
ã§ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

[[running-tests-build]]
=== ãƒ“ãƒ«ãƒ‰ã‚µãƒãƒ¼ãƒˆ

[[running-tests-build-gradle]]
==== Gradle

JUnitãƒãƒ¼ãƒ ã¯ã€`TestEngine` ã§ã‚µãƒãƒ¼ãƒˆã•ã‚Œã‚‹ã‚ã‚‰ã‚†ã‚‹ç¨®é¡ã®ãƒ†ã‚¹ãƒˆï¼ˆä¾‹ãˆã°ã€
JUnit 3ã€JUnit 4ã€JUnit Jupiterã€ {Specsy} ãªã©ï¼‰ã‚’å®Ÿè¡Œã§ãã‚‹Gradle
ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚’é–‹ç™ºã—ã¾ã—ãŸã€‚ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã®ä½¿ç”¨ä¾‹ã¯ã€`{junit5-gradle-consumer}`
ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã® `build.gradle` ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

[[running-tests-build-gradle-junit-enable]]
===== JUnit Gradleãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚’æœ‰åŠ¹ã«ã™ã‚‹

JUnit Gradleãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚’ä½¿ã†ã«ã¯ã€ã¾ãšGradle 2.5ä»¥ä¸Šã§ã‚ã‚‹ã“ã¨ã‚’
ç¢ºèªã—ã¦ãã ã•ã„ã€‚ãã®å¾Œã€`build.gradle` ã‚’æ¬¡ã®ã‚ˆã†ã«è¨­å®šã§ãã¾ã™ã€‚

[source,java,indent=0]
[subs=attributes+]
----
buildscript {
	repositories {
		mavenCentral()
		// The following is only necessary if you want to use SNAPSHOT releases.
		// maven { url 'https://oss.sonatype.org/content/repositories/snapshots' }
	}
	dependencies {
		classpath 'org.junit.platform:junit-platform-gradle-plugin:{platform-version}'
	}
}

apply plugin: 'org.junit.platform.gradle.plugin'
----

[[running-tests-build-gradle-junit-configure]]
===== JUnit Gradleãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚’è¨­å®šã™ã‚‹

JUnit Gradleãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚’é©ç”¨å¾Œã€æ¬¡ã®ã‚ˆã†ã«è¨­å®šã‚’å¤‰æ›´ã§ãã¾ã™ã€‚

[source,java,indent=0]
[subs=attributes+]
----
junitPlatform {
	platformVersion '{platform-version}' // optional, defaults to plugin version
	reportsDir file('build/test-results/junit-platform') // this is the default
	// enableStandardTestTask true
	// selectors (optional)
	// filters (optional)
	// logManager (optional)
}
----

ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯ã€JUnit Gradleãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã¯Gradleæ¨™æº–ã® `test` ã‚¿ã‚¹ã‚¯ã‚’ç„¡åŠ¹åŒ–ã—ã¾ã™ãŒã€
`enableStandardTestTask` ãƒ•ãƒ©ã‚°ã§å¤‰æ›´ã§ãã¾ã™ã€‚

[[running-tests-build-gradle-selectors]]
===== ã‚»ãƒ¬ã‚¯ã‚¿ã‚’è¨­å®šã™ã‚‹

ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯ã€ãƒ†ã‚¹ãƒˆã¯ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®å‡ºåŠ›ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‹ã‚‰æ¢ã•ã‚Œã¾ã™ã€‚
ã—ã‹ã—ã€`selectors` æ‹¡å¼µè¦ç´ ã‚’ä½¿ãˆã°ã€å®Ÿè¡Œã™ã‚‹ãƒ†ã‚¹ãƒˆã‚’æ˜ç¤ºçš„ã«æŒ‡å®šã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚

[source,java,indent=0]
----
junitPlatform {
	// ...
	selectors {
		uris 'file:///foo.txt', 'http://example.com/'
		uri 'foo:resource' <1>
		files 'foo.txt', 'bar.csv'
		file 'qux.json' <2>
		directories 'foo/bar', 'bar/qux'
		directory 'qux/bar' <3>
		packages 'com.acme.foo', 'com.acme.bar'
		aPackage 'com.example.app' <4>
		classes 'com.acme.Foo', 'com.acme.Bar'
		aClass 'com.example.app.Application' <5>
		methods 'com.acme.Foo#a', 'com.acme.Foo#b'
		method 'com.example.app.Application#run(java.lang.String[])' <6>
		resources '/bar.csv', '/foo/input.json'
		resource '/com/acme/my.properties' <7>
		modules 'foo', 'bar'
		module 'baz' <8>
	}
	// ...
}
----
<1> URIï¼ˆè¨³æ³¨ï¼šURIã‹ã‚‰ã©ã†ãƒ†ã‚¹ãƒˆã‚’è§£æ±ºã™ã‚‹ã‹ã¯å€‹ã€…ã®ãƒ†ã‚¹ãƒˆã‚¨ãƒ³ã‚¸ãƒ³ã«ä¾å­˜ã—ã¦ãŠã‚Šã€JUnit PlatformãŒé–¢çŸ¥ã™ã‚‹ã¨ã“ã‚ã§ã¯ãªã„ï¼‰
<2> ãƒ­ãƒ¼ã‚«ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«
<3> ãƒ­ãƒ¼ã‚«ãƒ«ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª
<4> ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸
<5> ã‚¯ãƒ©ã‚¹ã®å®Œå…¨ä¿®é£¾å
<6> ãƒ¡ã‚½ãƒƒãƒ‰ã®å®Œå…¨ä¿®é£¾å ({DiscoverySelectors_selectMethod} ã‚’å‚ç…§)
<7> ã‚¯ãƒ©ã‚¹ãƒ‘ã‚¹ãƒªã‚½ãƒ¼ã‚¹
<8> ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«å

[[running-tests-build-gradle-filters]]
===== ãƒ•ã‚£ãƒ«ã‚¿ã‚’è¨­å®šã™ã‚‹

`filters` æ‹¡å¼µã‚’ä½¿ã†ã“ã¨ã§ã€ãƒ†ã‚¹ãƒˆãƒ—ãƒ©ãƒ³ã®ãƒ•ã‚£ãƒ«ã‚¿ã‚’è¨­å®šã§ãã¾ã™ã€‚ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯ã€
ã™ã¹ã¦ã®ã‚¨ãƒ³ã‚¸ãƒ³ã¨ã‚¿ã‚°ãŒãƒ†ã‚¹ãƒˆãƒ—ãƒ©ãƒ³ã«å«ã¾ã‚Œã€`includeClassNamePattern`
(`{standard-include-class-name-pattern}`) ã ã‘ãŒé©ç”¨ã•ã‚Œã¾ã™ã€‚
æ¬¡ã®ä¾‹ã§ç¤ºã™ã‚ˆã†ã«ã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ‘ã‚¿ãƒ¼ãƒ³ã¯å¤‰æ›´ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
è¤‡æ•°ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’æŒ‡å®šã—ãŸå ´åˆã¯ã€OR (è«–ç†å’Œ) ã§çµåˆã•ã‚Œã¾ã™ã€‚

[source,java,indent=0]
----
junitPlatform {
	// ...
	filters {
		engines {
			include 'junit-jupiter'
			// exclude 'junit-vintage'
		}
		tags {
			include 'fast', 'smoke & feature-a'
			// exclude 'slow', 'ci'
		}
		packages {
			include 'com.sample.included1', 'com.sample.included2'
			// exclude 'com.sample.excluded1', 'com.sample.excluded2'
		}
		includeClassNamePattern '.*Spec'
		includeClassNamePatterns '.*Test', '.*Tests'
	}
	// ...
}
----

`engines {include ...}` ã¾ãŸã¯ `engines {exclude ...}` ã§ _ãƒ†ã‚¹ãƒˆã‚¨ãƒ³ã‚¸ãƒ³ID_
ã‚’æŒ‡å®šã™ã‚‹ã¨ã€JUnit Gradleãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã¯ãã®ãƒ†ã‚¹ãƒˆã‚¨ãƒ³ã‚¸ãƒ³ã®ãƒ†ã‚¹ãƒˆã ã‘ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚
åŒæ§˜ã«ã€`tags {include ...}` ã¾ãŸã¯ `tags {exclude ...}` ã§ _ã‚¿ã‚°_ ã‚„
<<running-tests-tag-expressions, _ã‚¿ã‚°å¼_>> ã‚’æŒ‡å®šã™ã‚‹ã¨ã€JUnit Gradle
ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã¯ï¼ˆä¾‹ãˆã°ã€JUnit Jupiterãƒ™ãƒ¼ã‚¹ã®ãƒ†ã‚¹ãƒˆã®å ´åˆã¯ `@Tag` ã‚¢ãƒãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã§ï¼‰
ã‚¿ã‚°ä»˜ã‘ã•ã‚ŒãŸãƒ†ã‚¹ãƒˆã ã‘ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚
`packages {include ...}` ã¾ãŸã¯ `packages {exclude ...}` ã‚’ä½¿ã£ã¦ã€
ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸åã«ã¤ã„ã¦ã‚‚åŒæ§˜ã®ã“ã¨ãŒã§ãã¾ã™ã€‚

[[running-tests-build-gradle-config-params]]
===== è¨­å®šãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼

`configurationParameter` ã¾ãŸã¯ `configurationParameters` DSL ã‚’ä½¿ã£ã¦ã€
ãƒ†ã‚¹ãƒˆã‚’ç™ºè¦‹ãƒ»å®Ÿè¡Œã™ã‚‹ãŸã‚ã®è¨­å®šãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ã‚’æŒ‡å®šã§ãã¾ã™ã€‚å‰è€…ã¯ã€
å˜ä¸€ã®è¨­å®šãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ã‚’æŒ‡å®šã™ã‚‹ã®ã«ä½¿ãˆã¾ã™ã€‚å¾Œè€…ã¯ã€
ä¸€åº¦ã«è¤‡æ•°ã®ã‚­ãƒ¼ãƒ»å€¤ã®ãƒšã‚¢ã‚’æŒ‡å®šã™ã‚‹ãŸã‚ã«ã€è¨­å®šãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ã®ãƒãƒƒãƒ—ã‚’å—ã‘å–ã‚Šã¾ã™ã€‚
ã™ã¹ã¦ã®ã‚­ãƒ¼ã¨å€¤ã¯ã€`String` ã§ãªã‘ã‚Œã°ãªã‚Šã¾ã›ã‚“ã€‚

[source,java,indent=0]
----
junitPlatform {
	// ...
	configurationParameter 'junit.jupiter.conditions.deactivate', '*'
	configurationParameters([
		'junit.jupiter.extensions.autodetection.enabled': 'true',
		'junit.jupiter.testinstance.lifecycle.default': 'per_class'
	])
	// ...
}
----

[[running-tests-build-gradle-engines-configure]]
===== ãƒ†ã‚¹ãƒˆã‚¨ãƒ³ã‚¸ãƒ³ã‚’è¨­å®šã™ã‚‹

JUnit Gradleãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã«ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã•ã›ã‚‹ãŸã‚ã«ã¯ã€`TestEngine`
ã®å®Ÿè£…ãŒã‚¯ãƒ©ã‚¹ãƒ‘ã‚¹ã«å­˜åœ¨ã—ãªã‘ã‚Œã°ãªã‚Šã¾ã›ã‚“ã€‚

JUnit Jupiterãƒ™ãƒ¼ã‚¹ã®ãƒ†ã‚¹ãƒˆã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹ãŸã‚ã«ã¯ã€JUnit Jupiter API
ã«å¯¾ã™ã‚‹ `testCompile` ä¾å­˜ã¨ã€JUnit Jupiter `TestEngine`
å®Ÿè£…ã«å¯¾ã™ã‚‹ `testRuntime` ä¾å­˜ã‚’æ¬¡ã®ã‚ˆã†ã«æŒ‡å®šã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

[source,java,indent=0]
[subs=attributes+]
----
dependencies {
	testCompile("org.junit.jupiter:junit-jupiter-api:{jupiter-version}")
	testRuntime("org.junit.jupiter:junit-jupiter-engine:{jupiter-version}")
}
----

JUnit Gradleãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã¯ã€JUnit 4ãƒ™ãƒ¼ã‚¹ã®ãƒ†ã‚¹ãƒˆã‚‚å®Ÿè¡Œã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
ãã®ãŸã‚ã«ã¯ã€JUnit 4ã«å¯¾ã™ã‚‹ `testCompile` ä¾å­˜ã¨ã€JUnit Vintage
`TestEngine` å®Ÿè£…ã«å¯¾ã™ã‚‹ `testRuntime` ä¾å­˜ãŒå¿…è¦ã§ã™ã€‚

[source,java,indent=0]
[subs=attributes+]
----
dependencies {
	testCompile("junit:junit:{junit4-version}")
	testRuntime("org.junit.vintage:junit-vintage-engine:{vintage-version}")
}
----

[[running-tests-build-gradle-logging]]
===== ãƒ­ã‚®ãƒ³ã‚°ã‚’è¨­å®šã™ã‚‹ï¼ˆçœç•¥å¯ï¼‰

JUnitã¯ã€`java.util.logging` ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ï¼ˆåˆ¥åã€_JUL_ï¼‰ã® Java Logging API
ã‚’è­¦å‘Šã‚„ãƒ‡ãƒãƒƒã‚°æƒ…å ±ã®å‡ºåŠ›ã«åˆ©ç”¨ã—ã¦ã„ã¾ã™ã€‚è¨­å®šã‚ªãƒ—ã‚·ãƒ§ãƒ³ã«ã¤ã„ã¦ã¯ã€
`{LogManager}` ã®å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

ãƒ­ã‚°ã‚’ {Log4j} ã‚„ {Logback} ã®ã‚ˆã†ãªä»–ã®ãƒ­ã‚®ãƒ³ã‚°ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã™ã‚‹
ã“ã¨ã‚‚å¯èƒ½ã§ã™ã€‚`{LogManager}` ã®ã‚«ã‚¹ã‚¿ãƒ å®Ÿè£…ã‚’æä¾›ã™ã‚‹ãƒ­ã‚®ãƒ³ã‚°ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã‚’
ä½¿ã†å ´åˆã¯ã€JUnit Gradleãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã® `logManager` æ‹¡å¼µãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’è¨­å®šã—ã¦ãã ã•ã„ã€‚
æŒ‡å®šã—ãŸ `{LogManager}` å®Ÿè£…ã‚¯ãƒ©ã‚¹ã® _å®Œå…¨ä¿®é£¾å_ ãŒã€`java.util.logging.manager`
ã‚·ã‚¹ãƒ†ãƒ ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã«è¨­å®šã•ã‚Œã¾ã™ã€‚ä»¥ä¸‹ã¯ã€Log4j{nbsp}2.x
ï¼ˆè©³ç´°ã¯ã€{Log4j_JDK_Logging_Adapter} å‚ç…§ï¼‰ã‚’è¨­å®šã™ã‚‹ä¾‹ã§ã™ã€‚

[source,java,indent=0]
[subs=attributes+]
----
junitPlatform {
	logManager 'org.apache.logging.log4j.jul.LogManager'
}
----

ãã®ä»–ã®ãƒ­ã‚®ãƒ³ã‚°ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã¯ã€`java.util.logging` ã®ãƒ­ã‚°ã‚’ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã™ã‚‹
æ–¹æ³•ãŒç•°ãªã‚Šã¾ã™ã€‚ä¾‹ãˆã° {Logback} ã§ã¯ã€
https://www.slf4j.org/legacy.html#jul-to-slf4j[JULã‹ã‚‰SLF4Jã¸ã®ãƒ–ãƒªãƒƒã‚¸]
ã‚’å®Ÿè¡Œæ™‚ã®ã‚¯ãƒ©ã‚¹ãƒ‘ã‚¹ã«ä¾å­˜é–¢ä¿‚ã¨ã—ã¦è¿½åŠ ã—ã¦ä½¿ã„ã¾ã™ã€‚

[[running-tests-build-gradle-junit-using]]
===== JUnit Gradleãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚’ä½¿ã†

JUnit Gradleãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚’é©ç”¨ã™ã‚‹ã¨ã€`junitPlatformTest` ã‚¿ã‚¹ã‚¯ãŒä½¿ãˆã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ã§ `gradlew junitPlatformTest`ï¼ˆã¾ãŸã¯ã€`gradlew test`ï¼‰
ã‚’å‘¼ã³å‡ºã™ã¨ã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ä¸­ã§ã‚¯ãƒ©ã‚¹åãŒ `includeClassNamePattern`
ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯ã€`{standard-include-class-name-pattern}`ï¼‰
ã®æ­£è¦è¡¨ç¾ã«ãƒãƒƒãƒã™ã‚‹ã™ã¹ã¦ã®ãƒ†ã‚¹ãƒˆãŒå®Ÿè¡Œã•ã‚Œã¾ã™ã€‚

`{junit5-gradle-consumer}` ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ `junitPlatformTest`
ã‚¿ã‚¹ã‚¯ã‚’å®Ÿè¡Œã™ã‚‹ã¨ã€æ¬¡ã®ã‚ˆã†ãªå‡ºåŠ›ã«ãªã‚Šã¾ã™ã€‚

....
:junitPlatformTest

Test run finished after 93 ms
[         3 containers found      ]
[         0 containers skipped    ]
[         3 containers started    ]
[         0 containers aborted    ]
[         3 containers successful ]
[         0 containers failed     ]
[         3 tests found           ]
[         1 tests skipped         ]
[         2 tests started         ]
[         0 tests aborted         ]
[         2 tests successful      ]
[         0 tests failed          ]

BUILD SUCCESSFUL
....

ã‚‚ã—ãƒ†ã‚¹ãƒˆãŒå¤±æ•—ã™ã‚‹ã¨ã€æ¬¡ã®ã‚ˆã†ãªå‡ºåŠ›ã¨ã¨ã‚‚ã«ãƒ“ãƒ«ãƒ‰ãŒå¤±æ•—ã—ã¾ã™ã€‚

[subs=-callouts]
....
:junitPlatformTest

Test failures (1):
  JUnit Jupiter:SecondTest:mySecondTest()
    MethodSource [className = 'com.example.project.SecondTest', methodName = 'mySecondTest', methodParameterTypes = '']
    => Exception: 2 is not equal to 1 ==> expected: <2> but was: <1>

Test run finished after 99 ms
[         3 containers found      ]
[         0 containers skipped    ]
[         3 containers started    ]
[         0 containers aborted    ]
[         3 containers successful ]
[         0 containers failed     ]
[         3 tests found           ]
[         0 tests skipped         ]
[         3 tests started         ]
[         0 tests aborted         ]
[         2 tests successful      ]
[         1 tests failed          ]

:junitPlatformTest FAILED

FAILURE: Build failed with an exception.

* What went wrong:
Execution failed for task ':junitPlatformTest'.
> Process 'command '/Library/Java/JavaVirtualMachines/jdk1.8.0_92.jdk/Contents/Home/bin/java'' finished with non-zero exit value 1
....

NOTE: ã‚³ãƒ³ãƒ†ãƒŠã‚„ãƒ†ã‚¹ãƒˆãŒå¤±æ•—ã—ãŸå ´åˆã€_çµ‚äº†ã‚³ãƒ¼ãƒ‰_ ã¯ `1` ã«ãªã‚Šã¾ã™ã€‚æˆåŠŸã—ãŸå ´åˆã¯ã€`0` ã§ã™ã€‚

.JUnit Gradleãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã®ç¾åœ¨ã®åˆ¶é™äº‹é …
WARNING: JUnit Gradleãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã«å®Ÿè¡Œã•ã‚ŒãŸãƒ†ã‚¹ãƒˆã®çµæœã¯ã€
GradleãŒå‡ºåŠ›ã™ã‚‹æ¨™æº–ã®ãƒ†ã‚¹ãƒˆãƒ¬ãƒãƒ¼ãƒˆã«ã¯å«ã¾ã‚Œã¾ã›ã‚“ã€‚ãŸã ã—ã€
å…¸å‹çš„ãªCIã‚µãƒ¼ãƒãƒ¼ã§ã¯ãƒ†ã‚¹ãƒˆçµæœã¨ã—ã¦åé›†ã§ãã¾ã™ã€‚
ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã®ã€`reportsDir` ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

[[running-tests-build-maven]]
==== Maven

JUnitãƒãƒ¼ãƒ ã¯ã€`mvn test` ã§JUnit 4ã¨JUnit Jupiterã®ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã§ãã‚‹
Maven Surefireãƒ—ãƒ­ãƒã‚¤ãƒ€ã‚’é–‹ç™ºã—ã¾ã—ãŸã€‚ `{junit5-maven-consumer}`
ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã® `pom.xml` ãƒ•ã‚¡ã‚¤ãƒ«ãŒä½¿ã„æ–¹ã‚’ç¤ºã—ã¦ã„ã¾ã™ã€‚

WARNING: Surefire 2.20ã®ãƒ¡ãƒ¢ãƒªãƒªãƒ¼ã‚¯ã¨Java 9å®Ÿè¡Œæ™‚ã®å•é¡Œã®ãŸã‚ã€
`junit-platform-surefire-provider` ã¯ç¾åœ¨Surefire 2.19.1ã®ã¿ã§å‹•ä½œã—ã¾ã™ã€‚

[source,xml,indent=0]
[subs=attributes+]
----
	...
	<build>
		<plugins>
			...
			<plugin>
				<artifactId>maven-surefire-plugin</artifactId>
				<version>2.19.1</version>
				<dependencies>
					<dependency>
						<groupId>org.junit.platform</groupId>
						<artifactId>junit-platform-surefire-provider</artifactId>
						<version>{platform-version}</version>
					</dependency>
				</dependencies>
			</plugin>
		</plugins>
	</build>
	...
----

[[running-tests-build-maven-engines-configure]]
===== ãƒ†ã‚¹ãƒˆã‚¨ãƒ³ã‚¸ãƒ³ã‚’è¨­å®šã™ã‚‹

Maven Surefireã«ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã•ã›ã‚‹ãŸã‚ã«ã¯ã€`TestEngine` ã®å®Ÿè£…ãŒ
å®Ÿè¡Œæ™‚ã®ã‚¯ãƒ©ã‚¹ãƒ‘ã‚¹ã«å¿…è¦ã§ã™ã€‚

JUnit Jupiterãƒ™ãƒ¼ã‚¹ã®ãƒ†ã‚¹ãƒˆã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹ãŸã‚ã«ã¯ã€JUnit Jupiter API
ã«å¯¾ã™ã‚‹ `test` ä¾å­˜ã¨ã€JUnit Jupiter `TestEngine` å®Ÿè£…ã«å¯¾ã™ã‚‹
`maven-surefire-plugin` ã®ä¾å­˜ã‚’æ¬¡ã®ã‚ˆã†ã«æŒ‡å®šã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

[source,xml,indent=0]
[subs=attributes+]
----
	...
	<build>
		<plugins>
			...
			<plugin>
				<artifactId>maven-surefire-plugin</artifactId>
				<version>2.19.1</version>
				<dependencies>
					<dependency>
						<groupId>org.junit.platform</groupId>
						<artifactId>junit-platform-surefire-provider</artifactId>
						<version>{platform-version}</version>
					</dependency>
					<dependency>
						<groupId>org.junit.jupiter</groupId>
						<artifactId>junit-jupiter-engine</artifactId>
						<version>{jupiter-version}</version>
					</dependency>
				</dependencies>
			</plugin>
		</plugins>
	</build>
	...
	<dependencies>
		...
		<dependency>
			<groupId>org.junit.jupiter</groupId>
			<artifactId>junit-jupiter-api</artifactId>
			<version>{jupiter-version}</version>
			<scope>test</scope>
		</dependency>
	</dependencies>
	...
----

JUnit Platform Surefireãƒ—ãƒ­ãƒã‚¤ãƒ€ã¯ã€JUnit 4ãƒ™ãƒ¼ã‚¹ã®ãƒ†ã‚¹ãƒˆã‚‚å®Ÿè¡Œã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
ãã®ãŸã‚ã«ã¯ã€JUnit 4ã«å¯¾ã™ã‚‹ `test` ä¾å­˜ã¨ã€JUnit Vintage `TestEngine` å®Ÿè£…ã«å¯¾ã™ã‚‹
`maven-surefire-plugin` ã®ä¾å­˜ãŒå¿…è¦ã§ã™ã€‚

[source,xml,indent=0]
[subs=attributes+]
----
	...
	<build>
		<plugins>
			...
			<plugin>
				<artifactId>maven-surefire-plugin</artifactId>
				<version>2.19.1</version>
				<dependencies>
					<dependency>
						<groupId>org.junit.platform</groupId>
						<artifactId>junit-platform-surefire-provider</artifactId>
						<version>{platform-version}</version>
					</dependency>
					...
					<dependency>
						<groupId>org.junit.vintage</groupId>
						<artifactId>junit-vintage-engine</artifactId>
						<version>{vintage-version}</version>
					</dependency>
				</dependencies>
			</plugin>
		</plugins>
	</build>
	...
	<dependencies>
		...
		<dependency>
			<groupId>junit</groupId>
			<artifactId>junit</artifactId>
			<version>{junit4-version}</version>
			<scope>test</scope>
		</dependency>
	</dependencies>
	...
----

[[running-tests-build-maven-test-system-property]]
===== å˜ä¸€ã®ãƒ†ã‚¹ãƒˆã‚¯ãƒ©ã‚¹ã‚’å®Ÿè¡Œã™ã‚‹

JUnit Platform Surefireãƒ—ãƒ­ãƒã‚¤ãƒ€ã¯ã€Maven Surefireãƒ—ãƒ©ã‚°ã‚¤ãƒ³ãŒã‚µãƒãƒ¼ãƒˆã™ã‚‹
JVMã‚·ã‚¹ãƒ†ãƒ ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ `test` ã«å¯¾å¿œã—ã¦ã„ã¾ã™ã€‚ä¾‹ãˆã°ã€ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ã‹ã‚‰
`mvn -Dtest=org.example.MyTest test` ã‚’å®Ÿè¡Œã™ã‚‹ã“ã¨ã§ã€ãƒ†ã‚¹ãƒˆã‚¯ãƒ©ã‚¹
`org.example.MyTest` ã®ãƒ†ã‚¹ãƒˆãƒ¡ã‚½ãƒƒãƒ‰ã ã‘ã‚’å®Ÿè¡Œã§ãã¾ã™ã€‚è©³ç´°ã¯ã€
https://maven.apache.org/surefire/maven-surefire-plugin/examples/single-test.html[Maven Surefireãƒ—ãƒ©ã‚°ã‚¤ãƒ³]
ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

[[running-tests-build-maven-filter-test-class-names]]
===== ãƒ†ã‚¹ãƒˆã‚¯ãƒ©ã‚¹åã§ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã™ã‚‹

Maven Surefireãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã¯ã€å®Œå…¨ä¿®é£¾åãŒæ¬¡ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã«ãƒãƒƒãƒã™ã‚‹ãƒ†ã‚¹ãƒˆã‚¯ãƒ©ã‚¹ã‚’æ¢ã—ã¾ã™ã€‚

- `+**/Test*.java+`
- `+**/*Test.java+`
- `+**/*TestCase.java+`

ãŸã ã—ã€`pom.xml` ãƒ•ã‚¡ã‚¤ãƒ«ã® `include` ãŠã‚ˆã³ `exclude`
ãƒ«ãƒ¼ãƒ«ã‚’æ˜ç¤ºçš„ã«è¨­å®šã™ã‚‹ã“ã¨ã§ã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®å‹•ä½œã‚’å¤‰æ›´ã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚
è©³ç´°ã¯ã€ Maven Surefireã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
https://maven.apache.org/surefire/maven-surefire-plugin/examples/inclusion-exclusion.html[Inclusions and Exclusions of Tests]
ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

[[running-tests-build-maven-filter-tags]]
===== ã‚¿ã‚°ã§ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã™ã‚‹

æ¬¡ã®ã‚ˆã†ã«ã€ã‚¿ã‚°ã¾ãŸã¯ <<running-tests-tag-expressions, ã‚¿ã‚°å¼>>
ã‚’ä½¿ã£ã¦ãƒ†ã‚¹ãƒˆã‚’ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚

- _ã‚¿ã‚°_ ã¾ãŸã¯ _ã‚¿ã‚°å¼_ ã‚’ãƒ†ã‚¹ãƒˆå¯¾è±¡ã«å«ã‚ã‚‹ã«ã¯ã€`groups` ã¾ãŸã¯ `includeTags` ã‚’æŒ‡å®šã—ã¾ã™ã€‚
- _ã‚¿ã‚°_ ã¾ãŸã¯ _ã‚¿ã‚°å¼_ ã‚’ãƒ†ã‚¹ãƒˆå¯¾è±¡ã‹ã‚‰é™¤å¤–ã™ã‚‹ã«ã¯ã€`excludedGroups` ã¾ãŸã¯ `excludeTags` ã‚’æŒ‡å®šã—ã¾ã™ã€‚

[source,xml,indent=0]
----
	...
	<build>
		<plugins>
			...
			<plugin>
				<artifactId>maven-surefire-plugin</artifactId>
				<version>2.19.1</version>
				<configuration>
			        <properties>
			            <includeTags>acceptance | !feature-a</includeTags>
			            <excludeTags>integration, regression</excludeTags>
			        </properties>
			    </configuration>
				<dependencies>
					...
				</dependencies>
			</plugin>
		</plugins>
	</build>
	...
----

[[running-tests-build-maven-config-params]]
===== è¨­å®šãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼

`configurationParameters` ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã«Javaã® `Properties` ãƒ•ã‚¡ã‚¤ãƒ«å½¢å¼ã®
ã‚­ãƒ¼ãƒ»å€¤ã®ãƒšã‚¢ã‚’ä¸ãˆã‚‹ã“ã¨ã§ã€ãƒ†ã‚¹ãƒˆã‚’ç™ºè¦‹ãƒ»å®Ÿè¡Œã™ã‚‹ãŸã‚ã®è¨­å®šãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ã‚’æŒ‡å®šã§ãã¾ã™ã€‚

[source,xml,indent=0]
----
	...
	<build>
		<plugins>
			...
			<plugin>
				<artifactId>maven-surefire-plugin</artifactId>
				<version>2.19.1</version>
				<configuration>
					<properties>
						<configurationParameters>
							junit.jupiter.conditions.deactivate = *
							junit.jupiter.extensions.autodetection.enabled = true
							junit.jupiter.testinstance.lifecycle.default = per_class
						</configurationParameters>
					</properties>
				</configuration>
				<dependencies>
					...
				</dependencies>
			</plugin>
		</plugins>
	</build>
	...
----

[[running-tests-console-launcher]]
=== Console Launcher

`{ConsoleLauncher}` ã¯ã€ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã‹ã‚‰JUnit Platformã‚’èµ·å‹•ã™ã‚‹ãŸã‚ã®
Javaã®ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ã™ã€‚ä¾‹ãˆã°ã€JUnit Vintageã¨JUnit Jupiter
ã®ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã€çµæœã‚’ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«è¡¨ç¤ºã™ã‚‹ã®ã«ä½¿ãˆã¾ã™ã€‚

ã™ã¹ã¦ã®ä¾å­˜é–¢ä¿‚ã‚’å«ã‚“ã å®Ÿè¡Œå¯èƒ½ãª `junit-platform-console-standalone-{platform-version}.jar`
ãŒMavenã‚»ãƒ³ãƒˆãƒ©ãƒ«ãƒªãƒã‚¸ãƒˆãƒªã®
https://repo1.maven.org/maven2/org/junit/platform/junit-platform-console-standalone[junit-platform-console-standalone]
ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã§å…¬é–‹ã•ã‚Œã¦ã„ã¾ã™ã€‚ã‚¹ã‚¿ãƒ³ãƒ‰ã‚¢ãƒ­ãƒ³ç‰ˆã® `ConsoleLauncher` ã¯ã€æ¬¡ã®ã‚ˆã†ã«
https://docs.oracle.com/javase/tutorial/deployment/jar/run.html[å®Ÿè¡Œã™ã‚‹] ã“ã¨ãŒã§ãã¾ã™ã€‚

`java -jar junit-platform-console-standalone-{platform-version}.jar <<<running-tests-console-launcher-options>>>`

å‡ºåŠ›ã®ä¾‹ã¯æ¬¡ã®é€šã‚Šã§ã™ã€‚

....
â”œâ”€ JUnit Vintage
â”‚  â””â”€ example.JUnit4Tests
â”‚     â””â”€ standardJUnit4Test âœ”
â””â”€ JUnit Jupiter
   â”œâ”€ StandardTests
   â”‚  â”œâ”€ succeedingTest() âœ”
   â”‚  â””â”€ skippedTest() â†· for demonstration purposes
   â””â”€ A special test case
      â”œâ”€ Custom test name containing spaces âœ”
      â”œâ”€ â•¯Â°â–¡Â°ï¼‰â•¯ âœ”
      â””â”€ ğŸ˜± âœ”

Test run finished after 64 ms
[         5 containers found      ]
[         0 containers skipped    ]
[         5 containers started    ]
[         0 containers aborted    ]
[         5 containers successful ]
[         0 containers failed     ]
[         6 tests found           ]
[         1 tests skipped         ]
[         5 tests started         ]
[         0 tests aborted         ]
[         5 tests successful      ]
[         0 tests failed          ]
....

.çµ‚äº†ã‚³ãƒ¼ãƒ‰
NOTE: `{ConsoleLauncher}` ã¯ã€ã‚³ãƒ³ãƒ†ãƒŠã‚„ãƒ†ã‚¹ãƒˆãŒå¤±æ•—ã™ã‚‹ã¨ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰
`1` ã§çµ‚äº†ã—ã¾ã™ã€‚æˆåŠŸã—ãŸå ´åˆã¯ã€`0` ã§ã™ã€‚

[[running-tests-console-launcher-options]]
==== ã‚ªãƒ—ã‚·ãƒ§ãƒ³

----
include::{consoleLauncherOptionsFile}[]
----


[[running-tests-junit-platform-runner]]
=== JUnit Platformã®å®Ÿè¡Œã«JUnit 4ã‚’ä½¿ã†

`JUnitPlatform` ãƒ©ãƒ³ãƒŠãƒ¼ã¯ã€JUnit Platformã®ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ãƒ¢ãƒ‡ãƒ«ã«å¾“ã£ãŸãƒ†ã‚¹ãƒˆ
ï¼ˆä¾‹ãˆã°ã€JUnit Jupiterã®ãƒ†ã‚¹ãƒˆã‚¯ãƒ©ã‚¹ï¼‰ã‚’JUnit 4ç’°å¢ƒã§å®Ÿè¡Œå¯èƒ½ã«ã™ã‚‹ãŸã‚ã®
JUnit 4ãƒ™ãƒ¼ã‚¹ã® `Runner` ã§ã™ã€‚

ãƒ†ã‚¹ãƒˆã‚¯ãƒ©ã‚¹ã« `@RunWith(JUnitPlatform.class)` ã‚¢ãƒãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ä»˜ä¸ã™ã‚‹ã¨ã€
ã¾ã JUnit Platformã‚’ç›´æ¥ã¯ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ãªã„ã‘ã‚Œã©ã‚‚JUnit 4ãªã‚‰ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã‚‹
IDEã‚„ãƒ“ãƒ«ãƒ‰ã‚·ã‚¹ãƒ†ãƒ ã§ã‚‚å®Ÿè¡Œã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

NOTE: JUnit Platformã¯JUnit 4ã«ãªã„æ©Ÿèƒ½ã‚’ã‚‚ã£ã¦ã„ã‚‹ãŸã‚ã€ç‰¹ã«ãƒ¬ãƒãƒ¼ãƒˆå‘¨ã‚Š
(<<running-tests-junit-platform-runner-technical-names>> ã‚’å‚ç…§)ãªã©ã€
JUnit Platformã®æ©Ÿèƒ½ã®ã‚µãƒ–ã‚»ãƒƒãƒˆã—ã‹ã‚µãƒãƒ¼ãƒˆã™ã‚‹ã“ã¨ãŒã§ãã¾ã›ã‚“ã€‚
ã—ã‹ã—ã€ã•ã—ã‚ãŸã£ã¦ã¯ `JUnitPlatform` ãƒ©ãƒ³ãƒŠãƒ¼ã‚’ä½¿ã£ã¦å§‹ã‚ã‚‹ã®ãŒç°¡å˜ã§ã™ã€‚

[[running-tests-junit-platform-runner-setup]]
==== ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

ã‚¯ãƒ©ã‚¹ãƒ‘ã‚¹ã«ä»¥ä¸‹ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã¨ãã®ä¾å­˜ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒå¿…è¦ã§ã™ã€‚Group IDã‚„Artifact IDã€
ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®è©³ç´°ã«ã¤ã„ã¦ã¯ã€ <<dependency-metadata>> ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

===== æ˜ç¤ºçš„ãªä¾å­˜é–¢ä¿‚

* `junit-platform-runner` ã¯ _test_ ã‚¹ã‚³ãƒ¼ãƒ—: `JUnitPlatform` ãƒ©ãƒ³ãƒŠãƒ¼ãŒå«ã¾ã‚Œã‚‹
* `junit-{junit4-version}.jar` ã¯ _test_ ã‚¹ã‚³ãƒ¼ãƒ—: JUnit 4ã‚’ä½¿ã£ã¦ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã™ã‚‹ãŸã‚
* `junit-jupiter-api` ã¯ _test_ ã‚¹ã‚³ãƒ¼ãƒ—: `@Test` ãªã©JUnit Jupiterã‚’ä½¿ã£ã¦ãƒ†ã‚¹ãƒˆã‚’æ›¸ããŸã‚ã®API
* `junit-jupiter-engine` ã¯ _test runtime_ ã‚¹ã‚³ãƒ¼ãƒ—: JUnit Jupiterã®ãŸã‚ã® `TestEngine` APIå®Ÿè£…

===== æ¨ç§»çš„ãªä¾å­˜é–¢ä¿‚

* `junit-platform-suite-api` ã¯ _test_ ã‚¹ã‚³ãƒ¼ãƒ—
* `junit-platform-launcher` ã¯ _test_ ã‚¹ã‚³ãƒ¼ãƒ—
* `junit-platform-engine` ã¯ _test_ ã‚¹ã‚³ãƒ¼ãƒ—
* `junit-platform-commons` ã¯ _test_ ã‚¹ã‚³ãƒ¼ãƒ—
* `opentest4j` ã¯ _test_ ã‚¹ã‚³ãƒ¼ãƒ—

[[running-tests-junit-platform-runner-technical-names]]
==== è¡¨ç¤ºå vs. æŠ€è¡“å

[TIP]
====
è¨³æ³¨ï¼šæœ¬æ–‡æ›¸ã§ã¯ _Display Name_ ã«å¯¾ã—ã¦ _è¡¨ç¤ºå_ ã¨ã„ã†è¨³èªã‚’ä½¿ç”¨ã—ã€
æœ¬ç¯€ã§ç™»å ´ã™ã‚‹ _Technical Name_ ã«å¯¾ã—ã¦ã¯ _æŠ€è¡“å_ ã¨ã„ã†è¨³èªã‚’ä½¿ç”¨ã—ãŸã€‚
ã—ã‹ã—ã€å¾Œè€…ã¯ç›´æ„Ÿçš„ã§ã¯ãªã„ã¨æ€ã†ã®ã§ã€é©åˆ‡ãªè¨³ãŒã‚ã‚Œã°ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã‚’ã„ãŸã ããŸã„ã€‚
====

`@RunWith(JUnitPlatform.class)` ãƒ©ãƒ³ãƒŠãƒ¼ã§å®Ÿè¡Œã•ã‚Œã‚‹ã‚¯ãƒ©ã‚¹ã«ã‚«ã‚¹ã‚¿ãƒ ã®
_è¡¨ç¤ºå (display name)_ ã‚’å®šç¾©ã™ã‚‹ãŸã‚ã«ã¯ã€`@SuiteDisplayName`
ã‚¢ãƒãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ä»˜ä¸ã—ã¾ã™ã€‚

ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯ã€ _è¡¨ç¤ºå_ ã¯ãƒ†ã‚¹ãƒˆã®æˆæœç‰©ã«ä½¿ã‚ã‚Œã¾ã™ã€‚ã—ã‹ã—ã€Gradleã‚„
Mavenã®ã‚ˆã†ãªãƒ“ãƒ«ãƒ‰ãƒ„ãƒ¼ãƒ«ãŒ `JUnitPlatform` ãƒ©ãƒ³ãƒŠãƒ¼ã‚’ä½¿ã†å ´åˆã€
ç”Ÿæˆã•ã‚Œã‚‹ãƒ†ã‚¹ãƒˆãƒ¬ãƒãƒ¼ãƒˆã«ã¯ã€ãƒ†ã‚¹ãƒˆã‚¯ãƒ©ã‚¹ã®å˜ç´”åã‚„
ç‰¹æ®Šæ–‡å­—ã‚’å«ã‚€ã‚«ã‚¹ã‚¿ãƒ è¡¨ç¤ºåã§ã¯ãªãã€å®Œå…¨ä¿®é£¾ã‚¯ãƒ©ã‚¹åã®ã‚ˆã†ãª
_æŠ€è¡“å (technical name)_ ãŒå¿…è¦ã«ãªã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚
ãƒ¬ãƒãƒ¼ãƒˆå‡ºåŠ›ã§ _æŠ€è¡“å_ ã‚’æœ‰åŠ¹ã«ã™ã‚‹ãŸã‚ã«ã¯ã€
`@RunWith(JUnitPlatform.class)` ã¨ä¸€ç·’ã« `@UseTechnicalNames`
ã‚¢ãƒãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®£è¨€ã—ã¦ãã ã•ã„ã€‚

`@UseTechnicalNames` ã‚’ä»˜ä¸ã™ã‚‹ã¨ã€`@SuiteDisplayName`
ã§ã—ãŸã‚«ã‚¹ã‚¿ãƒ è¡¨ç¤ºåã¯ç„¡è¦–ã•ã‚Œã‚‹ç‚¹ã«æ³¨æ„ã—ã¦ãã ã•ã„ã€‚

[[running-tests-junit-platform-runner-single-test]]
==== å˜ä¸€ã®ãƒ†ã‚¹ãƒˆã‚¯ãƒ©ã‚¹

`JUnitPlatform` ãƒ©ãƒ³ãƒŠãƒ¼ã‚’ä½¿ã†æ–¹æ³•ã®1ã¤ã¯ã€ãƒ†ã‚¹ãƒˆã‚¯ãƒ©ã‚¹ã«ç›´æ¥
`@RunWith(JUnitPlatform.class)` ã‚¢ãƒãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ä»˜ä¸ã™ã‚‹ã“ã¨ã§ã™ã€‚
ä»¥ä¸‹ã®ä¾‹ã®ãƒ†ã‚¹ãƒˆãƒ¡ã‚½ãƒƒãƒ‰ã«ã¯ã€`org.junit.Test` (JUnit Vintage) ã§ã¯ãªãã€
`org.junit.jupiter.api.Test` (JUnit Jupiter)
ã‚¢ãƒãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ãŒä»˜ä¸ã•ã‚Œã¦ã„ã‚‹ç‚¹ã«æ³¨æ„ã—ã¦ãã ã•ã„ã€‚ã•ã‚‰ã«ã€
ã“ã®å ´åˆã¯ãƒ†ã‚¹ãƒˆã‚¯ãƒ©ã‚¹ã‚’ `public` ã«ã—ãªã‘ã‚Œã°ãªã‚‰ãªã„ç‚¹ã«ã‚‚æ³¨æ„ã—ã¦ãã ã•ã„ã€‚
ãã†ã—ãªã„ã¨ã€ä¸€éƒ¨ã®IDEã‚„ãƒ“ãƒ«ãƒ‰ãƒ„ãƒ¼ãƒ«ã§ã¯JUnit 4ã®ãƒ†ã‚¹ãƒˆã‚¯ãƒ©ã‚¹ã¨ã—ã¦
èªè­˜ã•ã‚Œã¾ã›ã‚“ã€‚

[source,java,indent=0]
----
include::{testDir}/example/JUnit4ClassDemo.java[tags=user_guide]
----

[[running-tests-junit-platform-runner-test-suite]]
==== ãƒ†ã‚¹ãƒˆã‚¹ã‚¤ãƒ¼ãƒˆ

è¤‡æ•°ã®ãƒ†ã‚¹ãƒˆã‚¯ãƒ©ã‚¹ãŒã‚ã‚‹å ´åˆã€æ¬¡ã®ä¾‹ã®ã‚ˆã†ã«ãƒ†ã‚¹ãƒˆã‚¹ã‚¤ãƒ¼ãƒˆã‚’ä½œæˆã§ãã¾ã™ã€‚

[source,java,indent=0]
----
include::{testDir}/example/JUnit4SuiteDemo.java[tags=user_guide]
----

`JUnit4SuiteDemo` ã¯ã€`example` ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¨ãã®ã‚µãƒ–ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‹ã‚‰
ã™ã¹ã¦ã®ãƒ†ã‚¹ãƒˆã‚’æ¢ã—ã¦å®Ÿè¡Œã—ã¾ã™ã€‚ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯ã€åå‰ãŒ
`{standard-include-class-name-pattern}` ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã«ãƒãƒƒãƒã™ã‚‹
ãƒ†ã‚¹ãƒˆã‚¯ãƒ©ã‚¹ã ã‘ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚

.è¿½åŠ ã®è¨­å®šã‚ªãƒ—ã‚·ãƒ§ãƒ³
NOTE: `@SelectPackages` ä»¥å¤–ã«ã‚‚ã€ãƒ†ã‚¹ãƒˆã‚’æ¤œç´¢ã—ãŸã‚Šãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã—ãŸã‚Šã™ã‚‹ãŸã‚ã®
è¨­å®šã‚ªãƒ—ã‚·ãƒ§ãƒ³ãŒã‚ã‚Šã¾ã™ã€‚è©³ç´°ã¯ã€
{javadoc-root}/org/junit/platform/suite/api/package-summary.html[Javadoc]
ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

[[running-tests-config-params]]
=== è¨­å®šãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼

ã©ã®ãƒ†ã‚¹ãƒˆã‚¯ãƒ©ã‚¹ã‚„ãƒ†ã‚¹ãƒˆã‚¨ãƒ³ã‚¸ãƒ³ã‚’å«ã‚€ã‹ã€ã©ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’æ¤œç´¢ã™ã‚‹ã‹ã€ã¨ã„ã£ãŸã“ã¨ã‚’
ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã«æŒ‡ç¤ºã™ã‚‹ã ã‘ã§ãªãã€ç‰¹å®šã®ãƒ†ã‚¹ãƒˆã‚¨ãƒ³ã‚¸ãƒ³ã«å›ºæœ‰ã®è¿½åŠ ã®è¨­å®šãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼
ã‚’æ¸¡ã—ãŸã„å ´åˆã‚‚ã‚ã‚Šã¾ã™ã€‚ä¾‹ãˆã°ã€JUnit Jupiterã® `TestEngine` ã¯ã€
æ¬¡ã®ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ã®ãŸã‚ã« _è¨­å®šãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼_ ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã¾ã™ã€‚

- <<writing-tests-test-instance-lifecycle-changing-default>>
- <<extensions-registration-automatic-enabling>>
- <<extensions-conditions-deactivation>>

_è¨­å®šãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼_ ã¯ã€ãƒ†ã‚­ã‚¹ãƒˆãƒ™ãƒ¼ã‚¹ã®ã‚­ãƒ¼ã¨å€¤ã®ãƒšã‚¢ã§ã€JUnit Platform
ã§å‹•ä½œã™ã‚‹ãƒ†ã‚¹ãƒˆã‚¨ãƒ³ã‚¸ãƒ³ã«æ¬¡ã®ã„ãšã‚Œã‹ã®æ–¹æ³•ã§æ¸¡ã•ã‚Œã¾ã™ã€‚

1. `LauncherDiscoveryRequestBuilder` ã‚¯ãƒ©ã‚¹ã® `configurationParameter()`
  ã¾ãŸã¯ `configurationParameters()` ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ã£ã¦æ§‹ç¯‰ã—ãŸãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’
  <<launcher-api, `Launcher` API>> ã«æ¸¡ã—ã¾ã™ã€‚JUnit Platform
  ãŒæä¾›ã™ã‚‹ãƒ„ãƒ¼ãƒ«ã‚’ä½¿ã£ã¦ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã™ã‚‹å ´åˆã€è¨­å®šãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ã¯æ¬¡ã®ã‚ˆã†ã«æŒ‡å®šã§ãã¾ã™ã€‚
  * <<running-tests-console-launcher,Console Launcher>>: `--config`
    ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ä½¿ã„ã¾ã™
  * <<running-tests-build-gradle-config-params,Gradleãƒ—ãƒ©ã‚°ã‚¤ãƒ³>>:
    `configurationParameter` ã¾ãŸã¯ `configurationParameters` DSLã‚’ä½¿ã„ã¾ã™
  * <<running-tests-build-maven-config-params,Maven Surefireãƒ—ãƒ­ãƒã‚¤ãƒ€>>:
    `configurationParameters` ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’ä½¿ã„ã¾ã™
2. JVMã‚·ã‚¹ãƒ†ãƒ ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£
3. JUnit Platformè¨­å®šãƒ•ã‚¡ã‚¤ãƒ«: ã‚¯ãƒ©ã‚¹ãƒ‘ã‚¹ã®ãƒ«ãƒ¼ãƒˆã« `junit-platform.properties`
  ã¨ã„ã†åå‰ã§é…ç½®ã•ã‚Œã€Javaã® `Properties` ãƒ•ã‚¡ã‚¤ãƒ«ã¨åŒã˜ã‚·ãƒ³ã‚¿ãƒƒã‚¯ã‚¹ã«å¾“ã„ã¾ã™ã€‚

NOTE: è¨­å®šãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ã¯ã€ä¸Šã§å®šç¾©ã•ã‚ŒãŸé †ç•ªã«å¾“ã£ã¦è§£æ±ºã•ã‚Œã¾ã™ã€‚ã¤ã¾ã‚Šã€
`Launcher` ã«ç›´æ¥ä¸ãˆã‚‰ã‚ŒãŸè¨­å®šãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ã®æ–¹ãŒã€ã‚·ã‚¹ãƒ†ãƒ ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚„è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã§
ä¸ãˆã‚‰ã‚ŒãŸã‚‚ã®ã‚ˆã‚Šå„ªå…ˆã•ã‚Œã¾ã™ã€‚åŒæ§˜ã«ã€ã‚·ã‚¹ãƒ†ãƒ ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã§ä¸ãˆã‚‰ã‚ŒãŸè¨­å®šãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ã®æ–¹ãŒã€
è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã§ä¸ãˆã‚‰ã‚ŒãŸã‚‚ã®ã‚ˆã‚Šå„ªå…ˆã•ã‚Œã¾ã™ã€‚

[[running-tests-tag-expressions]]
=== ã‚¿ã‚°å¼
ã‚¿ã‚°å¼ã¯ã€ `!`, `&`, `|` æ¼”ç®—å­ã‹ã‚‰ãªã‚‹ãƒ–ãƒ¼ãƒ«å¼ã§ã™ã€‚
æ¼”ç®—å­ã®å„ªå…ˆé †ä½ã‚’èª¿æ•´ã™ã‚‹ãŸã‚ã«ã€`(` ã¨ `)` ã‚‚ä½¿ãˆã¾ã™ã€‚

.æ¼”ç®—å­ (å„ªå…ˆé †ä½ã®é™é †)
|===
| æ¼”ç®—å­    | æ„å‘³    | çµåˆæ€§

| `!`      | not     | right
| `&`      | and     | left
| `\|`     | or      | left
|===

ãƒ†ã‚¹ãƒˆã«ç›´äº¤ã™ã‚‹ã‚¿ã‚°ã‚’ä»˜ä¸ã—ã¦ã„ã‚‹å ´åˆã€å®Ÿè¡Œã™ã‚‹ãƒ†ã‚¹ãƒˆã‚’é¸æŠã™ã‚‹ã®ã«ã‚¿ã‚°å¼ã¯ä¾¿åˆ©ã§ã™ã€‚
ãƒ†ã‚¹ãƒˆã®ç¨®é¡ (ä¾‹ãˆã°ã€_micro_, _integration_, _end-to-end_) ã¨æ©Ÿèƒ½
(ä¾‹ãˆã°ã€ *foo*, *bar*, *baz*) ã®ã‚¿ã‚°ã‚’ä»˜ä¸ã™ã‚‹ã¨ã€æ¬¡ã®ã‚ˆã†ãªã‚¿ã‚°å¼ãŒä½¿ãˆã¾ã™ã€‚

[%header,cols="40,60"]
|===
| ã‚¿ã‚°å¼
| è©²å½“ã™ã‚‹ãƒ†ã‚¹ãƒˆ

| +foo+
| *foo* ã«å¯¾ã™ã‚‹ã™ã¹ã¦ã®ãƒ†ã‚¹ãƒˆ

| +bar \| baz+
| *bar* ã¾ãŸã¯ *baz* ã«å¯¾ã™ã‚‹ã™ã¹ã¦ã®ãƒ†ã‚¹ãƒˆ

| +bar & baz+
| *bar* ã‹ã¤ *baz* ã«å¯¾ã™ã‚‹ã™ã¹ã¦ã®ãƒ†ã‚¹ãƒˆ

| +foo & !end-to-end+
| *foo*ã€€ã«å¯¾ã™ã‚‹ãƒ†ã‚¹ãƒˆã®ã†ã¡ã€_end-to-end_ ãƒ¬ãƒ™ãƒ«ä»¥å¤–ã®ã™ã¹ã¦ã®ãƒ†ã‚¹ãƒˆ

| +(micro \| integration) & (foo \| baz)+
| *foo* ã¾ãŸã¯ *baz* ã«å¯¾ã™ã‚‹ãƒ†ã‚¹ãƒˆã®ã†ã¡ã€_micro_ ã¾ãŸã¯ _integration_ ãƒ¬ãƒ™ãƒ«ã®ã™ã¹ã¦ã®ãƒ†ã‚¹ãƒˆ
|===
