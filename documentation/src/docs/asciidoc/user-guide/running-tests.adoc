[[running-tests]]
== ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã™ã‚‹

[[running-tests-ide]]
=== IDEã®ã‚µãƒãƒ¼ãƒˆ

[[running-tests-ide-intellij-idea]]
==== IntelliJ IDEA

IntelliJ IDEAã¯ã€ãƒãƒ¼ã‚¸ãƒ§ãƒ³2016.2ã‹ã‚‰JUnit Platformä¸Šã§ã®ãƒ†ã‚¹ãƒˆå®Ÿè¡Œã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã¾ã™ã€‚
è©³ç´°ã¯ã€
https://blog.jetbrains.com/idea/2016/08/using-junit-5-in-intellij-idea/[IntelliJ IDEAãƒ–ãƒ­ã‚°ã®æŠ•ç¨¿]
ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚ãŸã ã—ã€å®Ÿéš›ã«ã¯IntelliJ IDEA 2017.3ã¾ãŸã¯ãã‚Œã‚ˆã‚Šæ–°ã—ã„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®
åˆ©ç”¨ãŒæ¨å¥¨ã•ã‚Œã‚‹ç‚¹ã«æ³¨æ„ã—ã¦ãã ã•ã„ã€‚ã¨ã„ã†ã®ã‚‚ã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§åˆ©ç”¨ã•ã‚Œã‚‹APIãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«å¿œã˜ã¦
`junit-platform-launcher`, `junit-jupiter-engine`, `junit-vintage-engine`
ã®JARã‚’è‡ªå‹•çš„ã«ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¦ãã‚Œã‚‹ã‹ã‚‰ã§ã™ã€‚

WARNING: IntelliJ IDEAã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³2017.3ã‚ˆã‚Šå‰ã®ãƒªãƒªãƒ¼ã‚¹ã¯ã€JUnit 5
ã®ç‰¹å®šã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’åŒæ¢±ã—ã¦ã„ã‚‹ç‚¹ã«æ³¨æ„ã—ã¦ãã ã•ã„ã€‚ã‚‚ã—ã‚‚JUnit Jupiter
ã®æ–°ã—ã„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ä½¿ã„ãŸã„å ´åˆã€IDEå†…ã§ã®ãƒ†ã‚¹ãƒˆå®Ÿè¡Œã¯ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®ã‚³ãƒ³ãƒ•ãƒªã‚¯ãƒˆã§
å¤±æ•—ã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚ãã®ã‚ˆã†ãªå ´åˆã¯ã€IntelliJ IDEAã«åŒæ¢±ã•ã‚Œã¦ã„ã‚‹
JUnit 5ã‚ˆã‚Šæ–°ã—ã„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ä½¿ã†ãŸã‚ã«ã€ä»¥ä¸‹ã®æ‰‹é †ã«å¾“ã£ã¦ãã ã•ã„ã€‚

JUnit 5ã®ç•°ãªã‚‹ãƒãƒ¼ã‚¸ãƒ§ãƒ³ (ä¾‹ãˆã°ã€ {jupiter-version}) ã‚’ä½¿ã†ã«ã¯ã€
`junit-platform-launcher`, `junit-jupiter-engine`, `junit-vintage-engine`
ã®å¯¾å¿œã™ã‚‹ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®JARã‚’ã‚¯ãƒ©ã‚¹ãƒ‘ã‚¹ã«è¿½åŠ ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

.Gradleã®è¿½åŠ ã®ä¾å­˜é–¢ä¿‚
[source,groovy]
[subs=attributes+]
----
// Only needed to run tests in a version of IntelliJ IDEA that bundles older versions
testRuntime("org.junit.platform:junit-platform-launcher:{platform-version}")
testRuntime("org.junit.jupiter:junit-jupiter-engine:{jupiter-version}")
testRuntime("org.junit.vintage:junit-vintage-engine:{vintage-version}")
----

.Mavenã®è¿½åŠ ã®ä¾å­˜é–¢ä¿‚
[source,xml]
[subs=attributes+]
----
<!-- Only needed to run tests in a version of IntelliJ IDEA that bundles older versions -->
<dependency>
	<groupId>org.junit.platform</groupId>
	<artifactId>junit-platform-launcher</artifactId>
	<version>{platform-version}</version>
	<scope>test</scope>
</dependency>
<dependency>
	<groupId>org.junit.jupiter</groupId>
	<artifactId>junit-jupiter-engine</artifactId>
	<version>{jupiter-version}</version>
	<scope>test</scope>
</dependency>
<dependency>
	<groupId>org.junit.vintage</groupId>
	<artifactId>junit-vintage-engine</artifactId>
	<version>{vintage-version}</version>
	<scope>test</scope>
</dependency>
----

[[running-tests-ide-eclipse]]
==== Eclipse

Eclipse IDEã¯ã€Oxygen.1a (4.7.1a)ãƒªãƒªãƒ¼ã‚¹ã‹ã‚‰JUnit Platformã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã¾ã™ã€‚

Eclipseã§JUnit 5ã‚’ä½¿ã†ãŸã‚ã®æƒ…å ±ã¯ã€å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
https://www.eclipse.org/eclipse/news/4.7.1a/#junit-5-support[Eclipse Project Oxygen.1a
(4.7.1a) - New and Noteworthy] ã® _Eclipse support for JUnit 5_ ã®ç¯€ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

[[running-tests-ide-other]]
==== ãã®ä»–ã®IDE

æœ¬æ›¸åŸ·ç­†æ™‚ç‚¹ã§ã¯ã€IntelliJ IDEAã¨Eclipseä»¥å¤–ã®IDEã¯ã€JUnit Platform
ä¸Šã§ã®ãƒ†ã‚¹ãƒˆå®Ÿè¡Œã‚’ç›´æ¥ã¯ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã¾ã›ã‚“ã€‚ã—ã‹ã—ã€JUnitãƒãƒ¼ãƒ ã¯
ã‚ãªãŸãŒä½¿ã£ã¦ã„ã‚‹IDEã§JUnit 5ã‚’è©¦ã›ã‚‹ã‚ˆã†ã«ã€2ã¤ã®ä¸­é–“è§£ã‚’æä¾›ã—ã¦ã„ã¾ã™ã€‚
<<running-tests-console-launcher>> ã‚’æ‰‹å‹•ã§ä½¿ã†ã‹ã€
<<running-tests-junit-platform-runner,JUnit 4ãƒ™ãƒ¼ã‚¹ã®ãƒ©ãƒ³ãƒŠãƒ¼>>
ã§ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

[[running-tests-build]]
=== ãƒ“ãƒ«ãƒ‰ã‚µãƒãƒ¼ãƒˆ

[[running-tests-build-gradle]]
==== Gradle

Gradleã¯ https://docs.gradle.org/4.6/release-notes.html[ãƒãƒ¼ã‚¸ãƒ§ãƒ³4.6] ã‹ã‚‰ã€
JUnit Platformã§ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã™ã‚‹ãŸã‚ã®æ©Ÿèƒ½ã‚’
https://docs.gradle.org/current/userguide/java_testing.html#using_junit5[ãƒã‚¤ãƒ†ã‚£ãƒ–ã§ã‚µãƒãƒ¼ãƒˆ]
ã—ã¦ã„ã¾ã™ã€‚æœ‰åŠ¹ã«ã™ã‚‹ã«ã¯ã€`build.gradle` ã® `test` ã‚¿ã‚¹ã‚¯å®£è¨€å†…ã§ `useJUnitPlatform()`
ã‚’æŒ‡å®šã™ã‚‹ã ã‘ã§ã™ã€‚

[source,java,indent=0]
[subs=attributes+]
----
test {
    useJUnitPlatform()
}
----

ã‚¿ã‚°ã‚„ãƒ†ã‚¹ãƒˆã‚¨ãƒ³ã‚¸ãƒ³ã«ã‚ˆã‚‹ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã‚‚ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã¾ã™ã€‚

[source,java,indent=0]
[subs=attributes+]
----
test {
    useJUnitPlatform {
        includeTags 'fast', 'smoke & feature-a'
        // excludeTags 'slow', 'ci'
        includeEngines 'junit-jupiter'
        // excludeEngines 'junit-vintage'
	}
}
----

ä½¿ç”¨ã§ãã‚‹ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã®ä¸€è¦§ã¯ã€
https://docs.gradle.org/current/userguide/java_plugin.html#sec:java_test[Gradleå…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ]
ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

[WARNING]
.JUnit Platform Gradleãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã¯å»ƒæ­¢
====
JUnitãƒãƒ¼ãƒ ã«ã‚ˆã£ã¦é–‹ç™ºã•ã‚Œã¦ã„ãŸ `junit-platform-gradle-plugin` ã¯ã€
JUnit Platform 1.2 ã‹ã‚‰éæ¨å¥¨ã¨ãªã‚Šã€1.3 ã§å»ƒæ­¢ã•ã‚Œã¾ã—ãŸã€‚
Gradleæ¨™æº–ã® `test` ã‚¿ã‚¹ã‚¯ã«ç§»è¡Œã—ã¦ãã ã•ã„ã€‚
====

[[running-tests-build-gradle-config-params]]
===== è¨­å®šãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼

Gradleæ¨™æº–ã® `test` ã‚¿ã‚¹ã‚¯ã¯ã€ãƒ†ã‚¹ãƒˆã®ç™ºè¦‹ãƒ»å®Ÿè¡Œã«å½±éŸ¿ã‚’ä¸ãˆã‚‹JUnit Platformã®
<<running-tests-config-params, è¨­å®šãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼>> ã‚’æŒ‡å®šã™ã‚‹å°‚ç”¨DSL
ã‚’ä»Šã®ã¨ã“ã‚æä¾›ã—ã¦ã„ã¾ã›ã‚“ã€‚
ã—ã‹ã—ã€ä»¥ä¸‹ã«ç¤ºã™ã‚ˆã†ã«ãƒ“ãƒ«ãƒ‰ã‚¹ã‚¯ãƒªãƒ—ãƒˆå†…ã§ã‚·ã‚¹ãƒ†ãƒ ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’ä½¿ã†ã‹ã€
`junit-platform.properties` ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½¿ã†ã“ã¨ã§ã€è¨­å®šãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ã‚’æŒ‡å®šã§ãã¾ã™ã€‚

[source,java,indent=0]
----
test {
	// ...
	systemProperty 'junit.jupiter.conditions.deactivate', '*'
	systemProperties = [
		'junit.jupiter.extensions.autodetection.enabled': 'true',
		'junit.jupiter.testinstance.lifecycle.default': 'per_class'
	]
	// ...
}
----

[[running-tests-build-gradle-engines-configure]]
===== ãƒ†ã‚¹ãƒˆã‚¨ãƒ³ã‚¸ãƒ³ã‚’è¨­å®šã™ã‚‹

ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã•ã›ã‚‹ãŸã‚ã«ã¯ã€`TestEngine` ã®å®Ÿè£…ãŒã‚¯ãƒ©ã‚¹ãƒ‘ã‚¹ã«å­˜åœ¨ã—ãªã‘ã‚Œã°ãªã‚Šã¾ã›ã‚“ã€‚

JUnit Jupiterãƒ™ãƒ¼ã‚¹ã®ãƒ†ã‚¹ãƒˆã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹ãŸã‚ã«ã¯ã€JUnit Jupiter API
ã«å¯¾ã™ã‚‹ `testCompile` ä¾å­˜ã¨ã€JUnit Jupiter `TestEngine`
å®Ÿè£…ã«å¯¾ã™ã‚‹ `testRuntime` ä¾å­˜ã‚’æ¬¡ã®ã‚ˆã†ã«æŒ‡å®šã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

[source,java,indent=0]
[subs=attributes+]
----
dependencies {
	testCompile("org.junit.jupiter:junit-jupiter-api:{jupiter-version}")
	testRuntime("org.junit.jupiter:junit-jupiter-engine:{jupiter-version}")
}
----

JUnit Platformã¯ã€JUnit 4ãƒ™ãƒ¼ã‚¹ã®ãƒ†ã‚¹ãƒˆã‚‚å®Ÿè¡Œã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
ãã®ãŸã‚ã«ã¯ã€JUnit 4ã«å¯¾ã™ã‚‹ `testCompile` ä¾å­˜ã¨ã€JUnit Vintage
`TestEngine` å®Ÿè£…ã«å¯¾ã™ã‚‹ `testRuntime` ä¾å­˜ãŒå¿…è¦ã§ã™ã€‚

[source,java,indent=0]
[subs=attributes+]
----
dependencies {
	testCompile("junit:junit:{junit4-version}")
	testRuntime("org.junit.vintage:junit-vintage-engine:{vintage-version}")
}
----

[[running-tests-build-gradle-logging]]
===== ãƒ­ã‚®ãƒ³ã‚°ã‚’è¨­å®šã™ã‚‹ï¼ˆçœç•¥å¯ï¼‰

JUnitã¯ã€`java.util.logging` ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ï¼ˆåˆ¥åã€_JUL_ï¼‰ã® Java Logging API
ã‚’è­¦å‘Šã‚„ãƒ‡ãƒãƒƒã‚°æƒ…å ±ã®å‡ºåŠ›ã«åˆ©ç”¨ã—ã¦ã„ã¾ã™ã€‚è¨­å®šã‚ªãƒ—ã‚·ãƒ§ãƒ³ã«ã¤ã„ã¦ã¯ã€
`{LogManager}` ã®å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

ãƒ­ã‚°ã‚’ {Log4j} ã‚„ {Logback} ã®ã‚ˆã†ãªä»–ã®ãƒ­ã‚®ãƒ³ã‚°ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã™ã‚‹
ã“ã¨ã‚‚å¯èƒ½ã§ã™ã€‚`{LogManager}` ã®ã‚«ã‚¹ã‚¿ãƒ å®Ÿè£…ã‚’æä¾›ã™ã‚‹ãƒ­ã‚®ãƒ³ã‚°ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã‚’
ä½¿ã†å ´åˆã¯ã€`java.util.logging.manager` ã‚·ã‚¹ãƒ†ãƒ ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã« `{LogManager}`
å®Ÿè£…ã‚¯ãƒ©ã‚¹ã® _å®Œå…¨ä¿®é£¾å_ ã‚’æŒ‡å®šã—ã¦ãã ã•ã„ã€‚ä»¥ä¸‹ã¯ã€Log4j{nbsp}2.x
ï¼ˆè©³ç´°ã¯ã€ {Log4j_JDK_Logging_Adapter} å‚ç…§ï¼‰ã‚’è¨­å®šã™ã‚‹ä¾‹ã§ã™ã€‚

[source,java,indent=0]
[subs=attributes+]
----
test {
	systemProperty 'java.util.logging.manager', 'org.apache.logging.log4j.jul.LogManager'
}
----

ãã®ä»–ã®ãƒ­ã‚®ãƒ³ã‚°ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã¯ã€`java.util.logging` ã®ãƒ­ã‚°ã‚’ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã™ã‚‹
æ–¹æ³•ãŒç•°ãªã‚Šã¾ã™ã€‚ä¾‹ãˆã° {Logback} ã§ã¯ã€
https://www.slf4j.org/legacy.html#jul-to-slf4j[JULã‹ã‚‰SLF4Jã¸ã®ãƒ–ãƒªãƒƒã‚¸]
ã‚’å®Ÿè¡Œæ™‚ã®ã‚¯ãƒ©ã‚¹ãƒ‘ã‚¹ã«ä¾å­˜é–¢ä¿‚ã¨ã—ã¦è¿½åŠ ã—ã¦ä½¿ã„ã¾ã™ã€‚

[[running-tests-build-maven]]
==== Maven

NOTE: https://issues.apache.org/jira/browse/SUREFIRE-1330[ãƒãƒ¼ã‚¸ãƒ§ãƒ³ 2.22.0] ã‹ã‚‰ã€
Maven Surefireã¯JUnit Platformä¸Šã§ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã™ã‚‹ãŸã‚ã®
http://maven.apache.org/surefire/maven-surefire-plugin/examples/junit-platform.html[ãƒã‚¤ãƒ†ã‚£ãƒ–ã‚µãƒãƒ¼ãƒˆ]
ã‚’æä¾›ã—ã¦ã„ã¾ã™ã€‚ `{junit5-jupiter-starter-maven}` ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã® `pom.xml`
ãƒ•ã‚¡ã‚¤ãƒ«ãŒãã®ä½¿ã„æ–¹ã‚’ç¤ºã™ã¨ã¨ã‚‚ã«ã€Mavenãƒ“ãƒ«ãƒ‰ã‚’è¨­å®šã™ã‚‹ãŸã‚ã®å‡ºç™ºç‚¹ã¨ãªã‚‹ã§ã—ã‚‡ã†ã€‚

JUnitãƒãƒ¼ãƒ ã¯ã€Maven Surefire 2.22.0ã‚ˆã‚Šå¤ã„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã§ `mvn test` ã§JUnit 4ã¨
JUnit Jupiterã®ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã§ãã‚‹Maven Surefireãƒ—ãƒ­ãƒã‚¤ãƒ€ã‚’é–‹ç™ºã—ã¦ãã¾ã—ãŸã€‚ã—ã‹ã—ã€
Surefire 2.22.0ãŒãƒªãƒªãƒ¼ã‚¹ã•ã‚ŒãŸãŸã‚ã€JUnitãƒãƒ¼ãƒ ã«ã‚ˆã‚‹ `junit-platform-surefire-provider`
ã¯éæ¨å¥¨ã¨ãªã‚Šã€JUnit Platformã®ä»Šå¾Œã®ãƒªãƒªãƒ¼ã‚¹ã§å»ƒæ­¢ã•ã‚Œã¾ã™ã€‚

NOTE: `junit-platform-surefire-provider` ã¨ã¯Maven Surefire {surefire-version}
ã‚’ä½¿ã£ã¦ãã ã•ã„ã€‚

[source,xml,indent=0]
[subs=attributes+]
----
	...
	<build>
		<plugins>
			...
			<plugin>
				<artifactId>maven-surefire-plugin</artifactId>
				<version>{surefire-version}</version>
				<dependencies>
					<dependency>
						<groupId>org.junit.platform</groupId>
						<artifactId>junit-platform-surefire-provider</artifactId>
						<version>{platform-version}</version>
					</dependency>
				</dependencies>
			</plugin>
		</plugins>
	</build>
	...
----

[[running-tests-build-maven-engines-configure]]
===== ãƒ†ã‚¹ãƒˆã‚¨ãƒ³ã‚¸ãƒ³ã‚’è¨­å®šã™ã‚‹

Maven Surefireã«ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã•ã›ã‚‹ãŸã‚ã«ã¯ã€`TestEngine` ã®å®Ÿè£…ãŒ
å®Ÿè¡Œæ™‚ã®ã‚¯ãƒ©ã‚¹ãƒ‘ã‚¹ã«å¿…è¦ã§ã™ã€‚

JUnit Jupiterãƒ™ãƒ¼ã‚¹ã®ãƒ†ã‚¹ãƒˆã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹ãŸã‚ã«ã¯ã€JUnit Jupiter API
ã«å¯¾ã™ã‚‹ `test` ä¾å­˜ã¨ã€JUnit Jupiter `TestEngine` å®Ÿè£…ã«å¯¾ã™ã‚‹
`maven-surefire-plugin` ã®ä¾å­˜ã‚’æ¬¡ã®ã‚ˆã†ã«æŒ‡å®šã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

[source,xml,indent=0]
[subs=attributes+]
----
	...
	<build>
		<plugins>
			...
			<plugin>
				<artifactId>maven-surefire-plugin</artifactId>
				<version>{surefire-version}</version>
				<dependencies>
					<dependency>
						<groupId>org.junit.platform</groupId>
						<artifactId>junit-platform-surefire-provider</artifactId>
						<version>{platform-version}</version>
					</dependency>
					<dependency>
						<groupId>org.junit.jupiter</groupId>
						<artifactId>junit-jupiter-engine</artifactId>
						<version>{jupiter-version}</version>
					</dependency>
				</dependencies>
			</plugin>
		</plugins>
	</build>
	...
	<dependencies>
		...
		<dependency>
			<groupId>org.junit.jupiter</groupId>
			<artifactId>junit-jupiter-api</artifactId>
			<version>{jupiter-version}</version>
			<scope>test</scope>
		</dependency>
	</dependencies>
	...
----

JUnit Platform Surefireãƒ—ãƒ­ãƒã‚¤ãƒ€ã¯ã€JUnit 4ãƒ™ãƒ¼ã‚¹ã®ãƒ†ã‚¹ãƒˆã‚‚å®Ÿè¡Œã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
ãã®ãŸã‚ã«ã¯ã€JUnit 4ã«å¯¾ã™ã‚‹ `test` ä¾å­˜ã¨ã€JUnit Vintage `TestEngine` å®Ÿè£…ã«å¯¾ã™ã‚‹
`maven-surefire-plugin` ã®ä¾å­˜ãŒå¿…è¦ã§ã™ã€‚

[source,xml,indent=0]
[subs=attributes+]
----
	...
	<build>
		<plugins>
			...
			<plugin>
				<artifactId>maven-surefire-plugin</artifactId>
				<version>{surefire-version}</version>
				<dependencies>
					<dependency>
						<groupId>org.junit.platform</groupId>
						<artifactId>junit-platform-surefire-provider</artifactId>
						<version>{platform-version}</version>
					</dependency>
					...
					<dependency>
						<groupId>org.junit.vintage</groupId>
						<artifactId>junit-vintage-engine</artifactId>
						<version>{vintage-version}</version>
					</dependency>
				</dependencies>
			</plugin>
		</plugins>
	</build>
	...
	<dependencies>
		...
		<dependency>
			<groupId>junit</groupId>
			<artifactId>junit</artifactId>
			<version>{junit4-version}</version>
			<scope>test</scope>
		</dependency>
	</dependencies>
	...
----

[[running-tests-build-maven-test-system-property]]
===== å˜ä¸€ã®ãƒ†ã‚¹ãƒˆã‚¯ãƒ©ã‚¹ã‚’å®Ÿè¡Œã™ã‚‹

JUnit Platform Surefireãƒ—ãƒ­ãƒã‚¤ãƒ€ã¯ã€Maven Surefireãƒ—ãƒ©ã‚°ã‚¤ãƒ³ãŒã‚µãƒãƒ¼ãƒˆã™ã‚‹
JVMã‚·ã‚¹ãƒ†ãƒ ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ `test` ã«å¯¾å¿œã—ã¦ã„ã¾ã™ã€‚ä¾‹ãˆã°ã€ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ã‹ã‚‰
`mvn -Dtest=org.example.MyTest test` ã‚’å®Ÿè¡Œã™ã‚‹ã“ã¨ã§ã€ãƒ†ã‚¹ãƒˆã‚¯ãƒ©ã‚¹
`org.example.MyTest` ã®ãƒ†ã‚¹ãƒˆãƒ¡ã‚½ãƒƒãƒ‰ã ã‘ã‚’å®Ÿè¡Œã§ãã¾ã™ã€‚è©³ç´°ã¯ã€
https://maven.apache.org/surefire/maven-surefire-plugin/examples/single-test.html[Maven Surefireãƒ—ãƒ©ã‚°ã‚¤ãƒ³]
ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

[[running-tests-build-maven-filter-test-class-names]]
===== ãƒ†ã‚¹ãƒˆã‚¯ãƒ©ã‚¹åã§ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã™ã‚‹

Maven Surefireãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã¯ã€å®Œå…¨ä¿®é£¾åãŒæ¬¡ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã«ãƒãƒƒãƒã™ã‚‹ãƒ†ã‚¹ãƒˆã‚¯ãƒ©ã‚¹ã‚’æ¢ã—ã¾ã™ã€‚

- `+**/Test*.java+`
- `+**/*Test.java+`
- `+**/*Tests.java+`
- `+**/*TestCase.java+`

ãªãŠã€ã™ã¹ã¦ã®ãƒã‚¹ãƒˆã‚¯ãƒ©ã‚¹ï¼ˆstaticãªå†…éƒ¨ã‚¯ãƒ©ã‚¹ã‚‚å«ã‚€ï¼‰ã¯ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§é™¤å¤–ã•ã‚Œã¾ã™ã€‚

ãŸã ã—ã€`pom.xml` ãƒ•ã‚¡ã‚¤ãƒ«ã® `include` ãŠã‚ˆã³ `exclude`
ãƒ«ãƒ¼ãƒ«ã‚’æ˜ç¤ºçš„ã«è¨­å®šã™ã‚‹ã“ã¨ã§ã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®å‹•ä½œã‚’å¤‰æ›´ã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚
ä¾‹ãˆã°ã€Maven SurefireãŒstaticãªå†…éƒ¨ã‚¯ãƒ©ã‚¹ã‚’é™¤å¤–ã—ãªã„ã‚ˆã†ã«ã™ã‚‹ãªã©ã§ã™ã€‚

[source,xml,indent=0]
[subs=attributes+]
.Maven Surefireã®excludeãƒ«ãƒ¼ãƒ«ã‚’ä¸Šæ›¸ãã™ã‚‹
----
	...
	<build>
		<plugins>
			...
			<plugin>
				<artifactId>maven-surefire-plugin</artifactId>
				<version>{surefire-version}</version>
				<configuration>
					<excludes>
						<exclude/>
					</excludes>
				</configuration>
				...
			</plugin>
		</plugins>
	</build>
	...
----

è©³ç´°ã¯ã€ Maven Surefireã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
https://maven.apache.org/surefire/maven-surefire-plugin/examples/inclusion-exclusion.html[Inclusions and Exclusions of Tests]
ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

[[running-tests-build-maven-filter-tags]]
===== ã‚¿ã‚°ã§ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã™ã‚‹

æ¬¡ã®ã‚ˆã†ã«ã€ã‚¿ã‚°ã¾ãŸã¯ <<running-tests-tag-expressions, ã‚¿ã‚°å¼>>
ã‚’ä½¿ã£ã¦ãƒ†ã‚¹ãƒˆã‚’ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚

- _ã‚¿ã‚°_ ã¾ãŸã¯ _ã‚¿ã‚°å¼_ ã‚’ãƒ†ã‚¹ãƒˆå¯¾è±¡ã«å«ã‚ã‚‹ã«ã¯ã€`groups` ã¾ãŸã¯ `includeTags` ã‚’æŒ‡å®šã—ã¾ã™ã€‚
- _ã‚¿ã‚°_ ã¾ãŸã¯ _ã‚¿ã‚°å¼_ ã‚’ãƒ†ã‚¹ãƒˆå¯¾è±¡ã‹ã‚‰é™¤å¤–ã™ã‚‹ã«ã¯ã€`excludedGroups` ã¾ãŸã¯ `excludeTags` ã‚’æŒ‡å®šã—ã¾ã™ã€‚

[source,xml,indent=0]
[subs=attributes+]
----
	...
	<build>
		<plugins>
			...
			<plugin>
				<artifactId>maven-surefire-plugin</artifactId>
				<version>{surefire-version}</version>
				<configuration>
			        <properties>
			            <includeTags>acceptance | !feature-a</includeTags>
			            <excludeTags>integration, regression</excludeTags>
			        </properties>
			    </configuration>
				<dependencies>
					...
				</dependencies>
			</plugin>
		</plugins>
	</build>
	...
----

[[running-tests-build-maven-config-params]]
===== è¨­å®šãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼

`configurationParameters` ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã«Javaã® `Properties` ãƒ•ã‚¡ã‚¤ãƒ«å½¢å¼ã®
ã‚­ãƒ¼ãƒ»å€¤ã®ãƒšã‚¢ã‚’ä¸ãˆã‚‹ã‹ã€`junit-platform.properties` ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä¸ãˆã‚‹ã“ã¨ã§ã€
ãƒ†ã‚¹ãƒˆã®ç™ºè¦‹ãƒ»å®Ÿè¡Œã«å½±éŸ¿ã‚’ä¸ãˆã‚‹JUnit Platformã®
<<running-tests-config-params, è¨­å®šãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼>> ã‚’æŒ‡å®šã§ãã¾ã™ã€‚

[source,xml,indent=0]
[subs=attributes+]
----
	...
	<build>
		<plugins>
			...
			<plugin>
				<artifactId>maven-surefire-plugin</artifactId>
				<version>{surefire-version}</version>
				<configuration>
					<properties>
						<configurationParameters>
							junit.jupiter.conditions.deactivate = *
							junit.jupiter.extensions.autodetection.enabled = true
							junit.jupiter.testinstance.lifecycle.default = per_class
						</configurationParameters>
					</properties>
				</configuration>
				<dependencies>
					...
				</dependencies>
			</plugin>
		</plugins>
	</build>
	...
----

[[running-tests-build-ant]]
==== Ant

link:https://ant.apache.org/[Ant] ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ `1.10.3` ã‹ã‚‰ã€
JUnit Platformä¸Šã§ã®ãƒ†ã‚¹ãƒˆå®Ÿè¡Œã‚’ãƒã‚¤ãƒ†ã‚£ãƒ–ã‚µãƒãƒ¼ãƒˆã™ã‚‹ãŸã‚ã«
link:https://ant.apache.org/manual/Tasks/junitlauncher.html[`junitlauncher`]
ã‚¿ã‚¹ã‚¯ãŒå°å…¥ã•ã‚Œã¾ã—ãŸã€‚`junitlauncher` ã‚¿ã‚¹ã‚¯ã¯ã€å˜ã«JUnit Platform
ã‚’èµ·å‹•ã—ã¦ã€é¸æŠã—ãŸãƒ†ã‚¹ãƒˆã‚’æ¸¡ã™ã ã‘ã®è²¬å‹™ã‚’ã‚‚ã¡ã¾ã™ã€‚ãã®å¾Œã€JUnit Platform
ãŒç™»éŒ²ã•ã‚ŒãŸãƒ†ã‚¹ãƒˆã‚¨ãƒ³ã‚¸ãƒ³ã«ãƒ†ã‚¹ãƒˆã®ç™ºè¦‹ãƒ»å®Ÿè¡Œã‚’ç§»è­²ã—ã¾ã™ã€‚

`junitlauncher` ã‚¿ã‚¹ã‚¯ã¯ã€
ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒãƒ†ã‚¹ãƒˆã‚¨ãƒ³ã‚¸ãƒ³ã«å®Ÿè¡Œã•ã›ãŸã„ãƒ†ã‚¹ãƒˆã‚’é¸æŠã™ã‚‹ãŸã‚ã®
link:https://ant.apache.org/manual/Types/resources.html#collection[ãƒªã‚½ãƒ¼ã‚¹é›†åˆ]
ã®ã‚ˆã†ã«ã€Antã®æ—¢å­˜æ©Ÿèƒ½ã¨å¯èƒ½ãªé™ã‚Šä¸€è²«æ€§ã‚’ä¿ã¨ã†ã¨ã—ã¦ã„ã¾ã™ã€‚
ã“ã‚Œã«ã‚ˆã‚Šã€Antã®ä»–ã®ã‚³ã‚¢ã‚¿ã‚¹ã‚¯ã¨æ¯”ã¹ã¦ã‚‚ã€ä¸€è²«æ€§ãŒã‚ã‚Šç›´æ„Ÿçš„ãªã‚‚ã®ã«ãªã£ã¦ã„ã¾ã™ã€‚

NOTE: Ant 1.10.3 ã§ãƒªãƒªãƒ¼ã‚¹ã•ã‚ŒãŸ `junitlauncher` ã‚¿ã‚¹ã‚¯ã¯ã€
JUnit Platformã‚’èµ·å‹•ã™ã‚‹åŸºæœ¬çš„ã‹ã¤æœ€ä½é™ã®ã‚µãƒãƒ¼ãƒˆã ã‘ã‚’æä¾›ã—ã¾ã™ã€‚
è¿½åŠ ã®æ©Ÿèƒ½å¼·åŒ– (ç•°ãªã‚‹JVMã«forkã—ã¦ã®ãƒ†ã‚¹ãƒˆå®Ÿè¡Œã‚µãƒãƒ¼ãƒˆã‚’å«ã‚€) ã¯ã€
ä»Šå¾Œã®Antãƒªãƒªãƒ¼ã‚¹ã§åˆ©ç”¨å¯èƒ½ã«ãªã‚‹äºˆå®šã§ã™ã€‚

`{junit5-jupiter-starter-ant}` ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã® `build.xml`
ãƒ•ã‚¡ã‚¤ãƒ«ãŒä½¿ã„æ–¹ã‚’ç¤ºã—ã¦ã„ã¾ã™ã€‚

===== åŸºæœ¬çš„ãªä½¿ã„æ–¹

æ¬¡ã®ä¾‹ã¯ã€å˜ä¸€ã®ãƒ†ã‚¹ãƒˆã‚¯ãƒ©ã‚¹ (`org.myapp.test.MyFirstJUnit5Test`)
ã‚’é¸æŠã™ã‚‹ã‚ˆã†ã« `junitlauncher` ã‚¿ã‚¹ã‚¯ã‚’è¨­å®šã™ã‚‹æ–¹æ³•ã‚’ç¤ºã—ã¾ã™ã€‚

[source,xml,indent=0]
----
	<path id="test.classpath">
		<!-- The location where you have your compiled classes -->
		<pathelement location="${build.classes.dir}" />
	</path>

	<!-- ... -->

	<junitlauncher>
		<classpath refid="test.classpath" />
		<test name="org.myapp.test.MyFirstJUnit5Test" />
	</junitlauncher>
----

`test` è¦ç´ ã§å®Ÿè¡Œã—ãŸã„å˜ä¸€ã®ãƒ†ã‚¹ãƒˆã‚¯ãƒ©ã‚¹ã‚’æŒ‡å®šã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
`classpath` è¦ç´ ã§JUnit Platformã‚’èµ·å‹•ã™ã‚‹ã®ã«ä½¿ã†ã‚¯ãƒ©ã‚¹ãƒ‘ã‚¹ã‚’æŒ‡å®šã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
ã“ã®ã‚¯ãƒ©ã‚¹ãƒ‘ã‚¹ã¯ã€å®Ÿè¡Œã™ã‚‹ãƒ†ã‚¹ãƒˆã‚¯ãƒ©ã‚¹ã‚’æ¢ã™ã®ã«ã‚‚ä½¿ã‚ã‚Œã¾ã™ã€‚

æ¬¡ã®ä¾‹ã¯ã€è¤‡æ•°ã®å ´æ‰€ã‹ã‚‰ãƒ†ã‚¹ãƒˆã‚¯ãƒ©ã‚¹ã‚’é¸æŠã™ã‚‹ã‚ˆã†ã« `junitlauncher`
ã‚¿ã‚¹ã‚¯ã‚’è¨­å®šã™ã‚‹æ–¹æ³•ã‚’ç¤ºã—ã¾ã™ã€‚

[source,xml,indent=0]
----
	<path id="test.classpath">
		<!-- The location where you have your compiled classes -->
		<pathelement location="${build.classes.dir}" />
	</path>
	....
	<junitlauncher>
		<classpath refid="test.classpath" />
		<testclasses outputdir="${output.dir}">
			<fileset dir="${build.classes.dir}">
				<include name="org/example/**/demo/**/" />
			</fileset>
			<fileset dir="${some.other.dir}">
				<include name="org/myapp/**/" />
			</fileset>
		</testclasses>
	</junitlauncher>
----

ä¸Šã®ä¾‹ã®ã‚ˆã†ã« `testclasses` è¦ç´ ã‚’ä½¿ã†ã¨ã€ç•°ãªã‚‹å ´æ‰€ã«ã‚ã‚‹è¤‡æ•°ã®ãƒ†ã‚¹ãƒˆã‚¯ãƒ©ã‚¹ã‚’é¸æŠã§ãã¾ã™ã€‚

ä½¿ã„æ–¹ã¨è¨­å®šã‚ªãƒ—ã‚·ãƒ§ãƒ³ã«é–¢ã™ã‚‹è©³ç´°ã¯ã€Antå…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®
link:https://ant.apache.org/manual/Tasks/junitlauncher.html[`junitlauncher` ã‚¿ã‚¹ã‚¯]
ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

[[running-tests-console-launcher]]
=== Console Launcher

`{ConsoleLauncher}` ã¯ã€ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã‹ã‚‰JUnit Platformã‚’èµ·å‹•ã™ã‚‹ãŸã‚ã®
Javaã®ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ã™ã€‚ä¾‹ãˆã°ã€JUnit Vintageã¨JUnit Jupiter
ã®ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã€çµæœã‚’ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«è¡¨ç¤ºã™ã‚‹ã®ã«ä½¿ãˆã¾ã™ã€‚

ã™ã¹ã¦ã®ä¾å­˜é–¢ä¿‚ã‚’å«ã‚“ã å®Ÿè¡Œå¯èƒ½ãª `junit-platform-console-standalone-{platform-version}.jar`
ãŒMavenã‚»ãƒ³ãƒˆãƒ©ãƒ«ãƒªãƒã‚¸ãƒˆãƒªã®
https://repo1.maven.org/maven2/org/junit/platform/junit-platform-console-standalone[junit-platform-console-standalone]
ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã§å…¬é–‹ã•ã‚Œã¦ã„ã¾ã™ã€‚ã‚¹ã‚¿ãƒ³ãƒ‰ã‚¢ãƒ­ãƒ³ç‰ˆã® `ConsoleLauncher` ã¯ã€æ¬¡ã®ã‚ˆã†ã«
https://docs.oracle.com/javase/tutorial/deployment/jar/run.html[å®Ÿè¡Œã™ã‚‹] ã“ã¨ãŒã§ãã¾ã™ã€‚

`java -jar junit-platform-console-standalone-{platform-version}.jar <<<running-tests-console-launcher-options>>>`

å‡ºåŠ›ã®ä¾‹ã¯æ¬¡ã®é€šã‚Šã§ã™ã€‚

....
â”œâ”€ JUnit Vintage
â”‚  â””â”€ example.JUnit4Tests
â”‚     â””â”€ standardJUnit4Test âœ”
â””â”€ JUnit Jupiter
   â”œâ”€ StandardTests
   â”‚  â”œâ”€ succeedingTest() âœ”
   â”‚  â””â”€ skippedTest() â†· for demonstration purposes
   â””â”€ A special test case
      â”œâ”€ Custom test name containing spaces âœ”
      â”œâ”€ â•¯Â°â–¡Â°ï¼‰â•¯ âœ”
      â””â”€ ğŸ˜± âœ”

Test run finished after 64 ms
[         5 containers found      ]
[         0 containers skipped    ]
[         5 containers started    ]
[         0 containers aborted    ]
[         5 containers successful ]
[         0 containers failed     ]
[         6 tests found           ]
[         1 tests skipped         ]
[         5 tests started         ]
[         0 tests aborted         ]
[         5 tests successful      ]
[         0 tests failed          ]
....

.çµ‚äº†ã‚³ãƒ¼ãƒ‰
NOTE: `{ConsoleLauncher}` ã¯ã€ã‚³ãƒ³ãƒ†ãƒŠã‚„ãƒ†ã‚¹ãƒˆãŒå¤±æ•—ã™ã‚‹ã¨ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰ `1` ã§çµ‚äº†ã—ã¾ã™ã€‚
ãƒ†ã‚¹ãƒˆãŒè¦‹ã¤ã‹ã‚‰ãšã€ã‹ã¤ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ã‚ªãƒ—ã‚·ãƒ§ãƒ³ `--fail-if-no-tests` ãŒæŒ‡å®šã•ã‚Œã¦ã„ãŸå ´åˆã¯ã€
`ConsoleLauncher` ã¯ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰ `2` ã§çµ‚äº†ã—ã¾ã™ã€‚ãã®ä»–ã®å ´åˆã¯ã€çµ‚äº†ã‚³ãƒ¼ãƒ‰ã¯ `0` ã§ã™ã€‚

[[running-tests-console-launcher-options]]
==== ã‚ªãƒ—ã‚·ãƒ§ãƒ³

----
include::{consoleLauncherOptionsFile}[]
----

[[running-tests-console-launcher-argument-files]]
==== Argument Files (@-files)

On some platforms you may run into system limitations on the length of a command line
when creating a command line with lots of options or with long arguments.

Since version 1.3, the `ConsoleLauncher` supports _argument files_, also known as
_@-files_. Argument files are files that themselves contain arguments to be passed to the
command. When the underlying https://github.com/remkop/picocli[picocli] command line
parser encounters an argument beginning with the character `@`, it expands the contents
of that file into the argument list.

The arguments within a file can be separated by spaces or newlines. If an argument
contains embedded whitespace, the whole argument should be wrapped in double or single
quotes -- for example, `"-f=My Files/Stuff.java"`.

If the argument file does not exist or cannot be read, the argument will be treated
literally and will not be removed. This will likely result in an "unmatched argument"
error message. You can troubleshoot such errors by executing the command with the
`picocli.trace` system property set to `DEBUG`.

Multiple _@-files_ may be specified on the command line. The specified path may be
relative to the current directory or absolute.

You can pass a real parameter with an initial `@` character by escaping it with an
additional `@` symbol. For example, `@@somearg` will become `@somearg` and will not be
subject to expansion.


[[running-tests-junit-platform-runner]]
=== JUnit Platformã®å®Ÿè¡Œã«JUnit 4ã‚’ä½¿ã†

`JUnitPlatform` ãƒ©ãƒ³ãƒŠãƒ¼ã¯ã€JUnit Platformã®ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ãƒ¢ãƒ‡ãƒ«ã«å¾“ã£ãŸãƒ†ã‚¹ãƒˆ
ï¼ˆä¾‹ãˆã°ã€JUnit Jupiterã®ãƒ†ã‚¹ãƒˆã‚¯ãƒ©ã‚¹ï¼‰ã‚’JUnit 4ç’°å¢ƒã§å®Ÿè¡Œå¯èƒ½ã«ã™ã‚‹ãŸã‚ã®
JUnit 4ãƒ™ãƒ¼ã‚¹ã® `Runner` ã§ã™ã€‚

ãƒ†ã‚¹ãƒˆã‚¯ãƒ©ã‚¹ã« `@RunWith(JUnitPlatform.class)` ã‚¢ãƒãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ä»˜ä¸ã™ã‚‹ã¨ã€
ã¾ã JUnit Platformã‚’ç›´æ¥ã¯ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ãªã„ã‘ã‚Œã©ã‚‚JUnit 4ãªã‚‰ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã‚‹
IDEã‚„ãƒ“ãƒ«ãƒ‰ã‚·ã‚¹ãƒ†ãƒ ã§ã‚‚å®Ÿè¡Œã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

NOTE: JUnit Platformã¯JUnit 4ã«ãªã„æ©Ÿèƒ½ã‚’ã‚‚ã£ã¦ã„ã‚‹ãŸã‚ã€ç‰¹ã«ãƒ¬ãƒãƒ¼ãƒˆå‘¨ã‚Š
(<<running-tests-junit-platform-runner-technical-names>> ã‚’å‚ç…§)ãªã©ã€
JUnit Platformã®æ©Ÿèƒ½ã®ã‚µãƒ–ã‚»ãƒƒãƒˆã—ã‹ã‚µãƒãƒ¼ãƒˆã™ã‚‹ã“ã¨ãŒã§ãã¾ã›ã‚“ã€‚
ã—ã‹ã—ã€ã•ã—ã‚ãŸã£ã¦ã¯ `JUnitPlatform` ãƒ©ãƒ³ãƒŠãƒ¼ã‚’ä½¿ã£ã¦å§‹ã‚ã‚‹ã®ãŒç°¡å˜ã§ã™ã€‚

[[running-tests-junit-platform-runner-setup]]
==== ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

ã‚¯ãƒ©ã‚¹ãƒ‘ã‚¹ã«ä»¥ä¸‹ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã¨ãã®ä¾å­˜ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒå¿…è¦ã§ã™ã€‚Group IDã‚„Artifact IDã€
ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®è©³ç´°ã«ã¤ã„ã¦ã¯ã€ <<dependency-metadata>> ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

===== æ˜ç¤ºçš„ãªä¾å­˜é–¢ä¿‚

* `junit-platform-runner` ã¯ _test_ ã‚¹ã‚³ãƒ¼ãƒ—: `JUnitPlatform` ãƒ©ãƒ³ãƒŠãƒ¼ãŒå«ã¾ã‚Œã‚‹
* `junit-{junit4-version}.jar` ã¯ _test_ ã‚¹ã‚³ãƒ¼ãƒ—: JUnit 4ã‚’ä½¿ã£ã¦ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã™ã‚‹ãŸã‚
* `junit-jupiter-api` ã¯ _test_ ã‚¹ã‚³ãƒ¼ãƒ—: `@Test` ãªã©JUnit Jupiterã‚’ä½¿ã£ã¦ãƒ†ã‚¹ãƒˆã‚’æ›¸ããŸã‚ã®API
* `junit-jupiter-engine` ã¯ _test runtime_ ã‚¹ã‚³ãƒ¼ãƒ—: JUnit Jupiterã®ãŸã‚ã® `TestEngine` APIå®Ÿè£…

===== æ¨ç§»çš„ãªä¾å­˜é–¢ä¿‚

* `junit-platform-suite-api` ã¯ _test_ ã‚¹ã‚³ãƒ¼ãƒ—
* `junit-platform-launcher` ã¯ _test_ ã‚¹ã‚³ãƒ¼ãƒ—
* `junit-platform-engine` ã¯ _test_ ã‚¹ã‚³ãƒ¼ãƒ—
* `junit-platform-commons` ã¯ _test_ ã‚¹ã‚³ãƒ¼ãƒ—
* `opentest4j` ã¯ _test_ ã‚¹ã‚³ãƒ¼ãƒ—

[[running-tests-junit-platform-runner-technical-names]]
==== è¡¨ç¤ºå vs. æŠ€è¡“å

[TIP]
====
è¨³æ³¨ï¼šæœ¬æ–‡æ›¸ã§ã¯ _Display Name_ ã«å¯¾ã—ã¦ _è¡¨ç¤ºå_ ã¨ã„ã†è¨³èªã‚’ä½¿ç”¨ã—ã€
æœ¬ç¯€ã§ç™»å ´ã™ã‚‹ _Technical Name_ ã«å¯¾ã—ã¦ã¯ _æŠ€è¡“å_ ã¨ã„ã†è¨³èªã‚’ä½¿ç”¨ã—ãŸã€‚
ã—ã‹ã—ã€å¾Œè€…ã¯ç›´æ„Ÿçš„ã§ã¯ãªã„ã¨æ€ã†ã®ã§ã€é©åˆ‡ãªè¨³ãŒã‚ã‚Œã°ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã‚’ã„ãŸã ããŸã„ã€‚
====

`@RunWith(JUnitPlatform.class)` ãƒ©ãƒ³ãƒŠãƒ¼ã§å®Ÿè¡Œã•ã‚Œã‚‹ã‚¯ãƒ©ã‚¹ã«ã‚«ã‚¹ã‚¿ãƒ ã®
_è¡¨ç¤ºå (display name)_ ã‚’å®šç¾©ã™ã‚‹ãŸã‚ã«ã¯ã€`@SuiteDisplayName`
ã‚¢ãƒãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ä»˜ä¸ã—ã¾ã™ã€‚

ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯ã€ _è¡¨ç¤ºå_ ã¯ãƒ†ã‚¹ãƒˆã®æˆæœç‰©ã«ä½¿ã‚ã‚Œã¾ã™ã€‚ã—ã‹ã—ã€Gradleã‚„
Mavenã®ã‚ˆã†ãªãƒ“ãƒ«ãƒ‰ãƒ„ãƒ¼ãƒ«ãŒ `JUnitPlatform` ãƒ©ãƒ³ãƒŠãƒ¼ã‚’ä½¿ã†å ´åˆã€
ç”Ÿæˆã•ã‚Œã‚‹ãƒ†ã‚¹ãƒˆãƒ¬ãƒãƒ¼ãƒˆã«ã¯ã€ãƒ†ã‚¹ãƒˆã‚¯ãƒ©ã‚¹ã®å˜ç´”åã‚„
ç‰¹æ®Šæ–‡å­—ã‚’å«ã‚€ã‚«ã‚¹ã‚¿ãƒ è¡¨ç¤ºåã§ã¯ãªãã€å®Œå…¨ä¿®é£¾ã‚¯ãƒ©ã‚¹åã®ã‚ˆã†ãª
_æŠ€è¡“å (technical name)_ ãŒå¿…è¦ã«ãªã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚
ãƒ¬ãƒãƒ¼ãƒˆå‡ºåŠ›ã§ _æŠ€è¡“å_ ã‚’æœ‰åŠ¹ã«ã™ã‚‹ãŸã‚ã«ã¯ã€
`@RunWith(JUnitPlatform.class)` ã¨ä¸€ç·’ã« `@UseTechnicalNames`
ã‚¢ãƒãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®£è¨€ã—ã¦ãã ã•ã„ã€‚

`@UseTechnicalNames` ã‚’ä»˜ä¸ã™ã‚‹ã¨ã€`@SuiteDisplayName`
ã§ã—ãŸã‚«ã‚¹ã‚¿ãƒ è¡¨ç¤ºåã¯ç„¡è¦–ã•ã‚Œã‚‹ç‚¹ã«æ³¨æ„ã—ã¦ãã ã•ã„ã€‚

[[running-tests-junit-platform-runner-single-test]]
==== å˜ä¸€ã®ãƒ†ã‚¹ãƒˆã‚¯ãƒ©ã‚¹

`JUnitPlatform` ãƒ©ãƒ³ãƒŠãƒ¼ã‚’ä½¿ã†æ–¹æ³•ã®1ã¤ã¯ã€ãƒ†ã‚¹ãƒˆã‚¯ãƒ©ã‚¹ã«ç›´æ¥
`@RunWith(JUnitPlatform.class)` ã‚¢ãƒãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ä»˜ä¸ã™ã‚‹ã“ã¨ã§ã™ã€‚
ä»¥ä¸‹ã®ä¾‹ã®ãƒ†ã‚¹ãƒˆãƒ¡ã‚½ãƒƒãƒ‰ã«ã¯ã€`org.junit.Test` (JUnit Vintage) ã§ã¯ãªãã€
`org.junit.jupiter.api.Test` (JUnit Jupiter)
ã‚¢ãƒãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ãŒä»˜ä¸ã•ã‚Œã¦ã„ã‚‹ç‚¹ã«æ³¨æ„ã—ã¦ãã ã•ã„ã€‚ã•ã‚‰ã«ã€
ã“ã®å ´åˆã¯ãƒ†ã‚¹ãƒˆã‚¯ãƒ©ã‚¹ã‚’ `public` ã«ã—ãªã‘ã‚Œã°ãªã‚‰ãªã„ç‚¹ã«ã‚‚æ³¨æ„ã—ã¦ãã ã•ã„ã€‚
ãã†ã—ãªã„ã¨ã€ä¸€éƒ¨ã®IDEã‚„ãƒ“ãƒ«ãƒ‰ãƒ„ãƒ¼ãƒ«ã§ã¯JUnit 4ã®ãƒ†ã‚¹ãƒˆã‚¯ãƒ©ã‚¹ã¨ã—ã¦
èªè­˜ã•ã‚Œã¾ã›ã‚“ã€‚

[source,java,indent=0]
----
include::{testDir}/example/JUnit4ClassDemo.java[tags=user_guide]
----

[[running-tests-junit-platform-runner-test-suite]]
==== ãƒ†ã‚¹ãƒˆã‚¹ã‚¤ãƒ¼ãƒˆ

è¤‡æ•°ã®ãƒ†ã‚¹ãƒˆã‚¯ãƒ©ã‚¹ãŒã‚ã‚‹å ´åˆã€æ¬¡ã®ä¾‹ã®ã‚ˆã†ã«ãƒ†ã‚¹ãƒˆã‚¹ã‚¤ãƒ¼ãƒˆã‚’ä½œæˆã§ãã¾ã™ã€‚

[source,java,indent=0]
----
include::{testDir}/example/JUnit4SuiteDemo.java[tags=user_guide]
----

`JUnit4SuiteDemo` ã¯ã€`example` ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¨ãã®ã‚µãƒ–ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‹ã‚‰
ã™ã¹ã¦ã®ãƒ†ã‚¹ãƒˆã‚’æ¢ã—ã¦å®Ÿè¡Œã—ã¾ã™ã€‚ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯ã€åå‰ãŒ `Test` ã§å§‹ã¾ã‚‹ã‹ã€
`Test` ã¾ãŸã¯ `Tests` ã§çµ‚ã‚ã‚‹ãƒ†ã‚¹ãƒˆã‚¯ãƒ©ã‚¹ã ã‘ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚

.è¿½åŠ ã®è¨­å®šã‚ªãƒ—ã‚·ãƒ§ãƒ³
NOTE: `@SelectPackages` ä»¥å¤–ã«ã‚‚ã€ãƒ†ã‚¹ãƒˆã‚’æ¤œç´¢ã—ãŸã‚Šãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã—ãŸã‚Šã™ã‚‹ãŸã‚ã®
è¨­å®šã‚ªãƒ—ã‚·ãƒ§ãƒ³ãŒã‚ã‚Šã¾ã™ã€‚è©³ç´°ã¯ã€
{javadoc-root}/org/junit/platform/suite/api/package-summary.html[Javadoc]
ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

[[running-tests-config-params]]
=== è¨­å®šãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼

ã©ã®ãƒ†ã‚¹ãƒˆã‚¯ãƒ©ã‚¹ã‚„ãƒ†ã‚¹ãƒˆã‚¨ãƒ³ã‚¸ãƒ³ã‚’å«ã‚€ã‹ã€ã©ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’æ¤œç´¢ã™ã‚‹ã‹ã€ã¨ã„ã£ãŸã“ã¨ã‚’
ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã«æŒ‡ç¤ºã™ã‚‹ã ã‘ã§ãªãã€ç‰¹å®šã®ãƒ†ã‚¹ãƒˆã‚¨ãƒ³ã‚¸ãƒ³ã‚„æ‹¡å¼µæ©Ÿèƒ½ã«å›ºæœ‰ã®
è¿½åŠ ã®è¨­å®šãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ã‚’æ¸¡ã—ãŸã„å ´åˆã‚‚ã‚ã‚Šã¾ã™ã€‚ä¾‹ãˆã°ã€JUnit Jupiterã® `TestEngine`
ã¯ã€æ¬¡ã®ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ã®ãŸã‚ã« _è¨­å®šãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼_ ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã¾ã™ã€‚

- <<writing-tests-test-instance-lifecycle-changing-default>>
- <<extensions-registration-automatic-enabling>>
- <<extensions-conditions-deactivation>>

_è¨­å®šãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼_ ã¯ã€ãƒ†ã‚­ã‚¹ãƒˆãƒ™ãƒ¼ã‚¹ã®ã‚­ãƒ¼ã¨å€¤ã®ãƒšã‚¢ã§ã€JUnit Platform
ã§å‹•ä½œã™ã‚‹ãƒ†ã‚¹ãƒˆã‚¨ãƒ³ã‚¸ãƒ³ã«æ¬¡ã®ã„ãšã‚Œã‹ã®æ–¹æ³•ã§æ¸¡ã•ã‚Œã¾ã™ã€‚

1. `LauncherDiscoveryRequestBuilder` ã‚¯ãƒ©ã‚¹ã® `configurationParameter()`
  ã¾ãŸã¯ `configurationParameters()` ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ã£ã¦æ§‹ç¯‰ã—ãŸãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’
  <<launcher-api, `Launcher` API>> ã«æ¸¡ã—ã¾ã™ã€‚JUnit Platform
  ãŒæä¾›ã™ã‚‹ãƒ„ãƒ¼ãƒ«ã‚’ä½¿ã£ã¦ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã™ã‚‹å ´åˆã€è¨­å®šãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ã¯æ¬¡ã®ã‚ˆã†ã«æŒ‡å®šã§ãã¾ã™ã€‚
  * <<running-tests-console-launcher,Console Launcher>>: `--config`
    ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ä½¿ã„ã¾ã™
  * <<running-tests-build-gradle-config-params,Gradle>>:
    `systemProperty` ã¾ãŸã¯ `systemProperties` DSLã‚’ä½¿ã„ã¾ã™
  * <<running-tests-build-maven-config-params,Maven Surefireãƒ—ãƒ­ãƒã‚¤ãƒ€>>:
    `configurationParameters` ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’ä½¿ã„ã¾ã™
2. JVMã‚·ã‚¹ãƒ†ãƒ ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£
3. JUnit Platformè¨­å®šãƒ•ã‚¡ã‚¤ãƒ«: ã‚¯ãƒ©ã‚¹ãƒ‘ã‚¹ã®ãƒ«ãƒ¼ãƒˆã« `junit-platform.properties`
  ã¨ã„ã†åå‰ã§é…ç½®ã•ã‚Œã€Javaã® `Properties` ãƒ•ã‚¡ã‚¤ãƒ«ã¨åŒã˜ã‚·ãƒ³ã‚¿ãƒƒã‚¯ã‚¹ã«å¾“ã„ã¾ã™ã€‚

NOTE: è¨­å®šãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ã¯ã€ä¸Šã§å®šç¾©ã•ã‚ŒãŸé †ç•ªã«å¾“ã£ã¦è§£æ±ºã•ã‚Œã¾ã™ã€‚ã¤ã¾ã‚Šã€
`Launcher` ã«ç›´æ¥ä¸ãˆã‚‰ã‚ŒãŸè¨­å®šãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ã®æ–¹ãŒã€ã‚·ã‚¹ãƒ†ãƒ ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚„è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã§
ä¸ãˆã‚‰ã‚ŒãŸã‚‚ã®ã‚ˆã‚Šå„ªå…ˆã•ã‚Œã¾ã™ã€‚åŒæ§˜ã«ã€ã‚·ã‚¹ãƒ†ãƒ ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã§ä¸ãˆã‚‰ã‚ŒãŸè¨­å®šãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ã®æ–¹ãŒã€
è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã§ä¸ãˆã‚‰ã‚ŒãŸã‚‚ã®ã‚ˆã‚Šå„ªå…ˆã•ã‚Œã¾ã™ã€‚

[[running-tests-tag-expressions]]
=== ã‚¿ã‚°å¼
ã‚¿ã‚°å¼ã¯ã€ `!`, `&`, `|` æ¼”ç®—å­ã‹ã‚‰ãªã‚‹ãƒ–ãƒ¼ãƒ«å¼ã§ã™ã€‚
æ¼”ç®—å­ã®å„ªå…ˆé †ä½ã‚’èª¿æ•´ã™ã‚‹ãŸã‚ã«ã€`(` ã¨ `)` ã‚‚ä½¿ãˆã¾ã™ã€‚

.æ¼”ç®—å­ (å„ªå…ˆé †ä½ã®é™é †)
|===
| æ¼”ç®—å­    | æ„å‘³    | çµåˆæ€§

| `!`      | not     | right
| `&`      | and     | left
| `\|`     | or      | left
|===

ãƒ†ã‚¹ãƒˆã«ç›´äº¤ã™ã‚‹ã‚¿ã‚°ã‚’ä»˜ä¸ã—ã¦ã„ã‚‹å ´åˆã€å®Ÿè¡Œã™ã‚‹ãƒ†ã‚¹ãƒˆã‚’é¸æŠã™ã‚‹ã®ã«ã‚¿ã‚°å¼ã¯ä¾¿åˆ©ã§ã™ã€‚
ãƒ†ã‚¹ãƒˆã®ç¨®é¡ (ä¾‹ãˆã°ã€_micro_, _integration_, _end-to-end_) ã¨æ©Ÿèƒ½
(ä¾‹ãˆã°ã€ *foo*, *bar*, *baz*) ã®ã‚¿ã‚°ã‚’ä»˜ä¸ã™ã‚‹ã¨ã€æ¬¡ã®ã‚ˆã†ãªã‚¿ã‚°å¼ãŒä½¿ãˆã¾ã™ã€‚

[%header,cols="40,60"]
|===
| ã‚¿ã‚°å¼
| è©²å½“ã™ã‚‹ãƒ†ã‚¹ãƒˆ

| +foo+
| *foo* ã«å¯¾ã™ã‚‹ã™ã¹ã¦ã®ãƒ†ã‚¹ãƒˆ

| +bar \| baz+
| *bar* ã¾ãŸã¯ *baz* ã«å¯¾ã™ã‚‹ã™ã¹ã¦ã®ãƒ†ã‚¹ãƒˆ

| +bar & baz+
| *bar* ã‹ã¤ *baz* ã«å¯¾ã™ã‚‹ã™ã¹ã¦ã®ãƒ†ã‚¹ãƒˆ

| +foo & !end-to-end+
| *foo*ã€€ã«å¯¾ã™ã‚‹ãƒ†ã‚¹ãƒˆã®ã†ã¡ã€_end-to-end_ ãƒ¬ãƒ™ãƒ«ä»¥å¤–ã®ã™ã¹ã¦ã®ãƒ†ã‚¹ãƒˆ

| +(micro \| integration) & (foo \| baz)+
| *foo* ã¾ãŸã¯ *baz* ã«å¯¾ã™ã‚‹ãƒ†ã‚¹ãƒˆã®ã†ã¡ã€_micro_ ã¾ãŸã¯ _integration_ ãƒ¬ãƒ™ãƒ«ã®ã™ã¹ã¦ã®ãƒ†ã‚¹ãƒˆ
|===

[[running-tests-capturing-output]]
=== Capturing Standard Output/Error

Since version 1.3, the JUnit Platform provides opt-in support for capturing output
printed to `System.out` and `System.err`. To enable it, simply set the
`junit.platform.output.capture.stdout` and/or `junit.platform.output.capture.stderr`
<<running-tests-config-params, configuration parameter>> to `true`. In addition, you may
configure the maximum number of buffered bytes to be used per executed test or container
using `junit.platform.output.capture.maxBuffer`.

If enabled, the JUnit Platform captures the corresponding output and publishes it as a
report entry using the `stdout` or `stderr` keys to all registered
`{TestExecutionListener}` instances immediately before reporting the test or container as
finished.

Please note that the captured output will only contain output emitted by the thread that
was used to execute a container or test. Any output by other threads will be omitted
because particularly when
<<writing-tests-parallel-execution, executing tests in parallel>> it would be impossible
to attribute it to a specific test or container.

WARNING: Capturing output is currently an _experimental_ feature. You're invited to give
it a try and provide feedback to the JUnit team so they can improve and eventually
<<api-evolution, promote>> this feature.
