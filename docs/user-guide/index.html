<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.6.1">
<meta name="author" content="Stefan Bechtold, Sam Brannen, Johannes Link, Matthias Merdes, Marc Philipp, Christian Stein">
<title>JUnit 5 ユーザーガイド</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | http://asciidoctor.org */
/* Remove comment around @import statement below when using as a custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}
audio,canvas,video{display:inline-block}
audio:not([controls]){display:none;height:0}
[hidden],template{display:none}
script{display:none!important}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:transparent}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
input[type="search"]{-webkit-appearance:textfield;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;box-sizing:content-box}
input[type="search"]::-webkit-search-cancel-button,input[type="search"]::-webkit-search-decoration{-webkit-appearance:none}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*:before,*:after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.spread{width:100%}
p.lead,.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{font-size:1.21875em;line-height:1.6}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:none}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #ddddd8;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite:before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media only screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7;font-weight:bold}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt,table tr:nth-of-type(even){background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix:before,.clearfix:after,.float-group:before,.float-group:after{content:" ";display:table}
.clearfix:after,.float-group:after{clear:both}
*:not(pre)>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background-color:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed;word-wrap:break-word}
*:not(pre)>code.nobreak{word-wrap:normal}
*:not(pre)>code.nowrap{white-space:nowrap}
pre,pre>code{line-height:1.45;color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;text-rendering:optimizeSpeed}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background-color:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button:before,b.button:after{position:relative;top:-1px;font-weight:400}
b.button:before{content:"[";padding:0 3px 0 2px}
b.button:after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header:before,#header:after,#content:before,#content:after,#footnotes:before,#footnotes:after,#footer:before,#footer:after{content:" ";display:table}
#header:after,#content:after,#footnotes:after,#footer:after{clear:both}
#content{margin-top:1.25em}
#content:before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #ddddd8}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #ddddd8;padding-bottom:8px}
#header .details{border-bottom:1px solid #ddddd8;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span:before{content:"\00a0\2013\00a0"}
#header .details br+span.author:before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark:before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber:after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #ddddd8;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #efefed;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media only screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background-color:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #efefed;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #efefed;left:auto;right:0}}
@media only screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background-color:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
.sect1{padding-bottom:.625em}
@media only screen and (min-width:768px){.sect1{padding-bottom:1.25em}}
.sect1+.sect1{border-top:1px solid #efefed}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor:before,h2>a.anchor:before,h3>a.anchor:before,#toctitle>a.anchor:before,.sidebarblock>.content>.title>a.anchor:before,h4>a.anchor:before,h5>a.anchor:before,h6>a.anchor:before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock>caption.title{white-space:nowrap;overflow:visible;max-width:0}
.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>.paragraph:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:initial}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #ddddd8;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock pre:not(.highlight),.listingblock pre[class="highlight"],.listingblock pre[class^="highlight "],.listingblock pre.CodeRay,.listingblock pre.prettyprint{background:#f7f7f8}
.sidebarblock .literalblock pre,.sidebarblock .listingblock pre:not(.highlight),.sidebarblock .listingblock pre[class="highlight"],.sidebarblock .listingblock pre[class^="highlight "],.sidebarblock .listingblock pre.CodeRay,.sidebarblock .listingblock pre.prettyprint{background:#f2f1f1}
.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;padding:1em;font-size:.8125em}
.literalblock pre.nowrap,.literalblock pre[class].nowrap,.listingblock pre.nowrap,.listingblock pre[class].nowrap{overflow-x:auto;white-space:pre;word-wrap:normal}
@media only screen and (min-width:768px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:.90625em}}
@media only screen and (min-width:1280px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:1em}}
.literalblock.output pre{color:#f7f7f8;background-color:rgba(0,0,0,.9)}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.listingblock>.content{position:relative}
.listingblock code[data-lang]:before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:#999}
.listingblock:hover code[data-lang]:before{display:block}
.listingblock.terminal pre .command:before{content:attr(data-prompt);padding-right:.5em;color:#999}
.listingblock.terminal pre .command:not([data-prompt]):before{content:"$"}
table.pyhltable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.pyhltable td{vertical-align:top;padding-top:0;padding-bottom:0;line-height:1.45}
table.pyhltable td.code{padding-left:.75em;padding-right:0}
pre.pygments .lineno,table.pyhltable td:not(.code){color:#999;padding-left:0;padding-right:.5em;border-right:1px solid #ddddd8}
pre.pygments .lineno{display:inline-block;margin-right:.25em}
table.pyhltable .linenodiv{background:none!important;padding-right:0!important}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock blockquote p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote:before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.5em;margin-right:.5ex;text-align:right}
.quoteblock .quoteblock{margin-left:0;margin-right:0;padding:.5em 0;border-left:3px solid rgba(0,0,0,.6)}
.quoteblock .quoteblock blockquote{padding:0 0 0 .75em}
.quoteblock .quoteblock blockquote:before{display:none}
.verseblock{margin:0 1em 1.25em 1em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract{margin:0 0 1.25em 0;display:block}
.quoteblock.abstract blockquote,.quoteblock.abstract blockquote p{text-align:left;word-spacing:0}
.quoteblock.abstract blockquote:before,.quoteblock.abstract blockquote p:first-of-type:before{display:none}
table.tableblock{max-width:100%;border-collapse:separate}
table.tableblock td>.paragraph:last-child p>p:last-child,table.tableblock th>p:last-child,table.tableblock td>p:last-child{margin-bottom:0}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>thead>tr>.tableblock,table.grid-all>tbody>tr>.tableblock{border-width:0 1px 1px 0}
table.grid-all>tfoot>tr>.tableblock{border-width:1px 1px 0 0}
table.grid-cols>*>tr>.tableblock{border-width:0 1px 0 0}
table.grid-rows>thead>tr>.tableblock,table.grid-rows>tbody>tr>.tableblock{border-width:0 0 1px 0}
table.grid-rows>tfoot>tr>.tableblock{border-width:1px 0 0 0}
table.grid-all>*>tr>.tableblock:last-child,table.grid-cols>*>tr>.tableblock:last-child{border-right-width:0}
table.grid-all>tbody>tr:last-child>.tableblock,table.grid-all>thead:last-child>tr>.tableblock,table.grid-rows>tbody>tr:last-child>.tableblock,table.grid-rows>thead:last-child>tr>.tableblock{border-bottom-width:0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot{border-width:1px 0}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
td>div.verse{white-space:pre}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
ul.inline{margin:0 auto .625em auto;margin-left:-1.375em;margin-right:0;padding:0;list-style:none;overflow:hidden}
ul.inline>li{list-style:none;float:left;margin-left:1.375em;display:block}
ul.inline>li>*{display:block}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist>table tr>td:first-of-type{padding:.4em .75em 0 .75em;line-height:1;vertical-align:top}
.colist>table tr>td:first-of-type img{max-width:initial}
.colist>table tr>td:last-of-type{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left,.imageblock[style*="float: left"]{margin:.25em .625em 1.25em 0}
.imageblock.right,.imageblock[style*="float: right"]{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em 0;border-width:1px 0 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;text-indent:-1.05em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background-color:#00fafa}
.black{color:#000}
.black-background{background-color:#000}
.blue{color:#0000bf}
.blue-background{background-color:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background-color:#fa00fa}
.gray{color:#606060}
.gray-background{background-color:#7d7d7d}
.green{color:#006000}
.green-background{background-color:#007d00}
.lime{color:#00bf00}
.lime-background{background-color:#00fa00}
.maroon{color:#600000}
.maroon-background{background-color:#7d0000}
.navy{color:#000060}
.navy-background{background-color:#00007d}
.olive{color:#606000}
.olive-background{background-color:#7d7d00}
.purple{color:#600060}
.purple-background{background-color:#7d007d}
.red{color:#bf0000}
.red-background{background-color:#fa0000}
.silver{color:#909090}
.silver-background{background-color:#bcbcbc}
.teal{color:#006060}
.teal-background{background-color:#007d7d}
.white{color:#bfbfbf}
.white-background{background-color:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background-color:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note:before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip:before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning:before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution:before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important:before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background-color:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]:after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background-color:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@media print{@page{margin:1.25cm .75cm}
*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare):after,a[href^="https:"]:not(.bare):after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]:after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #ddddd8!important;padding-bottom:0!important}
.sect1{padding-bottom:0!important}
.sect1+.sect1{border:0!important}
#header>h1:first-child{margin-top:1.25rem}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em 0}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span:before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]:before{display:block}
#footer{background:none!important;padding:0 .9375em}
#footer-text{color:rgba(0,0,0,.6)!important;font-size:.9em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css">
<style>
/* Stylesheet for CodeRay to match GitHub theme | MIT License | http://foundation.zurb.com */
/*pre.CodeRay {background-color:#f7f7f8;}*/
.CodeRay .line-numbers{border-right:1px solid #d8d8d8;padding:0 0.5em 0 .25em}
.CodeRay span.line-numbers{display:inline-block;margin-right:.5em;color:rgba(0,0,0,.3)}
.CodeRay .line-numbers strong{color:rgba(0,0,0,.4)}
table.CodeRay{border-collapse:separate;border-spacing:0;margin-bottom:0;border:0;background:none}
table.CodeRay td{vertical-align: top;line-height:1.45}
table.CodeRay td.line-numbers{text-align:right}
table.CodeRay td.line-numbers>pre{padding:0;color:rgba(0,0,0,.3)}
table.CodeRay td.code{padding:0 0 0 .5em}
table.CodeRay td.code>pre{padding:0}
.CodeRay .debug{color:#fff !important;background:#000080 !important}
.CodeRay .annotation{color:#007}
.CodeRay .attribute-name{color:#000080}
.CodeRay .attribute-value{color:#700}
.CodeRay .binary{color:#509}
.CodeRay .comment{color:#998;font-style:italic}
.CodeRay .char{color:#04d}
.CodeRay .char .content{color:#04d}
.CodeRay .char .delimiter{color:#039}
.CodeRay .class{color:#458;font-weight:bold}
.CodeRay .complex{color:#a08}
.CodeRay .constant,.CodeRay .predefined-constant{color:#008080}
.CodeRay .color{color:#099}
.CodeRay .class-variable{color:#369}
.CodeRay .decorator{color:#b0b}
.CodeRay .definition{color:#099}
.CodeRay .delimiter{color:#000}
.CodeRay .doc{color:#970}
.CodeRay .doctype{color:#34b}
.CodeRay .doc-string{color:#d42}
.CodeRay .escape{color:#666}
.CodeRay .entity{color:#800}
.CodeRay .error{color:#808}
.CodeRay .exception{color:inherit}
.CodeRay .filename{color:#099}
.CodeRay .function{color:#900;font-weight:bold}
.CodeRay .global-variable{color:#008080}
.CodeRay .hex{color:#058}
.CodeRay .integer,.CodeRay .float{color:#099}
.CodeRay .include{color:#555}
.CodeRay .inline{color:#000}
.CodeRay .inline .inline{background:#ccc}
.CodeRay .inline .inline .inline{background:#bbb}
.CodeRay .inline .inline-delimiter{color:#d14}
.CodeRay .inline-delimiter{color:#d14}
.CodeRay .important{color:#555;font-weight:bold}
.CodeRay .interpreted{color:#b2b}
.CodeRay .instance-variable{color:#008080}
.CodeRay .label{color:#970}
.CodeRay .local-variable{color:#963}
.CodeRay .octal{color:#40e}
.CodeRay .predefined{color:#369}
.CodeRay .preprocessor{color:#579}
.CodeRay .pseudo-class{color:#555}
.CodeRay .directive{font-weight:bold}
.CodeRay .type{font-weight:bold}
.CodeRay .predefined-type{color:inherit}
.CodeRay .reserved,.CodeRay .keyword {color:#000;font-weight:bold}
.CodeRay .key{color:#808}
.CodeRay .key .delimiter{color:#606}
.CodeRay .key .char{color:#80f}
.CodeRay .value{color:#088}
.CodeRay .regexp .delimiter{color:#808}
.CodeRay .regexp .content{color:#808}
.CodeRay .regexp .modifier{color:#808}
.CodeRay .regexp .char{color:#d14}
.CodeRay .regexp .function{color:#404;font-weight:bold}
.CodeRay .string{color:#d20}
.CodeRay .string .string .string{background:#ffd0d0}
.CodeRay .string .content{color:#d14}
.CodeRay .string .char{color:#d14}
.CodeRay .string .delimiter{color:#d14}
.CodeRay .shell{color:#d14}
.CodeRay .shell .delimiter{color:#d14}
.CodeRay .symbol{color:#990073}
.CodeRay .symbol .content{color:#a60}
.CodeRay .symbol .delimiter{color:#630}
.CodeRay .tag{color:#008080}
.CodeRay .tag-special{color:#d70}
.CodeRay .variable{color:#036}
.CodeRay .insert{background:#afa}
.CodeRay .delete{background:#faa}
.CodeRay .change{color:#aaf;background:#007}
.CodeRay .head{color:#f8f;background:#505}
.CodeRay .insert .insert{color:#080}
.CodeRay .delete .delete{color:#800}
.CodeRay .change .change{color:#66f}
.CodeRay .head .head{color:#f4f}
</style>
<link rel="icon" type="image/png" href="https://junit.org/junit5/assets/img/junit5-logo.png" />

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-88560400-3"></script>
<script>
    if (window.location.host == "oohira.github.io") {
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'UA-88560400-3');
    }
</script>
</head>
<body id="user-guide" class="article toc2 toc-left">
<div id="header">
<h1>JUnit 5 ユーザーガイド</h1>
<div class="details">
<span id="author" class="author">Stefan Bechtold</span><br>
<span id="author2" class="author">Sam Brannen</span><br>
<span id="author3" class="author">Johannes Link</span><br>
<span id="author4" class="author">Matthias Merdes</span><br>
<span id="author5" class="author">Marc Philipp</span><br>
<span id="author6" class="author">Christian Stein</span><br>
<span id="revnumber">version 5.2.0</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#overview">1. 概要</a>
<ul class="sectlevel2">
<li><a href="#overview-what-is-junit-5">1.1. JUnit 5とは</a></li>
<li><a href="#overview-java-versions">1.2. サポートされるJavaバージョン</a></li>
<li><a href="#overview-getting-help">1.3. 助けてもらうには</a></li>
</ul>
</li>
<li><a href="#installation">2. インストール</a>
<ul class="sectlevel2">
<li><a href="#dependency-metadata">2.1. 依存関係メタデータ</a></li>
<li><a href="#dependency-diagram">2.2. 依存関係図</a></li>
<li><a href="#dependency-metadata-junit-jupiter-samples">2.3. JUnit Jupiterサンプルプロジェクト</a></li>
</ul>
</li>
<li><a href="#writing-tests">3. テストを書く</a>
<ul class="sectlevel2">
<li><a href="#writing-tests-annotations">3.1. アノテーション</a></li>
<li><a href="#writing-tests-classes-and-methods">3.2. テストクラスとテストメソッド</a></li>
<li><a href="#writing-tests-display-names">3.3. 表示名</a></li>
<li><a href="#writing-tests-assertions">3.4. アサーション</a></li>
<li><a href="#writing-tests-assumptions">3.5. 前提条件</a></li>
<li><a href="#writing-tests-disabling">3.6. テストの無効化</a></li>
<li><a href="#writing-tests-conditional-execution">3.7. 条件付きテスト実行</a></li>
<li><a href="#writing-tests-tagging-and-filtering">3.8. タグとフィルタリング</a></li>
<li><a href="#writing-tests-test-instance-lifecycle">3.9. テストインスタンスのライフサイクル</a></li>
<li><a href="#writing-tests-nested">3.10. ネストしたテスト</a></li>
<li><a href="#writing-tests-dependency-injection">3.11. コンストラクタとメソッドへの依存性注入</a></li>
<li><a href="#writing-tests-test-interfaces-and-default-methods">3.12. テストインターフェースとデフォルトメソッド</a></li>
<li><a href="#writing-tests-repeated-tests">3.13. 繰り返しテスト</a></li>
<li><a href="#writing-tests-parameterized-tests">3.14. パラメーター化テスト</a></li>
<li><a href="#writing-tests-parameterized-tests-consuming-arguments">3.15. パラメーターの消費</a></li>
<li><a href="#writing-tests-test-templates">3.16. テストテンプレート</a></li>
<li><a href="#writing-tests-dynamic-tests">3.17. 動的テスト</a></li>
</ul>
</li>
<li><a href="#running-tests">4. テストを実行する</a>
<ul class="sectlevel2">
<li><a href="#running-tests-ide">4.1. IDEのサポート</a></li>
<li><a href="#running-tests-build">4.2. ビルドサポート</a></li>
<li><a href="#running-tests-console-launcher">4.3. Console Launcher</a></li>
<li><a href="#running-tests-junit-platform-runner">4.4. JUnit Platformの実行にJUnit 4を使う</a></li>
<li><a href="#running-tests-config-params">4.5. 設定パラメーター</a></li>
<li><a href="#running-tests-tag-expressions">4.6. タグ式</a></li>
</ul>
</li>
<li><a href="#extensions">5. 拡張モデル</a>
<ul class="sectlevel2">
<li><a href="#extensions-overview">5.1. 概要</a></li>
<li><a href="#extensions-registration">5.2. 拡張機能の登録</a></li>
<li><a href="#extensions-conditions">5.3. 条件付きテスト実行</a></li>
<li><a href="#extensions-test-instance-post-processing">5.4. テストインスタンスの後処理</a></li>
<li><a href="#extensions-parameter-resolution">5.5. 引数の解決</a></li>
<li><a href="#extensions-lifecycle-callbacks">5.6. テストライフサイクルコールバック</a></li>
<li><a href="#extensions-exception-handling">5.7. 例外ハンドリング</a></li>
<li><a href="#extensions-test-templates">5.8. テストテンプレートに実行コンテキストを与える</a></li>
<li><a href="#extensions-keeping-state">5.9. 拡張機能の状態を保持する</a></li>
<li><a href="#extensions-supported-utilities">5.10. 拡張機能でサポートされるユーティリティ</a></li>
<li><a href="#extensions-execution-order">5.11. ユーザーコードと拡張機能の相対的な実行順序</a></li>
</ul>
</li>
<li><a href="#migrating-from-junit4">6. JUnit 4からの移行</a>
<ul class="sectlevel2">
<li><a href="#migrating-from-junit4-running">6.1. JUnit Platform上でJUnit 4テストを実行する</a></li>
<li><a href="#migrating-from-junit4-tips">6.2. 移行のヒント</a></li>
<li><a href="#migrating-from-junit4-rule-support">6.3. JUnit 4のルールの限定的なサポート</a></li>
</ul>
</li>
<li><a href="#advanced-topics">7. Advanced Topics</a>
<ul class="sectlevel2">
<li><a href="#launcher-api">7.1. JUnit Platform Launcher API</a></li>
</ul>
</li>
<li><a href="#api-evolution">8. APIの進化</a>
<ul class="sectlevel2">
<li><a href="#api-evolution-version-and-status">8.1. APIバージョンとステータス</a></li>
<li><a href="#api-evolution-experimental-apis">8.2. 実験的なAPI</a></li>
<li><a href="#api-evolution-tooling">8.3. @APIツールサポート</a></li>
</ul>
</li>
<li><a href="#contributors">9. コントリビューター</a></li>
<li><a href="#release-notes">10. リリースノート</a></li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="overview"><a class="anchor" href="#overview"></a>1. 概要</h2>
<div class="sectionbody">
<div class="paragraph">
<p>この文書は、テストを書くプログラマーや拡張機能の作者、ビルドツールやIDEを含むテストエンジンの作者に対して、
包括的なリファレンスを提供することを目的としています。</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="title">Translations</div>
<div class="paragraph">
<p>『JUnit 5 User Guide』の
<a href="https://junit.org/junit5/docs/5.2.0/user-guide/">v5.2.0</a>
時点の日本語訳です。最新の情報は、
<a href="https://junit.org/junit5/docs/current/user-guide/">公式サイト</a> を参照してください。
誤訳や誤植などのフィードバックは、
<a href="https://github.com/oohira/junit5-doc-jp">GitHub</a> または <a href="https://twitter.com/oohira">@oohira</a>
までお願いします。</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="overview-what-is-junit-5"><a class="anchor" href="#overview-what-is-junit-5"></a>1.1. JUnit 5とは</h3>
<div class="paragraph">
<p>これまでのバージョンのJUnitとは異なり、JUnit 5は
3つのサブプロジェクトに含まれる複数のモジュールで構成されます。</p>
</div>
<div class="paragraph">
<p><strong>JUnit 5 = <em>JUnit Platform</em> + <em>JUnit Jupiter</em> + <em>JUnit Vintage</em></strong></p>
</div>
<div class="paragraph">
<p><strong>JUnit Platform</strong> は、JVM上で <a href="#launcher-api">テストフレームワークを起動する</a>
ための基盤となり、このプラットフォーム上で動作するテストフレームワークを開発するための
<code><a href="https://junit.org/junit5/docs/5.2.0/api/org/junit/platform/engine/TestEngine.html">TestEngine</a></code> APIを定義しています。加えて、コマンドラインからプラットフォームを起動するための
<a href="#running-tests-console-launcher">Console Launcher</a> や、
<a href="#running-tests-build-gradle">Gradle</a> と <a href="#running-tests-build-maven">Maven</a>
用のビルドプラグイン、 <a href="#running-tests-junit-platform-runner">JUnit 4ベースのテストランナー</a>
などを提供し、あらゆる <code>TestEngine</code> を実行できるようになっています。</p>
</div>
<div class="paragraph">
<p><strong>JUnit Jupiter</strong> は、JUnit 5でテストや拡張機能を書くための新しい
<a href="#writing-tests">プログラミングモデル</a> と <a href="#extensions">拡張モデル</a> の組み合わせです。
Jupiterサブプロジェクトは、プラットフォーム上でJupiterベースのテストを実行するための
<code>TestEngine</code> を提供します。</p>
</div>
<div class="paragraph">
<p><strong>JUnit Vintage</strong> は、プラットフォーム上でJUnit 3またはJUnit 4
ベースのテストを実行するための <code>TestEngine</code> を提供します。</p>
</div>
</div>
<div class="sect2">
<h3 id="overview-java-versions"><a class="anchor" href="#overview-java-versions"></a>1.2. サポートされるJavaバージョン</h3>
<div class="paragraph">
<p>JUnit 5を実行するには、Java 8（またはそれ以上）が必要となります。
ただし、それより古いバージョンのJDKでコンパイルされたコードをテストすることは可能です。</p>
</div>
</div>
<div class="sect2">
<h3 id="overview-getting-help"><a class="anchor" href="#overview-getting-help"></a>1.3. 助けてもらうには</h3>
<div class="paragraph">
<p><a href="https://stackoverflow.com/questions/tagged/junit5">Stack Overflow</a> で質問するか、 <a href="https://gitter.im/junit-team/junit5">Gitter</a> で私たちにチャットしてください。</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="installation"><a class="anchor" href="#installation"></a>2. インストール</h2>
<div class="sectionbody">
<div class="paragraph">
<p>最終リリースや各マイルストーンでの成果物は、Maven Centralリポジトリにデプロイされています。</p>
</div>
<div class="paragraph">
<p>スナップショットは、Sonatype <a href="https://oss.sonatype.org/content/repositories/snapshots">スナップショットリポジトリ</a> の
<a href="https://oss.sonatype.org/content/repositories/snapshots/org/junit/">/org/junit</a> 以下にデプロイされています。</p>
</div>
<div class="sect2">
<h3 id="dependency-metadata"><a class="anchor" href="#dependency-metadata"></a>2.1. 依存関係メタデータ</h3>
<div class="sect3">
<h4 id="dependency-metadata-junit-platform"><a class="anchor" href="#dependency-metadata-junit-platform"></a>2.1.1. JUnit Platform</h4>
<div class="ulist">
<ul>
<li>
<p><strong>Group ID</strong>: <code>org.junit.platform</code></p>
</li>
<li>
<p><strong>Version</strong>: <code>1.2.0</code></p>
</li>
<li>
<p><strong>Artifact IDs</strong>:</p>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>junit-platform-commons</code></dt>
<dd>
<p>JUnitの内部的な共通ライブラリ／ユーティリティです。これらのユーティリティは、
JUnitフレームワーク自身で使われることだけを想定しています。
<em>外部のプログラムからの利用はサポートされていません。</em> 利用は自己責任で！</p>
</dd>
<dt class="hdlist1"><code>junit-platform-console</code></dt>
<dd>
<p>コンソールからJUnit Platform上でテストを見つけて実行する機能を提供します。
詳細は、 <a href="#running-tests-console-launcher">Console Launcher</a> を参照してください。</p>
</dd>
<dt class="hdlist1"><code>junit-platform-console-standalone</code></dt>
<dd>
<p>すべての依存関係を含む実行可能なJARは、Maven Centralリポジトリの
<a href="https://repo1.maven.org/maven2/org/junit/platform/junit-platform-console-standalone">junit-platform-console-standalone</a>
ディレクトリで提供されています。詳細は、 <a href="#running-tests-console-launcher">Console Launcher</a> を参照してください。</p>
</dd>
<dt class="hdlist1"><code>junit-platform-engine</code></dt>
<dd>
<p>テストエンジンの公開APIです。詳細は、 <a href="#launcher-api-engines-custom">Plugging in Your Own Test Engine</a> を参照してください。</p>
</dd>
<dt class="hdlist1"><code>junit-platform-gradle-plugin</code></dt>
<dd>
<p><a href="#running-tests-build-gradle">Gradle</a> を使って、
JUnit Platform上でテストを見つけて実行する機能を提供します。</p>
</dd>
<dt class="hdlist1"><code>junit-platform-launcher</code></dt>
<dd>
<p>テストプランを構成して起動するための公開APIです。通常は、IDEやビルドツールに使われます。
詳細は、 <a href="#launcher-api">JUnit Platform Launcher API</a> を参照してください。</p>
</dd>
<dt class="hdlist1"><code>junit-platform-runner</code></dt>
<dd>
<p>JUnit Platform上のテストおよびテストスイートをJUnit 4環境で実行するテストランナーです。
詳細は、 <a href="#running-tests-junit-platform-runner">JUnit Platformの実行にJUnit 4を使う</a> を参照してください。</p>
</dd>
<dt class="hdlist1"><code>junit-platform-suite-api</code></dt>
<dd>
<p>JUnit Platform上でテストスイートを構成するためのアノテーションです。
<a href="#running-tests-junit-platform-runner">JUnitPlatformランナー</a>
と（おそらく）サードパーティーの <code>TestEngine</code> 実装にもサポートされます。</p>
</dd>
<dt class="hdlist1"><code>junit-platform-surefire-provider</code></dt>
<dd>
<p><a href="#running-tests-build-maven">Maven Surefire</a> を使って、
JUnit Platform上でテストを見つけて実行する機能を提供します。</p>
</dd>
</dl>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="dependency-metadata-junit-jupiter"><a class="anchor" href="#dependency-metadata-junit-jupiter"></a>2.1.2. JUnit Jupiter</h4>
<div class="ulist">
<ul>
<li>
<p><strong>Group ID</strong>: <code>org.junit.jupiter</code></p>
</li>
<li>
<p><strong>Version</strong>: <code>5.2.0</code></p>
</li>
<li>
<p><strong>Artifact IDs</strong>:</p>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>junit-jupiter-api</code></dt>
<dd>
<p>JUnit Jupiterで <a href="#writing-tests">テスト</a> や <a href="#extensions">拡張機能</a> を書くためのAPIです。</p>
</dd>
<dt class="hdlist1"><code>junit-jupiter-engine</code></dt>
<dd>
<p>JUnit Jupiterのテストエンジン実装です。実行時だけ必要になります。</p>
</dd>
<dt class="hdlist1"><code>junit-jupiter-params</code></dt>
<dd>
<p>JUnit Jupiterで <a href="#writing-tests-parameterized-tests">パラメーター化テスト</a> をサポートします。</p>
</dd>
<dt class="hdlist1"><code>junit-jupiter-migrationsupport</code></dt>
<dd>
<p>JUnit 4からJUnit Jupiterへの移行をサポートします。
JUnit Jupiter上で、JUnit 4ルールを実行したいときだけ必要になります。</p>
</dd>
</dl>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="dependency-metadata-junit-vintage"><a class="anchor" href="#dependency-metadata-junit-vintage"></a>2.1.3. JUnit Vintage</h4>
<div class="ulist">
<ul>
<li>
<p><strong>Group ID</strong>: <code>org.junit.vintage</code></p>
</li>
<li>
<p><strong>Version</strong>: <code>5.2.0</code></p>
</li>
<li>
<p><strong>Artifact ID</strong>:</p>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>junit-vintage-engine</code></dt>
<dd>
<p>JUnit Vintageのテストエンジン実装です。JUnit 3またはJUnit 4で書かれた昔のテストを
新しいJUnit Platform上で実行できるようにします。</p>
</dd>
</dl>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="dependency-metadata-junit-bom"><a class="anchor" href="#dependency-metadata-junit-bom"></a>2.1.4. Bill of Materials (BOM)</h4>
<div class="paragraph">
<p><em>Bill of Materials</em> POM を使うと、
<a href="https://maven.apache.org/guides/introduction/introduction-to-dependency-mechanism.html#Importing_Dependencies">Maven</a>
または
<a href="https://docs.gradle.org/current/userguide/managing_transitive_dependencies.html#sec:bom_import">Gradle</a>
で前述のライブラリを複数参照するときに依存関係の管理を容易にすることができます。</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Group ID</strong>: <code>org.junit</code></p>
</li>
<li>
<p><strong>Artifact ID</strong>: <code>junit-bom</code></p>
</li>
<li>
<p><strong>Version</strong>: <code>5.2.0</code></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="dependency-metadata-dependencies"><a class="anchor" href="#dependency-metadata-dependencies"></a>2.1.5. 依存関係</h4>
<div class="paragraph">
<p>前述のすべてのJARが次の <em>@API Guardian</em> JARに依存しています。</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Group ID</strong>: <code>org.apiguardian</code></p>
</li>
<li>
<p><strong>Artifact ID</strong>: <code>apiguardian-api</code></p>
</li>
<li>
<p><strong>Version</strong>: <code>1.0.0</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>加えて、ほとんどのJARが次の <em>OpenTest4J</em> JARに直接または間接的に依存しています。</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Group ID</strong>: <code>org.opentest4j</code></p>
</li>
<li>
<p><strong>Artifact ID</strong>: <code>opentest4j</code></p>
</li>
<li>
<p><strong>Version</strong>: <code>1.1.0</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="dependency-diagram"><a class="anchor" href="#dependency-diagram"></a>2.2. 依存関係図</h3>
<div class="imageblock">
<div class="content">
<img src="images/component-diagram.svg" alt="component diagram" width="1940" height="618">
</div>
</div>
</div>
<div class="sect2">
<h3 id="dependency-metadata-junit-jupiter-samples"><a class="anchor" href="#dependency-metadata-junit-jupiter-samples"></a>2.3. JUnit Jupiterサンプルプロジェクト</h3>
<div class="paragraph">
<p><a href="https://github.com/junit-team/junit5-samples"><code>junit5-samples</code></a> リポジトリは、
JUnit JupiterベースとJUnit Vintageベースのプロジェクトの様々なサンプルを提供します。
次のプロジェクトで <code>build.gradle</code> と <code>pom.xml</code> を見つけられるでしょう。</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Gradleの場合は、<code><a href="https://github.com/junit-team/junit5-samples/tree/master/junit5-jupiter-starter-gradle">junit5-jupiter-starter-gradle</a></code> プロジェクトを参照してください</p>
</li>
<li>
<p>Mavenの場合は、<code><a href="https://github.com/junit-team/junit5-samples/tree/master/junit5-jupiter-starter-maven">junit5-jupiter-starter-maven</a></code> プロジェクトを参照してください</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="writing-tests"><a class="anchor" href="#writing-tests"></a>3. テストを書く</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="title">最初のテストケース</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">static</span> <span class="include">org.junit.jupiter.api.Assertions.assertEquals</span>;

<span class="keyword">import</span> <span class="include">org.junit.jupiter.api.Test</span>;

<span class="type">class</span> <span class="class">FirstJUnit5Tests</span> {

    <span class="annotation">@Test</span>
    <span class="type">void</span> myFirstTest() {
        assertEquals(<span class="integer">2</span>, <span class="integer">1</span> + <span class="integer">1</span>);
    }

}</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="writing-tests-annotations"><a class="anchor" href="#writing-tests-annotations"></a>3.1. アノテーション</h3>
<div class="paragraph">
<p>JUnit Jupiterは、テストを構成し、フレームワークを拡張するために、次のアノテーションをサポートします。</p>
</div>
<div class="paragraph">
<p>中心となるすべてのアノテーションは、 <code>junit-jupiter-api</code> モジュールの <code><a href="https://junit.org/junit5/docs/5.2.0/api/org/junit/jupiter/api/package-summary.html">org.junit.jupiter.api</a></code> パッケージに含まれます。</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">アノテーション</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@Test</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">このメソッドが、テストメソッドであることを示します。JUnit 4の <code>@Test</code> アノテーションとは異なり、このアノテーションはどんな属性も宣言しません。というのも、JUnit Jupiterのテスト拡張は、それ専用のアノテーションベースで行われるからです。このメソッドは、<em>オーバーライド</em> されない限り、<em>継承</em> されます。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@ParameterizedTest</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">このメソッドが、<a href="#writing-tests-parameterized-tests">パラメーター化テスト</a> であることを示します。このメソッドは、<em>オーバーライド</em> されない限り、<em>継承</em> されます。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@RepeatedTest</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">このメソッドが、<a href="#writing-tests-repeated-tests">繰り返しテスト</a> のためのテストテンプレートであることを示します。このメソッドは、<em>オーバーライド</em> されない限り、<em>継承</em> されます。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@TestFactory</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">このメソッドが、<a href="#writing-tests-dynamic-tests">動的テスト</a> のためのテストファクトリであることを示します。このメソッドは、<em>オーバーライド</em> されない限り、<em>継承</em> されます。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@TestInstance</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">アノテーションを付与したテストクラスに対して、<a href="#writing-tests-test-instance-lifecycle">テストインスタンスのライフサイクル</a> を設定するために使われます。このアノテーションは、<em>継承</em> されます。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@TestTemplate</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">このメソッドが、<a href="#writing-tests-test-templates">テストケースのテンプレート</a> であることを示します。このメソッドは、登録した <a href="#extensions-test-templates">プロバイダ</a> が返す実行コンテキストの数に応じて、複数回呼び出されます。このメソッドは、<em>オーバーライド</em> されない限り、<em>継承</em> されます。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@DisplayName</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">テストクラスやテストメソッドにカスタムの表示名を指定します。このアノテーションは、<em>継承</em> されません。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@BeforeEach</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">このメソッドが、現在のクラスの <code>@Test</code>, <code>@RepeatedTest</code>, <code>@ParameterizedTest</code>, <code>@TestFactory</code> メソッドの <em>前に毎回</em> 実行されるよう指定します。JUnit 4の <code>@Before</code> と同じです。このメソッドは、<em>オーバーライド</em> されない限り、<em>継承</em> されます。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@AfterEach</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">このメソッドが、現在のクラスの <code>@Test</code>, <code>@RepeatedTest</code>, <code>@ParameterizedTest</code>, <code>@TestFactory</code> メソッドの <em>後に毎回</em> 実行されるよう指定します。JUnit 4の <code>@After</code> と同じです。このメソッドは、<em>オーバーライド</em> されない限り、<em>継承</em> されます。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@BeforeAll</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">このメソッドが、現在のクラスの <strong>すべての</strong> <code>@Test</code>, <code>@RepeatedTest</code>, <code>@ParameterizedTest</code>, <code>@TestFactory</code> メソッドの <em>前に一度だけ</em> 実行されるよう指定します。JUnit 4の <code>@BeforeClass</code> と同じです。 このメソッドは、（<em>隠す</em> か <em>オーバーライドする</em> かしない限り）<em>継承</em> されますが、（<a href="#writing-tests-test-instance-lifecycle">テストインスタンスのライフサイクル</a> に "per-class" が使われない限り）<code>static</code> でなければいけません。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@AfterAll</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">このメソッドが、現在のクラスの <strong>すべての</strong> <code>@Test</code>, <code>@RepeatedTest</code>, <code>@ParameterizedTest</code>, <code>@TestFactory</code> メソッドの <em>後に一度だけ</em> 実行されるよう指定します。JUnit 4の <code>@AfterClass</code> と同じです。このメソッドは、（<em>隠す</em> か <em>オーバーライドする</em> かしない限り）<em>継承</em> されますが、（<a href="#writing-tests-test-instance-lifecycle">テストインスタンスのライフサイクル</a> に "per-class" が使われない限り）<code>static</code> でなければいけません。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@Nested</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">このクラスが、ネストした非staticのテストクラスであることを示します。 <code>@BeforeAll</code> および <code>@AfterAll</code> メソッドは、<a href="#writing-tests-test-instance-lifecycle">テストインスタンスのライフサイクル</a> に "per-class" が使われない限り、<code>@Nested</code> テストクラスの中で直接使うことはできません。このアノテーションは、<em>継承</em> されません。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@Tag</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">クラスまたはメソッドレベルでテストをフィルタリングするための <em>タグ</em> を宣言するのに使われます。TestNGのテストグループやJUnit 4のCategoryと同じです。このアノテーションは、クラスレベルでは <em>継承</em> されますが、メソッドレベルでは <em>継承</em> されません。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@Disabled</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">テストクラスやテストメソッドを <em>無効化</em> するのに使われます。JUnit 4の <code>@Ignore</code> と同じです。このアノテーションは、<em>継承</em> されません。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@ExtendWith</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">カスタムの <a href="#extensions">拡張機能</a> を登録するために使われます。このアノテーションは、<em>継承</em> されます。</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><code>@Test</code>, <code>@TestTemplate</code>, <code>@RepeatedTest</code>, <code>@BeforeAll</code>, <code>@AfterAll</code>, <code>@BeforeEach</code>, <code>@AfterEach</code>
アノテーションの付与されたメソッドは、戻り値を返してはいけません。</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
いくつかのアノテーションは現在 <em>実験中</em> です。詳細は、
<a href="#api-evolution-experimental-apis">実験的なAPI</a> のテーブルを参照してください。
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="writing-tests-meta-annotations"><a class="anchor" href="#writing-tests-meta-annotations"></a>3.1.1. メタアノテーションと合成アノテーション</h4>
<div class="paragraph">
<p>JUnit Jupiterアノテーションは、<em>メタアノテーション</em> として使うことができます。つまり、
メタアノテーションの意味を自動的に <em>継承</em> した独自の <em>合成アノテーション</em> を作れるということです。</p>
</div>
<div class="paragraph">
<p>例えば、<code>@Tag("fast")</code> をコードベース全体にコピー＆ペーストする代わりに
（<a href="#writing-tests-tagging-and-filtering">タグとフィルタリング</a> 参照）、以下の <code>@Fast</code>
のような名前のカスタム <em>合成アノテーション</em> を作ることができます。
<code>@Fast</code> は、<code>@Tag("fast")</code> の代わりに使うことができます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">java.lang.annotation.ElementType</span>;
<span class="keyword">import</span> <span class="include">java.lang.annotation.Retention</span>;
<span class="keyword">import</span> <span class="include">java.lang.annotation.RetentionPolicy</span>;
<span class="keyword">import</span> <span class="include">java.lang.annotation.Target</span>;

<span class="keyword">import</span> <span class="include">org.junit.jupiter.api.Tag</span>;

<span class="annotation">@Target</span>({ <span class="predefined-type">ElementType</span>.TYPE, <span class="predefined-type">ElementType</span>.METHOD })
<span class="annotation">@Retention</span>(<span class="predefined-type">RetentionPolicy</span>.RUNTIME)
<span class="annotation">@Tag</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">fast</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="annotation">@interface</span> Fast {
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="writing-tests-classes-and-methods"><a class="anchor" href="#writing-tests-classes-and-methods"></a>3.2. テストクラスとテストメソッド</h3>
<div class="paragraph">
<p><em>テストメソッド (test method)</em> とは、<code>@Test</code>, <code>@RepeatedTest</code>, <code>@ParameterizedTest</code>,
<code>@TestFactory</code>, <code>@TestTemplate</code> のいずれかが直接またはメタアノテーションとして付与された
インスタンスメソッドです。<em>テストクラス (test class)</em> とは、テストメソッドを少なくとも1つもつ
トップレベルまたはstaticな内部クラスです。</p>
</div>
<div class="listingblock">
<div class="title">標準的なテストクラス</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">static</span> <span class="include">org.junit.jupiter.api.Assertions.fail</span>;

<span class="keyword">import</span> <span class="include">org.junit.jupiter.api.AfterAll</span>;
<span class="keyword">import</span> <span class="include">org.junit.jupiter.api.AfterEach</span>;
<span class="keyword">import</span> <span class="include">org.junit.jupiter.api.BeforeAll</span>;
<span class="keyword">import</span> <span class="include">org.junit.jupiter.api.BeforeEach</span>;
<span class="keyword">import</span> <span class="include">org.junit.jupiter.api.Disabled</span>;
<span class="keyword">import</span> <span class="include">org.junit.jupiter.api.Test</span>;

<span class="type">class</span> <span class="class">StandardTests</span> {

    <span class="annotation">@BeforeAll</span>
    <span class="directive">static</span> <span class="type">void</span> initAll() {
    }

    <span class="annotation">@BeforeEach</span>
    <span class="type">void</span> init() {
    }

    <span class="annotation">@Test</span>
    <span class="type">void</span> succeedingTest() {
    }

    <span class="annotation">@Test</span>
    <span class="type">void</span> failingTest() {
        fail(<span class="string"><span class="delimiter">&quot;</span><span class="content">失敗するテスト</span><span class="delimiter">&quot;</span></span>);
    }

    <span class="annotation">@Test</span>
    <span class="annotation">@Disabled</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">デモ用</span><span class="delimiter">&quot;</span></span>)
    <span class="type">void</span> skippedTest() {
        <span class="comment">// 実行されない</span>
    }

    <span class="annotation">@AfterEach</span>
    <span class="type">void</span> tearDown() {
    }

    <span class="annotation">@AfterAll</span>
    <span class="directive">static</span> <span class="type">void</span> tearDownAll() {
    }

}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
テストクラスやテストメソッドは、 <code>public</code> である必要がありません。
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="writing-tests-display-names"><a class="anchor" href="#writing-tests-display-names"></a>3.3. 表示名</h3>
<div class="paragraph">
<p>テストクラスやテストメソッドは、カスタムの表示名を宣言できます。
空白や特殊文字だけでなく絵文字も含めることができ、テストランナーやテストレポートに表示されます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">org.junit.jupiter.api.DisplayName</span>;
<span class="keyword">import</span> <span class="include">org.junit.jupiter.api.Test</span>;

<span class="annotation">@DisplayName</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">特殊なテストケース</span><span class="delimiter">&quot;</span></span>)
<span class="type">class</span> <span class="class">DisplayNameDemo</span> {

    <span class="annotation">@Test</span>
    <span class="annotation">@DisplayName</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">スペースを 含む カスタムの テスト名</span><span class="delimiter">&quot;</span></span>)
    <span class="type">void</span> testWithDisplayNameContainingSpaces() {
    }

    <span class="annotation">@Test</span>
    <span class="annotation">@DisplayName</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">╯°□°）╯</span><span class="delimiter">&quot;</span></span>)
    <span class="type">void</span> testWithDisplayNameContainingSpecialCharacters() {
    }

    <span class="annotation">@Test</span>
    <span class="annotation">@DisplayName</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">😱</span><span class="delimiter">&quot;</span></span>)
    <span class="type">void</span> testWithDisplayNameContainingEmoji() {
    }

}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="writing-tests-assertions"><a class="anchor" href="#writing-tests-assertions"></a>3.4. アサーション</h3>
<div class="paragraph">
<p>JUnit Jupiterは、JUnit 4にあった多くのアサーションメソッドをもち、
Java 8のラムダ式と一緒に使いやすいものもいくつか追加しています。
すべてのJUnit Jupiterアサーションは、 <code><a href="https://junit.org/junit5/docs/5.2.0/api/org/junit/jupiter/api/Assertions.html">org.junit.jupiter.api.Assertions</a></code> クラスの <code>static</code> メソッドです。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">static</span> <span class="include">java.time.Duration.ofMillis</span>;
<span class="keyword">import</span> <span class="include">static</span> <span class="include">java.time.Duration.ofMinutes</span>;
<span class="keyword">import</span> <span class="include">static</span> <span class="include">org.junit.jupiter.api.Assertions.assertAll</span>;
<span class="keyword">import</span> <span class="include">static</span> <span class="include">org.junit.jupiter.api.Assertions.assertEquals</span>;
<span class="keyword">import</span> <span class="include">static</span> <span class="include">org.junit.jupiter.api.Assertions.assertNotNull</span>;
<span class="keyword">import</span> <span class="include">static</span> <span class="include">org.junit.jupiter.api.Assertions.assertThrows</span>;
<span class="keyword">import</span> <span class="include">static</span> <span class="include">org.junit.jupiter.api.Assertions.assertTimeout</span>;
<span class="keyword">import</span> <span class="include">static</span> <span class="include">org.junit.jupiter.api.Assertions.assertTimeoutPreemptively</span>;
<span class="keyword">import</span> <span class="include">static</span> <span class="include">org.junit.jupiter.api.Assertions.assertTrue</span>;

<span class="keyword">import</span> <span class="include">org.junit.jupiter.api.Test</span>;

<span class="type">class</span> <span class="class">AssertionsDemo</span> {

    <span class="annotation">@Test</span>
    <span class="type">void</span> standardAssertions() {
        assertEquals(<span class="integer">2</span>, <span class="integer">2</span>);
        assertEquals(<span class="integer">4</span>, <span class="integer">4</span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">省略可能なアサーションメッセージは最後のパラメーター</span><span class="delimiter">&quot;</span></span>);
        assertTrue(<span class="string"><span class="delimiter">'</span><span class="content">a</span><span class="delimiter">'</span></span> &lt; <span class="string"><span class="delimiter">'</span><span class="content">b</span><span class="delimiter">'</span></span>, () -&gt; <span class="string"><span class="delimiter">&quot;</span><span class="content">アサーションメッセージは遅延評価できる -- </span><span class="delimiter">&quot;</span></span>
                + <span class="string"><span class="delimiter">&quot;</span><span class="content">不必要に複雑なメッセージを構築するコストを割けるために</span><span class="delimiter">&quot;</span></span>);
    }

    <span class="annotation">@Test</span>
    <span class="type">void</span> groupedAssertions() {
        <span class="comment">// アサーションをグループ化すると、すべてのアサーションが一度に実行され、</span>
        <span class="comment">// すべての失敗がまとめて報告される。</span>
        assertAll(<span class="string"><span class="delimiter">&quot;</span><span class="content">person</span><span class="delimiter">&quot;</span></span>,
            () -&gt; assertEquals(<span class="string"><span class="delimiter">&quot;</span><span class="content">John</span><span class="delimiter">&quot;</span></span>, person.getFirstName()),
            () -&gt; assertEquals(<span class="string"><span class="delimiter">&quot;</span><span class="content">Doe</span><span class="delimiter">&quot;</span></span>, person.getLastName())
        );
    }

    <span class="annotation">@Test</span>
    <span class="type">void</span> dependentAssertions() {
        <span class="comment">// コードブロック内でアサーションが失敗すると、同じブロック内の後続のコードはスキップされる。</span>
        assertAll(<span class="string"><span class="delimiter">&quot;</span><span class="content">properties</span><span class="delimiter">&quot;</span></span>,
            () -&gt; {
                <span class="predefined-type">String</span> firstName = person.getFirstName();
                assertNotNull(firstName);

                <span class="comment">// 上のアサーションが成功した場合のみ実行される。</span>
                assertAll(<span class="string"><span class="delimiter">&quot;</span><span class="content">first name</span><span class="delimiter">&quot;</span></span>,
                    () -&gt; assertTrue(firstName.startsWith(<span class="string"><span class="delimiter">&quot;</span><span class="content">J</span><span class="delimiter">&quot;</span></span>)),
                    () -&gt; assertTrue(firstName.endsWith(<span class="string"><span class="delimiter">&quot;</span><span class="content">n</span><span class="delimiter">&quot;</span></span>))
                );
            },
            () -&gt; {
                <span class="comment">// グループ化されたアサーションは、first name のアサーションとは独立して実行される。</span>
                <span class="predefined-type">String</span> lastName = person.getLastName();
                assertNotNull(lastName);

                <span class="comment">// 上のアサーションが成功した場合のみ実行される。</span>
                assertAll(<span class="string"><span class="delimiter">&quot;</span><span class="content">last name</span><span class="delimiter">&quot;</span></span>,
                    () -&gt; assertTrue(lastName.startsWith(<span class="string"><span class="delimiter">&quot;</span><span class="content">D</span><span class="delimiter">&quot;</span></span>)),
                    () -&gt; assertTrue(lastName.endsWith(<span class="string"><span class="delimiter">&quot;</span><span class="content">e</span><span class="delimiter">&quot;</span></span>))
                );
            }
        );
    }

    <span class="annotation">@Test</span>
    <span class="type">void</span> exceptionTesting() {
        <span class="predefined-type">Throwable</span> exception = assertThrows(<span class="exception">IllegalArgumentException</span>.class, () -&gt; {
            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="exception">IllegalArgumentException</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">a message</span><span class="delimiter">&quot;</span></span>);
        });
        assertEquals(<span class="string"><span class="delimiter">&quot;</span><span class="content">a message</span><span class="delimiter">&quot;</span></span>, exception.getMessage());
    }

    <span class="annotation">@Test</span>
    <span class="type">void</span> timeoutNotExceeded() {
        <span class="comment">// 次のアサーションは成功する。</span>
        assertTimeout(ofMinutes(<span class="integer">2</span>), () -&gt; {
            <span class="comment">// 2分未満で終わるタスクを実行する。</span>
        });
    }

    <span class="annotation">@Test</span>
    <span class="type">void</span> timeoutNotExceededWithResult() {
        <span class="comment">// 次のアサーションは成功し、指定されたオブジェクトを返す。</span>
        <span class="predefined-type">String</span> actualResult = assertTimeout(ofMinutes(<span class="integer">2</span>), () -&gt; {
            <span class="keyword">return</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">a result</span><span class="delimiter">&quot;</span></span>;
        });
        assertEquals(<span class="string"><span class="delimiter">&quot;</span><span class="content">a result</span><span class="delimiter">&quot;</span></span>, actualResult);
    }

    <span class="annotation">@Test</span>
    <span class="type">void</span> timeoutNotExceededWithMethod() {
        <span class="comment">// 次のアサーションは、メソッド参照を実行してオブジェクトを返す。</span>
        <span class="predefined-type">String</span> actualGreeting = assertTimeout(ofMinutes(<span class="integer">2</span>), AssertionsDemo::greeting);
        assertEquals(<span class="string"><span class="delimiter">&quot;</span><span class="content">Hello, World!</span><span class="delimiter">&quot;</span></span>, actualGreeting);
    }

    <span class="annotation">@Test</span>
    <span class="type">void</span> timeoutExceeded() {
        <span class="comment">// 次のアサーションは、以下のようなエラーメッセージを出して失敗する:</span>
        <span class="comment">// execution exceeded timeout of 10 ms by 91 ms</span>
        assertTimeout(ofMillis(<span class="integer">10</span>), () -&gt; {
            <span class="comment">// 10ミリ秒より時間のかかるタスクをシミュレートする。</span>
            <span class="predefined-type">Thread</span>.sleep(<span class="integer">100</span>);
        });
    }

    <span class="annotation">@Test</span>
    <span class="type">void</span> timeoutExceededWithPreemptiveTermination() {
        <span class="comment">// 次のアサーションは、以下のようなエラーメッセージを出して失敗する:</span>
        <span class="comment">// execution timed out after 10 ms</span>
        assertTimeoutPreemptively(ofMillis(<span class="integer">10</span>), () -&gt; {
            <span class="comment">// 10ミリ秒より時間のかかるタスクをシミュレートする。</span>
            <span class="predefined-type">Thread</span>.sleep(<span class="integer">100</span>);
        });
    }

    <span class="directive">private</span> <span class="directive">static</span> <span class="predefined-type">String</span> greeting() {
        <span class="keyword">return</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">Hello, World!</span><span class="delimiter">&quot;</span></span>;
    }

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>JUnit Jupiterは、 <a href="https://kotlinlang.org/">Kotlin</a>
と一緒に使いやすいアサーションもいくつか含んでいます。すべてのJUnit Jupiter Kotlinアサーションは、
<code>org.junit.jupiter.api</code> パッケージのトップレベル関数です。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">import</span> <span class="include">org.junit.jupiter.api.Test</span>
<span class="keyword">import</span> <span class="include">org.junit.jupiter.api.assertAll</span>
<span class="keyword">import</span> <span class="include">org.junit.jupiter.api.Assertions.assertEquals</span>
<span class="keyword">import</span> <span class="include">org.junit.jupiter.api.Assertions.assertTrue</span>
<span class="keyword">import</span> <span class="include">org.junit.jupiter.api.assertThrows</span>

<span class="type">class</span> <span class="class">AssertionsKotlinDemo</span> {

    <span class="annotation">@Test</span>
    fun <span class="error">`</span>grouped assertions<span class="error">`</span>() {
        assertAll(<span class="string"><span class="delimiter">&quot;</span><span class="content">person</span><span class="delimiter">&quot;</span></span>,
            { assertEquals(<span class="string"><span class="delimiter">&quot;</span><span class="content">John</span><span class="delimiter">&quot;</span></span>, person.firstName) },
            { assertEquals(<span class="string"><span class="delimiter">&quot;</span><span class="content">Doe</span><span class="delimiter">&quot;</span></span>, person.lastName) }
        )
    }

    <span class="annotation">@Test</span>
    fun <span class="error">`</span>exception testing<span class="error">`</span>() {
        val exception = assertThrows&lt;<span class="exception">IllegalArgumentException</span>&gt; (<span class="string"><span class="delimiter">&quot;</span><span class="content">Should throw an exception</span><span class="delimiter">&quot;</span></span>) {
            <span class="keyword">throw</span> <span class="exception">IllegalArgumentException</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">a message</span><span class="delimiter">&quot;</span></span>)
        }
        assertEquals(<span class="string"><span class="delimiter">&quot;</span><span class="content">a message</span><span class="delimiter">&quot;</span></span>, exception.message)
    }

    <span class="annotation">@Test</span>
    fun <span class="error">`</span>assertions from a stream<span class="error">`</span>() {
        assertAll(
            <span class="string"><span class="delimiter">&quot;</span><span class="content">people with name starting with J</span><span class="delimiter">&quot;</span></span>,
            people
                .stream()
                .map {
                    <span class="comment">// This mapping returns Stream&lt;() -&gt; Unit&gt;</span>
                    { assertTrue(<span class="local-variable">it</span>.firstName.startsWith(<span class="string"><span class="delimiter">&quot;</span><span class="content">J</span><span class="delimiter">&quot;</span></span>)) }
                }
        )
    }

    <span class="annotation">@Test</span>
    fun <span class="error">`</span>assertions from a collection<span class="error">`</span>() {
        assertAll(
            <span class="string"><span class="delimiter">&quot;</span><span class="content">people with last name of Doe</span><span class="delimiter">&quot;</span></span>,
            people.map { { assertEquals(<span class="string"><span class="delimiter">&quot;</span><span class="content">Doe</span><span class="delimiter">&quot;</span></span>, <span class="local-variable">it</span>.lastName) } }
        )
    }

}</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="writing-tests-assertions-third-party"><a class="anchor" href="#writing-tests-assertions-third-party"></a>3.4.1. サードパーティーのアサーションライブラリ</h4>
<div class="paragraph">
<p>多くのテストシナリオではJUnit Jupiterが提供するアサーション機能だけで十分ですが、
時にはさらなるパワーや <em>マッチャー</em> のような追加機能が必要になることもあります。
そのような場合には、 <a href="http://joel-costigliola.github.io/assertj/">AssertJ</a> や <a href="http://hamcrest.org/JavaHamcrest/">Hamcrest</a>、 <a href="http://google.github.io/truth/">Truth</a> のようなサードパーティーの
アサーションライブラリを使うことをJUnitチームはお勧めします。
開発者は、好みに応じてアサーションライブラリを自由に選択することができます。</p>
</div>
<div class="paragraph">
<p>例えば、 <em>マッチャー</em> と流れるようなAPIを組み合わせれば、アサーションをもっと説明的で
読みやすくすることができます。しかし、JUnit Jupiterの <code><a href="https://junit.org/junit5/docs/5.2.0/api/org/junit/jupiter/api/Assertions.html">org.junit.jupiter.api.Assertions</a></code> クラスは、
JUnit 4の <code>org.junit.Assert</code> クラスのようにHamcrestの
<a href="http://junit.org/junit4/javadoc/latest/org/hamcrest/Matcher.html"><code>Matcher</code></a>
を受け付ける
<a href="http://junit.org/junit4/javadoc/latest/org/junit/Assert.html#assertThat"><code>assertThat()</code></a>
メソッドを提供していません。代わりに、開発者はサードパーティーのアサーションライブラリが
提供するマッチャーを利用することが推奨されます。</p>
</div>
<div class="paragraph">
<p>次の例は、JUnit JupiterテストでHamcrestの <code>assertThat()</code> を使う方法を示しています。
Hamcrestライブラリをクラスパスに追加しさえすれば、 <code>assertThat()</code> や <code>is()</code>、 <code>equalTo()</code>
のようなメソッドをstatic importして、下の <code>assertWithHamcrestMatcher()</code> メソッドのように
テストの中で使うことができます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">static</span> <span class="include">org.hamcrest.CoreMatchers.equalTo</span>;
<span class="keyword">import</span> <span class="include">static</span> <span class="include">org.hamcrest.CoreMatchers.is</span>;
<span class="keyword">import</span> <span class="include">static</span> <span class="include">org.hamcrest.MatcherAssert.assertThat</span>;

<span class="keyword">import</span> <span class="include">org.junit.jupiter.api.Test</span>;

<span class="type">class</span> <span class="class">HamcrestAssertionDemo</span> {

    <span class="annotation">@Test</span>
    <span class="type">void</span> assertWithHamcrestMatcher() {
        assertThat(<span class="integer">2</span> + <span class="integer">1</span>, is(equalTo(<span class="integer">3</span>)));
    }

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>当然ながら、JUnit 4のプログラミングモデルに基づくレガシーなテストでは、引き続き
<code>org.junit.Assert#assertThat</code> を使い続けることができます。</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="writing-tests-assumptions"><a class="anchor" href="#writing-tests-assumptions"></a>3.5. 前提条件</h3>
<div class="paragraph">
<p>JUnit Jupiterは、JUnit 4が提供する前提条件用メソッドの一部を備え、
Java 8のラムダ式と一緒に使いやすいものをいくつか追加しています。
JUnit Jupiterの前提条件メソッドは、すべて <code><a href="https://junit.org/junit5/docs/5.2.0/api/org/junit/jupiter/api/Assumptions.html">org.junit.jupiter.api.Assumptions</a></code> クラスのstaticメソッドです。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">static</span> <span class="include">org.junit.jupiter.api.Assertions.assertEquals</span>;
<span class="keyword">import</span> <span class="include">static</span> <span class="include">org.junit.jupiter.api.Assumptions.assumeTrue</span>;
<span class="keyword">import</span> <span class="include">static</span> <span class="include">org.junit.jupiter.api.Assumptions.assumingThat</span>;

<span class="keyword">import</span> <span class="include">org.junit.jupiter.api.Test</span>;

<span class="type">class</span> <span class="class">AssumptionsDemo</span> {

    <span class="annotation">@Test</span>
    <span class="type">void</span> testOnlyOnCiServer() {
        assumeTrue(<span class="string"><span class="delimiter">&quot;</span><span class="content">CI</span><span class="delimiter">&quot;</span></span>.equals(<span class="predefined-type">System</span>.getenv(<span class="string"><span class="delimiter">&quot;</span><span class="content">ENV</span><span class="delimiter">&quot;</span></span>)));
        <span class="comment">// 残りのテスト</span>
    }

    <span class="annotation">@Test</span>
    <span class="type">void</span> testOnlyOnDeveloperWorkstation() {
        assumeTrue(<span class="string"><span class="delimiter">&quot;</span><span class="content">DEV</span><span class="delimiter">&quot;</span></span>.equals(<span class="predefined-type">System</span>.getenv(<span class="string"><span class="delimiter">&quot;</span><span class="content">ENV</span><span class="delimiter">&quot;</span></span>)),
            () -&gt; <span class="string"><span class="delimiter">&quot;</span><span class="content">テストを中断: 開発者マシンではない</span><span class="delimiter">&quot;</span></span>);
        <span class="comment">// 残りのテスト</span>
    }

    <span class="annotation">@Test</span>
    <span class="type">void</span> testInAllEnvironments() {
        assumingThat(<span class="string"><span class="delimiter">&quot;</span><span class="content">CI</span><span class="delimiter">&quot;</span></span>.equals(<span class="predefined-type">System</span>.getenv(<span class="string"><span class="delimiter">&quot;</span><span class="content">ENV</span><span class="delimiter">&quot;</span></span>)),
            () -&gt; {
                <span class="comment">// これらのアサーションはCIサーバーでのみ実行する</span>
                assertEquals(<span class="integer">2</span>, <span class="integer">2</span>);
            });

        <span class="comment">// これらのアサーションはすべての環境で実行する</span>
        assertEquals(<span class="string"><span class="delimiter">&quot;</span><span class="content">a string</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">a string</span><span class="delimiter">&quot;</span></span>);
    }

}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="writing-tests-disabling"><a class="anchor" href="#writing-tests-disabling"></a>3.6. テストの無効化</h3>
<div class="paragraph">
<p>テストクラス全体または個々のテストメソッドは、 <code><a href="https://junit.org/junit5/docs/5.2.0/api/org/junit/jupiter/api/Disabled.html">@Disabled</a></code> アノテーションや
<a href="#writing-tests-conditional-execution">条件付きテスト実行</a> で説明するアノテーション、
あるいはカスタムの <a href="#extensions-conditions"><code>ExecutionCondition</code></a>
によって <em>無効化</em> することができます。</p>
</div>
<div class="paragraph">
<p>次の例は、<code>@Disabled</code> されたテストクラスです。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">org.junit.jupiter.api.Disabled</span>;
<span class="keyword">import</span> <span class="include">org.junit.jupiter.api.Test</span>;

<span class="annotation">@Disabled</span>
<span class="type">class</span> <span class="class">DisabledClassDemo</span> {
    <span class="annotation">@Test</span>
    <span class="type">void</span> testWillBeSkipped() {
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>そして次の例は、<code>@Disabled</code> されたテストメソッドをもつテストクラスです。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">org.junit.jupiter.api.Disabled</span>;
<span class="keyword">import</span> <span class="include">org.junit.jupiter.api.Test</span>;

<span class="type">class</span> <span class="class">DisabledTestsDemo</span> {

    <span class="annotation">@Disabled</span>
    <span class="annotation">@Test</span>
    <span class="type">void</span> testWillBeSkipped() {
    }

    <span class="annotation">@Test</span>
    <span class="type">void</span> testWillBeExecuted() {
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="writing-tests-conditional-execution"><a class="anchor" href="#writing-tests-conditional-execution"></a>3.7. 条件付きテスト実行</h3>
<div class="paragraph">
<p>JUnit Jupiterの <a href="#extensions-conditions"><code>ExecutionCondition</code></a> 拡張APIは、
開発者がある一定の条件にもとづいて <em>手続き的に</em>  コンテナやテストを有効化したり、
無効化したりすることができるようにします。
簡単な例は、<code><a href="https://junit.org/junit5/docs/5.2.0/api/org/junit/jupiter/api/Disabled.html">@Disabled</a></code> アノテーションをサポートする <code><a href="https://github.com/junit-team/junit5/tree/master/junit-jupiter-engine/src/main/java/org/junit/jupiter/engine/extension/DisabledCondition.java">DisabledCondition</a></code> です
（<a href="#writing-tests-disabling">テストの無効化</a> 参照）。</p>
</div>
<div class="paragraph">
<p>JUnit Jupiterは、<code>org.junit.jupiter.api.condition</code> パッケージで <code>@Disabled</code>
以外にもアノテーションベースの条件をサポートしています。これにより、開発者は <em>宣言的に</em>
コンテナやテストを有効化したり、無効化したりすることができます。
詳細は、以降の節を参照してください。</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="title">合成アノテーション</div>
<div class="paragraph">
<p>以降で説明するいずれの <em>条件</em> アノテーションも、カスタムの <em>合成アノテーション</em>
を作るためのメタアノテーションとして使われうる点に注意してください。例えば、
<a href="#writing-tests-conditional-execution-os-demo">@EnabledOnOsデモ</a> の <code>@TestOnMac</code>
アノテーションは、<code>@Test</code> と <code>@EnabledOnOs</code> を1つの再利用可能なアノテーションとして
組み合わせる方法を示しています。</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>以降の節で取り上げられる <em>条件</em> アノテーションは、あるテストインターフェースやテストクラス、
テストメソッドに対して一度しか宣言できません。条件アノテーションがある要素に対して直接、
間接、あるいはメタアノテーションで複数回指定されたとしても、JUnitが最初に見つけた
アノテーションだけが使われます。その他のアノテーションは、黙って無視されます。ただし、
<code>org.junit.jupiter.api.condition</code> パッケージのそれぞれの条件アノテーションは、
組み合わせて使うことができる点に注意してください。</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="writing-tests-conditional-execution-os"><a class="anchor" href="#writing-tests-conditional-execution-os"></a>3.7.1. オペレーティングシステム条件</h4>
<div class="paragraph">
<p><code><a href="https://junit.org/junit5/docs/5.2.0/api/org/junit/jupiter/api/condition/EnabledOnOs.html">@EnabledOnOs</a></code> および <code><a href="https://junit.org/junit5/docs/5.2.0/api/org/junit/jupiter/api/condition/DisabledOnOs.html">@DisabledOnOs</a></code> アノテーションを使うと、
コンテナやテストを特定のオペレーティングシステムで有効にしたり無効にしたりできます。</p>
</div>
<div id="writing-tests-conditional-execution-os-demo" class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Test</span>
<span class="annotation">@EnabledOnOs</span>(MAC)
<span class="type">void</span> onlyOnMacOs() {
    <span class="comment">// ...</span>
}

<span class="annotation">@TestOnMac</span>
<span class="type">void</span> testOnMac() {
    <span class="comment">// ...</span>
}

<span class="annotation">@Test</span>
<span class="annotation">@EnabledOnOs</span>({ LINUX, MAC })
<span class="type">void</span> onLinuxOrMac() {
    <span class="comment">// ...</span>
}

<span class="annotation">@Test</span>
<span class="annotation">@DisabledOnOs</span>(WINDOWS)
<span class="type">void</span> notOnWindows() {
    <span class="comment">// ...</span>
}

<span class="annotation">@Target</span>(<span class="predefined-type">ElementType</span>.METHOD)
<span class="annotation">@Retention</span>(<span class="predefined-type">RetentionPolicy</span>.RUNTIME)
<span class="annotation">@Test</span>
<span class="annotation">@EnabledOnOs</span>(MAC)
<span class="annotation">@interface</span> TestOnMac {
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="writing-tests-conditional-execution-jre"><a class="anchor" href="#writing-tests-conditional-execution-jre"></a>3.7.2. Javaランタイム環境条件</h4>
<div class="paragraph">
<p><code><a href="https://junit.org/junit5/docs/5.2.0/api/org/junit/jupiter/api/condition/EnabledOnJre.html">@EnabledOnJre</a></code> および <code><a href="https://junit.org/junit5/docs/5.2.0/api/org/junit/jupiter/api/condition/DisabledOnJre.html">@DisabledOnJre</a></code> アノテーションを使うと、
コンテナやテストを特定のバージョンのJavaランタイム環境（JRE）で有効にしたり無効にしたりできます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Test</span>
<span class="annotation">@EnabledOnJre</span>(JAVA_8)
<span class="type">void</span> onlyOnJava8() {
    <span class="comment">// ...</span>
}

<span class="annotation">@Test</span>
<span class="annotation">@EnabledOnJre</span>({ JAVA_9, JAVA_10 })
<span class="type">void</span> onJava9Or10() {
    <span class="comment">// ...</span>
}

<span class="annotation">@Test</span>
<span class="annotation">@DisabledOnJre</span>(JAVA_9)
<span class="type">void</span> notOnJava9() {
    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="writing-tests-conditional-execution-system-properties"><a class="anchor" href="#writing-tests-conditional-execution-system-properties"></a>3.7.3. システムプロパティ条件</h4>
<div class="paragraph">
<p><code><a href="https://junit.org/junit5/docs/5.2.0/api/org/junit/jupiter/api/condition/EnabledIfSystemProperty.html">@EnabledIfSystemProperty</a></code> および <code><a href="https://junit.org/junit5/docs/5.2.0/api/org/junit/jupiter/api/condition/DisabledIfSystemProperty.html">@DisabledIfSystemProperty</a></code> アノテーションを使うと、
指定した名前をもつJVMシステムプロパティの値に応じて、コンテナやテストを有効にしたり
無効にしたりできます。 <code>matches</code> 属性で指定する値は、正規表現として解釈されます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Test</span>
<span class="annotation">@EnabledIfSystemProperty</span>(named = <span class="string"><span class="delimiter">&quot;</span><span class="content">os.arch</span><span class="delimiter">&quot;</span></span>, matches = <span class="string"><span class="delimiter">&quot;</span><span class="content">.*64.*</span><span class="delimiter">&quot;</span></span>)
<span class="type">void</span> onlyOn64BitArchitectures() {
    <span class="comment">// ...</span>
}

<span class="annotation">@Test</span>
<span class="annotation">@DisabledIfSystemProperty</span>(named = <span class="string"><span class="delimiter">&quot;</span><span class="content">ci-server</span><span class="delimiter">&quot;</span></span>, matches = <span class="string"><span class="delimiter">&quot;</span><span class="content">true</span><span class="delimiter">&quot;</span></span>)
<span class="type">void</span> notOnCiServer() {
    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="writing-tests-conditional-execution-environment-variables"><a class="anchor" href="#writing-tests-conditional-execution-environment-variables"></a>3.7.4. 環境変数条件</h4>
<div class="paragraph">
<p><code><a href="https://junit.org/junit5/docs/5.2.0/api/org/junit/jupiter/api/condition/EnabledIfEnvironmentVariable.html">@EnabledIfEnvironmentVariable</a></code> および <code><a href="https://junit.org/junit5/docs/5.2.0/api/org/junit/jupiter/api/condition/DisabledIfEnvironmentVariable.html">@DisabledIfEnvironmentVariable</a></code>
アノテーションを使うと、指定した名前をもつ環境変数の値に応じて、コンテナやテストを
有効にしたり無効にしたりできます。<code>matches</code> 属性で指定する値は、正規表現として解釈されます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Test</span>
<span class="annotation">@EnabledIfEnvironmentVariable</span>(named = <span class="string"><span class="delimiter">&quot;</span><span class="content">ENV</span><span class="delimiter">&quot;</span></span>, matches = <span class="string"><span class="delimiter">&quot;</span><span class="content">staging-server</span><span class="delimiter">&quot;</span></span>)
<span class="type">void</span> onlyOnStagingServer() {
    <span class="comment">// ...</span>
}

<span class="annotation">@Test</span>
<span class="annotation">@DisabledIfEnvironmentVariable</span>(named = <span class="string"><span class="delimiter">&quot;</span><span class="content">ENV</span><span class="delimiter">&quot;</span></span>, matches = <span class="string"><span class="delimiter">&quot;</span><span class="content">.*development.*</span><span class="delimiter">&quot;</span></span>)
<span class="type">void</span> notOnDeveloperWorkstation() {
    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="writing-tests-conditional-execution-scripts"><a class="anchor" href="#writing-tests-conditional-execution-scripts"></a>3.7.5. スクリプトベースの条件</h4>
<div class="paragraph">
<p>JUnit Jupiterは、<code><a href="https://junit.org/junit5/docs/5.2.0/api/org/junit/jupiter/api/condition/EnabledIf.html">@EnabledIf</a></code> または <code><a href="https://junit.org/junit5/docs/5.2.0/api/org/junit/jupiter/api/condition/DisabledIf.html">@DisabledIf</a></code> アノテーションで設定された
スクリプトの実行結果に応じて、コンテナやテストを有効にしたり無効にしたりする機能を提供します。
スクリプトは、JavaScript、Groovy、あるいはJSR 223で定義されたJava Scripting API
をサポートする任意の言語で記述することができます。</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<code><a href="https://junit.org/junit5/docs/5.2.0/api/org/junit/jupiter/api/condition/EnabledIf.html">@EnabledIf</a></code> および <code><a href="https://junit.org/junit5/docs/5.2.0/api/org/junit/jupiter/api/condition/DisabledIf.html">@DisabledIf</a></code> を使った条件付きテスト実行は、
現在 <em>試験的な</em> 機能です。詳細は、<a href="#api-evolution-experimental-apis">実験的なAPI</a>
のテーブルを参考にしてください。
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
もしスクリプトのロジックが現在のオペレーティングシステムやJavaランタイム環境の
バージョン、特定のJVMシステムプロパティや環境変数だけに依存するなら、その目的専用の
組み込みアノテーションの使用を検討すべきです。詳細は、この章の前の節を参照してください。
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
もし同じようなスクリプトベースの条件を何回も使っていると感じたら、
高速かつタイプセーフで、よりメンテナンスしやすい方法で実装するために、専用の
<a href="#extensions-conditions">ExecutionCondition</a> 拡張を書くことを検討してください。
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Test</span> <span class="comment">// 静的なJavaScriptの式</span>
<span class="annotation">@EnabledIf</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">2 * 3 == 6</span><span class="delimiter">&quot;</span></span>)
<span class="type">void</span> willBeExecuted() {
    <span class="comment">// ...</span>
}

<span class="annotation">@RepeatedTest</span>(<span class="integer">10</span>) <span class="comment">// 動的なJavaScriptの式</span>
<span class="annotation">@DisabledIf</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">Math.random() &lt; 0.214159</span><span class="delimiter">&quot;</span></span>)
<span class="type">void</span> mightNotBeExecuted() {
    <span class="comment">// ...</span>
}

<span class="annotation">@Test</span> <span class="comment">// システムプロパティをテストする正規表現</span>
<span class="annotation">@DisabledIf</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/32/.test(systemProperty.get('os.arch'))</span><span class="delimiter">&quot;</span></span>)
<span class="type">void</span> disabledOn32BitArchitectures() {
    assertFalse(<span class="predefined-type">System</span>.getProperty(<span class="string"><span class="delimiter">&quot;</span><span class="content">os.arch</span><span class="delimiter">&quot;</span></span>).contains(<span class="string"><span class="delimiter">&quot;</span><span class="content">32</span><span class="delimiter">&quot;</span></span>));
}

<span class="annotation">@Test</span>
<span class="annotation">@EnabledIf</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">'CI' == systemEnvironment.get('ENV')</span><span class="delimiter">&quot;</span></span>)
<span class="type">void</span> onlyOnCiServer() {
    assertTrue(<span class="string"><span class="delimiter">&quot;</span><span class="content">CI</span><span class="delimiter">&quot;</span></span>.equals(<span class="predefined-type">System</span>.getenv(<span class="string"><span class="delimiter">&quot;</span><span class="content">ENV</span><span class="delimiter">&quot;</span></span>)));
}

<span class="annotation">@Test</span> <span class="comment">// 複数行のスクリプト、カスタムのエンジン名、カスタムの理由（訳注：テストが無効化された場合に表示される）</span>
<span class="annotation">@EnabledIf</span>(value = {
                <span class="string"><span class="delimiter">&quot;</span><span class="content">load('nashorn:mozilla_compat.js')</span><span class="delimiter">&quot;</span></span>,
                <span class="string"><span class="delimiter">&quot;</span><span class="content">importPackage(java.time)</span><span class="delimiter">&quot;</span></span>,
                <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>,
                <span class="string"><span class="delimiter">&quot;</span><span class="content">var today = LocalDate.now()</span><span class="delimiter">&quot;</span></span>,
                <span class="string"><span class="delimiter">&quot;</span><span class="content">var tomorrow = today.plusDays(1)</span><span class="delimiter">&quot;</span></span>,
                <span class="string"><span class="delimiter">&quot;</span><span class="content">tomorrow.isAfter(today)</span><span class="delimiter">&quot;</span></span>
            },
            engine = <span class="string"><span class="delimiter">&quot;</span><span class="content">nashorn</span><span class="delimiter">&quot;</span></span>,
            reason = <span class="string"><span class="delimiter">&quot;</span><span class="content">Self-fulfilling: {result}</span><span class="delimiter">&quot;</span></span>)
<span class="type">void</span> theDayAfterTomorrow() {
    LocalDate today = LocalDate.now();
    LocalDate tomorrow = today.plusDays(<span class="integer">1</span>);
    assertTrue(tomorrow.isAfter(today));
}</code></pre>
</div>
</div>
<div class="sect4">
<h5 id="writing-tests-conditional-execution-scripts-bindings"><a class="anchor" href="#writing-tests-conditional-execution-scripts-bindings"></a>スクリプトバインディング</h5>
<div class="paragraph">
<p>以下の名前は、スクリプトのコンテキストに束縛されるため、スクリプト内で使うことができます。
<em>accessor</em> は、単純な <code>String get(String name)</code> メソッドを介したマップ構造への
アクセスを提供します。</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 60%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>systemEnvironment</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>accessor</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">オペレーティングシステムの環境変数へのアクセッサ</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>systemProperty</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>accessor</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">JVMのシステムプロパティへのアクセッサ</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>junitConfigurationParameter</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>accessor</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">設定パラメーターへのアクセッサ</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>junitDisplayName</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">テストやコンテナの表示名</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>junitTags</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Set&lt;String&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">テストやコンテナにアサインされたすべてのタグ</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>junitUniqueId</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">テストやコンテナの一意なID</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="writing-tests-tagging-and-filtering"><a class="anchor" href="#writing-tests-tagging-and-filtering"></a>3.8. タグとフィルタリング</h3>
<div class="paragraph">
<p>テストクラスとテストメソッドには、<code>@Tag</code> アノテーションでタグを付与することができます。
これらのタグはあとで <a href="#running-tests">テストを発見・実行</a> するときのフィルタリングに
使うことができます。</p>
</div>
<div class="sect3">
<h4 id="タグの構文規則"><a class="anchor" href="#タグの構文規則"></a>3.8.1. タグの構文規則</h4>
<div class="ulist">
<ul>
<li>
<p>タグは、<code>null</code> または <em>空</em> であってはならない</p>
</li>
<li>
<p><em>トリミングした</em> タグは、空白文字を含んではならない</p>
</li>
<li>
<p><em>トリミングした</em> タグは、ISO制御文字を含んではならない</p>
</li>
<li>
<p><em>トリミングした</em> タグは、次の <em>予約済み文字</em> を含んではならない</p>
<div class="ulist">
<ul>
<li>
<p><code>,</code>: <em>カンマ</em></p>
</li>
<li>
<p><code>(</code>: <em>左括弧</em></p>
</li>
<li>
<p><code>)</code>: <em>右括弧</em></p>
</li>
<li>
<p><code>&amp;</code>: <em>アンパサンド</em></p>
</li>
<li>
<p><code>|</code>: <em>縦棒</em></p>
</li>
<li>
<p><code>!</code>: <em>感嘆符</em></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
上のコンテキストで "トリミングした" とは、先頭および末尾の空白文字が
取り除かれていることを意味する。
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">org.junit.jupiter.api.Tag</span>;
<span class="keyword">import</span> <span class="include">org.junit.jupiter.api.Test</span>;

<span class="annotation">@Tag</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">fast</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@Tag</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">model</span><span class="delimiter">&quot;</span></span>)
<span class="type">class</span> <span class="class">TaggingDemo</span> {

    <span class="annotation">@Test</span>
    <span class="annotation">@Tag</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">taxes</span><span class="delimiter">&quot;</span></span>)
    <span class="type">void</span> testingTaxCalculation() {
    }

}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="writing-tests-test-instance-lifecycle"><a class="anchor" href="#writing-tests-test-instance-lifecycle"></a>3.9. テストインスタンスのライフサイクル</h3>
<div class="paragraph">
<p>個々のテストメソッドを隔離された環境で実行し、
テストインスタンスをミュータブルにすると起こりうる意図しない副作用を避けるため、
JUnitは <em>テストメソッド</em> （<a href="#writing-tests-classes-and-methods">テストクラスとテストメソッド</a> 参照）
毎にそのテストクラスの新しいインスタンスを生成して実行します。
この "per-method（メソッド毎）" のテストインスタンスライフサイクルは、JUnit Jupiter
のデフォルトの挙動で、過去のJUnitのバージョンと同じです。</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
"per-method" のテストインスタンスライフサイクルモードが有効であったとしても、
<a href="#writing-tests-conditional-execution">条件</a> (例えば、<code>@Disabled</code> や
<code>@DisabledOnOs</code> など)によって <em>テストメソッド</em> が <em>無効化</em> されている場合は、
テストクラスのインスタンスが作り直されない点に注意してください。
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>もしすべてのテストメソッドを同じテストインスタンスで実行させたい場合は、テストクラスに
<code>@TestInstance(Lifecycle.PER_CLASS)</code> アノテーションを付与してください。
このモードを使うと、新しいテストインスタンスはテストクラス毎に1回だけ生成されます。
そのため、もしテストメソッドがインスタンス変数の状態に依存するのであれば、
<code>@BeforeEach</code> や <code>@AfterEach</code> メソッドで状態をリセットする必要があります。</p>
</div>
<div class="paragraph">
<p>"per-class（クラス毎）" モードは、デフォルトの "per-method（メソッド毎）" モードに比べて
追加のメリットがあります。具体的には、"per-class" モードでは <code>@BeforeAll</code> および
<code>@AfterAll</code> をインターフェースの <code>default</code> メソッドやクラスの非staticなメソッドに
対して宣言できるようになります。そのため、"per-class" モードでは <code>@BeforeAll</code> や
<code>@AfterAll</code> メソッドを <code>@Nested</code> テストクラスでも使えます。</p>
</div>
<div class="paragraph">
<p>もしプログラミング言語Kotlinでテストを書く場合は、テストインスタンスのライフサイクルを
"per-class" モードに切り替えると、<code>@BeforeAll</code> および <code>@AfterAll</code> メソッドを
より実装しやすいでしょう。</p>
</div>
<div class="sect3">
<h4 id="writing-tests-test-instance-lifecycle-changing-default"><a class="anchor" href="#writing-tests-test-instance-lifecycle-changing-default"></a>3.9.1. テストインスタンスのデフォルトのライフサイクルの変更</h4>
<div class="paragraph">
<p>テストクラスやテストインターフェースに <code>@TestInstance</code> アノテーションを付与すると、
JUnit Jupiterは <em>デフォルト</em> のライフサイクルモードを使います。標準の <em>デフォルト</em>
モードは <code>PER_METHOD</code> ですが、テストプラン全体で <em>デフォルト</em> を変更することもできます。
テストインスタンスのデフォルトのライフサイクルモードを変更するには、単に
<code>junit.jupiter.testinstance.lifecycle.default</code> <em>設定パラメーター</em> に
<code>TestInstance.Lifecycle</code> で定義された列挙定数を指定するだけです。
これは、JVMシステムプロパティや <code>Launcher</code> に渡される <code>LauncherDiscoveryRequest</code>
の <em>設定パラメーター</em> 、あるいはJUnit Platform設定ファイルなどで指定できます
（詳細は、<a href="#running-tests-config-params">設定パラメーター</a> 参照）。</p>
</div>
<div class="paragraph">
<p>例えば、デフォルトのライフサイクルモードを <code>Lifecycle.PER_CLASS</code> に設定するには、
次のシステムプロパティを指定してJVMを起動します。</p>
</div>
<div class="paragraph">
<p><code>-Djunit.jupiter.testinstance.lifecycle.default=per_class</code></p>
</div>
<div class="paragraph">
<p>ただし、デフォルトのライフサイクルモードをJUnit Platform設定ファイルで指定する方が、
よりロバストである点に注意してください。というのも、設定ファイルならプロジェクトの
バージョン管理システムにチェックインでき、IDEやビルドツールからも使えるからです。</p>
</div>
<div class="paragraph">
<p>JUnit Platform設定ファイルを使ってデフォルトのライフサイクルモードを <code>Lifecycle.PER_CLASS</code>
にするには、クラスパスのルート（例えば、<code>src/test/resources</code>）に <code>junit-platform.properties</code>
という名前で次のファイルを作ります。</p>
</div>
<div class="paragraph">
<p><code>junit.jupiter.testinstance.lifecycle.default = per_class</code></p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
テストインスタンスの <em>デフォルト</em> のライフサイクルモードを変更する場合は、
一貫性のある方法で適用しないと予測できない結果や不安定なビルドにつながる可能性があります。
例えば、ビルドでは "per-class" をデフォルトとして設定していても、IDEが "per-method"
でテストを実行していると、ビルドサーバーで起きたエラーをデバッグするのが難しくなります。
そのため、JVMシステムプロパティの代わりにJUnit Platform設定ファイルを使って
デフォルトを変更することをお勧めします。
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="writing-tests-nested"><a class="anchor" href="#writing-tests-nested"></a>3.10. ネストしたテスト</h3>
<div class="paragraph">
<p>ネストしたテストは、テスト作成者がテストのグループ関係を表現しやすくします。
詳しい例は次の通りです。</p>
</div>
<div class="listingblock">
<div class="title">スタックをテストするためのネストしたテストスイート</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">static</span> <span class="include">org.junit.jupiter.api.Assertions.assertEquals</span>;
<span class="keyword">import</span> <span class="include">static</span> <span class="include">org.junit.jupiter.api.Assertions.assertFalse</span>;
<span class="keyword">import</span> <span class="include">static</span> <span class="include">org.junit.jupiter.api.Assertions.assertThrows</span>;
<span class="keyword">import</span> <span class="include">static</span> <span class="include">org.junit.jupiter.api.Assertions.assertTrue</span>;

<span class="keyword">import</span> <span class="include">java.util.EmptyStackException</span>;
<span class="keyword">import</span> <span class="include">java.util.Stack</span>;

<span class="keyword">import</span> <span class="include">org.junit.jupiter.api.BeforeEach</span>;
<span class="keyword">import</span> <span class="include">org.junit.jupiter.api.DisplayName</span>;
<span class="keyword">import</span> <span class="include">org.junit.jupiter.api.Nested</span>;
<span class="keyword">import</span> <span class="include">org.junit.jupiter.api.Test</span>;

<span class="annotation">@DisplayName</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">A stack</span><span class="delimiter">&quot;</span></span>)
<span class="type">class</span> <span class="class">TestingAStackDemo</span> {

    <span class="predefined-type">Stack</span>&lt;<span class="predefined-type">Object</span>&gt; stack;

    <span class="annotation">@Test</span>
    <span class="annotation">@DisplayName</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">is instantiated with new Stack()</span><span class="delimiter">&quot;</span></span>)
    <span class="type">void</span> isInstantiatedWithNew() {
        <span class="keyword">new</span> <span class="predefined-type">Stack</span>&lt;&gt;();
    }

    <span class="annotation">@Nested</span>
    <span class="annotation">@DisplayName</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">when new</span><span class="delimiter">&quot;</span></span>)
    <span class="type">class</span> <span class="class">WhenNew</span> {

        <span class="annotation">@BeforeEach</span>
        <span class="type">void</span> createNewStack() {
            stack = <span class="keyword">new</span> <span class="predefined-type">Stack</span>&lt;&gt;();
        }

        <span class="annotation">@Test</span>
        <span class="annotation">@DisplayName</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">is empty</span><span class="delimiter">&quot;</span></span>)
        <span class="type">void</span> isEmpty() {
            assertTrue(stack.isEmpty());
        }

        <span class="annotation">@Test</span>
        <span class="annotation">@DisplayName</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">throws EmptyStackException when popped</span><span class="delimiter">&quot;</span></span>)
        <span class="type">void</span> throwsExceptionWhenPopped() {
            assertThrows(<span class="exception">EmptyStackException</span>.class, () -&gt; stack.pop());
        }

        <span class="annotation">@Test</span>
        <span class="annotation">@DisplayName</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">throws EmptyStackException when peeked</span><span class="delimiter">&quot;</span></span>)
        <span class="type">void</span> throwsExceptionWhenPeeked() {
            assertThrows(<span class="exception">EmptyStackException</span>.class, () -&gt; stack.peek());
        }

        <span class="annotation">@Nested</span>
        <span class="annotation">@DisplayName</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">after pushing an element</span><span class="delimiter">&quot;</span></span>)
        <span class="type">class</span> <span class="class">AfterPushing</span> {

            <span class="predefined-type">String</span> anElement = <span class="string"><span class="delimiter">&quot;</span><span class="content">an element</span><span class="delimiter">&quot;</span></span>;

            <span class="annotation">@BeforeEach</span>
            <span class="type">void</span> pushAnElement() {
                stack.push(anElement);
            }

            <span class="annotation">@Test</span>
            <span class="annotation">@DisplayName</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">it is no longer empty</span><span class="delimiter">&quot;</span></span>)
            <span class="type">void</span> isNotEmpty() {
                assertFalse(stack.isEmpty());
            }

            <span class="annotation">@Test</span>
            <span class="annotation">@DisplayName</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">returns the element when popped and is empty</span><span class="delimiter">&quot;</span></span>)
            <span class="type">void</span> returnElementWhenPopped() {
                assertEquals(anElement, stack.pop());
                assertTrue(stack.isEmpty());
            }

            <span class="annotation">@Test</span>
            <span class="annotation">@DisplayName</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">returns the element when peeked but remains not empty</span><span class="delimiter">&quot;</span></span>)
            <span class="type">void</span> returnElementWhenPeeked() {
                assertEquals(anElement, stack.peek());
                assertFalse(stack.isEmpty());
            }
        }
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<em>非staticなネストクラス</em>（すなわち、<em>内部クラス</em>）だけが、<code>@Nested</code>
テストクラスとして使えます。ネストの深さは自由で、すべての内部クラスがテストクラスの
一部とみなされます。ただし、1つだけ例外があり、<code>@BeforeAll</code> および <code>@AfterAll</code>
メソッドは、<em>デフォルトでは</em> 機能しません。というのも、Javaでは内部クラスで
<code>static</code> メンバーを使用できないからです。しかし、この制限は <code>@Nested</code> テストクラスに
<code>@TestInstance(Lifecycle.PER_CLASS)</code> アノテーションを付与することで回避できます
（ <a href="#writing-tests-test-instance-lifecycle">テストインスタンスのライフサイクル</a> 参照）。
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="writing-tests-dependency-injection"><a class="anchor" href="#writing-tests-dependency-injection"></a>3.11. コンストラクタとメソッドへの依存性注入</h3>
<div class="paragraph">
<p>これまでのバージョンのJUnitでは、テストクラスのコンストラクタとメソッドは
（少なくとも標準の <code>Runner</code> 実装では）引数をもつことができませんでした。
JUnit Jupiterの大きな変更点の1つは、テストのコンストラクタやメソッドが
引数をもてるようになったことです。これは大きな柔軟性をもたらし、
<em>依存性注入</em> を可能にします。</p>
</div>
<div class="paragraph">
<p><code><a href="https://junit.org/junit5/docs/5.2.0/api/org/junit/jupiter/api/extension/ParameterResolver.html">ParameterResolver</a></code> は、実行時に <em>動的に</em> 引数を解決したいテスト拡張のための
APIを定義しています。もしテストコンストラクタや <code>@Test</code>, <code>@TestFactory</code>,
<code>@BeforeEach</code>, <code>@AfterEach</code>, <code>@BeforeAll</code>, <code>@AfterAll</code> メソッドが引数をもつ場合、
その引数は登録済みの <code>ParameterResolver</code> によって解決されます。</p>
</div>
<div class="paragraph">
<p>現状、自動的に登録される組み込みのResolverが3つあります。</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code><a href="https://github.com/junit-team/junit5/tree/master/junit-jupiter-engine/src/main/java/org/junit/jupiter/engine/extension/TestInfoParameterResolver.java">TestInfoParameterResolver</a></code>: もしメソッドの引数の型が <code><a href="https://junit.org/junit5/docs/5.2.0/api/org/junit/jupiter/api/TestInfo.html">TestInfo</a></code> の場合、
<code>TestInfoParameterResolver</code> が現在のテストに応じた <code>TestInfo</code> をその引数の値として
与えます。 <code>TestInfo</code> は、テストの表示名やテストクラス、テストメソッド、付与されたタグなど、
現在のテストに関する情報を取得するために使用できます。表示名は、テストクラスやテストメソッド
の名前か、<code>@DisplayName</code> で設定されたカスタムの名前か、どちらかになります。</p>
<div class="paragraph">
<p><code><a href="https://junit.org/junit5/docs/5.2.0/api/org/junit/jupiter/api/TestInfo.html">TestInfo</a></code> は、JUnit 4の <code>TestName</code> ルールの代替として使えます。
次の例は、<code>TestInfo</code> をテストのコンストラクタ、<code>@BeforeEach</code> メソッド、および
<code>@Test</code> メソッドに注入する方法を示しています。</p>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">static</span> <span class="include">org.junit.jupiter.api.Assertions.assertEquals</span>;
<span class="keyword">import</span> <span class="include">static</span> <span class="include">org.junit.jupiter.api.Assertions.assertTrue</span>;

<span class="keyword">import</span> <span class="include">org.junit.jupiter.api.BeforeEach</span>;
<span class="keyword">import</span> <span class="include">org.junit.jupiter.api.DisplayName</span>;
<span class="keyword">import</span> <span class="include">org.junit.jupiter.api.Tag</span>;
<span class="keyword">import</span> <span class="include">org.junit.jupiter.api.Test</span>;
<span class="keyword">import</span> <span class="include">org.junit.jupiter.api.TestInfo</span>;

<span class="annotation">@DisplayName</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">TestInfo Demo</span><span class="delimiter">&quot;</span></span>)
<span class="type">class</span> <span class="class">TestInfoDemo</span> {

    TestInfoDemo(TestInfo testInfo) {
        assertEquals(<span class="string"><span class="delimiter">&quot;</span><span class="content">TestInfo Demo</span><span class="delimiter">&quot;</span></span>, testInfo.getDisplayName());
    }

    <span class="annotation">@BeforeEach</span>
    <span class="type">void</span> init(TestInfo testInfo) {
        <span class="predefined-type">String</span> displayName = testInfo.getDisplayName();
        assertTrue(displayName.equals(<span class="string"><span class="delimiter">&quot;</span><span class="content">TEST 1</span><span class="delimiter">&quot;</span></span>) || displayName.equals(<span class="string"><span class="delimiter">&quot;</span><span class="content">test2()</span><span class="delimiter">&quot;</span></span>));
    }

    <span class="annotation">@Test</span>
    <span class="annotation">@DisplayName</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">TEST 1</span><span class="delimiter">&quot;</span></span>)
    <span class="annotation">@Tag</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">my-tag</span><span class="delimiter">&quot;</span></span>)
    <span class="type">void</span> test1(TestInfo testInfo) {
        assertEquals(<span class="string"><span class="delimiter">&quot;</span><span class="content">TEST 1</span><span class="delimiter">&quot;</span></span>, testInfo.getDisplayName());
        assertTrue(testInfo.getTags().contains(<span class="string"><span class="delimiter">&quot;</span><span class="content">my-tag</span><span class="delimiter">&quot;</span></span>));
    }

    <span class="annotation">@Test</span>
    <span class="type">void</span> test2() {
    }

}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code><a href="https://github.com/junit-team/junit5/tree/master/junit-jupiter-engine/src/main/java/org/junit/jupiter/engine/extension/RepetitionInfoParameterResolver.java">RepetitionInfoParameterResolver</a></code>: もし <code>@RepeatedTest</code>, <code>@BeforeEach</code>,
<code>@AfterEach</code> メソッドの引数の型が <code><a href="https://junit.org/junit5/docs/5.2.0/api/org/junit/jupiter/api/RepetitionInfo.html">RepetitionInfo</a></code> の場合、
<code>RepetitionInfoParameterResolver</code> が <code>RepetitionInfo</code> インスタンスを与えます。
<code>RepetitionInfo</code> は、<code>@RepeatedTest</code> の現在の繰り返し回数や合計回数の情報を
取得するために使用できます。ただし、<code>RepetitionInfoParameterResolver</code> は
<code>@RepeatedTest</code> 以外では登録されないことに注意してください。
<a href="#writing-tests-repeated-tests-examples">繰り返しテストの例</a> を参照。</p>
</li>
<li>
<p><code><a href="https://github.com/junit-team/junit5/tree/master/junit-jupiter-engine/src/main/java/org/junit/jupiter/engine/extension/TestReporterParameterResolver.java">TestReporterParameterResolver</a></code>: もしメソッドの引数の型が <code><a href="https://junit.org/junit5/docs/5.2.0/api/org/junit/jupiter/api/TestReporter.html">TestReporter</a></code>
の場合、<code>TestReporterParameterResolver</code> が <code>TestReporter</code> インスタンスを与えます。
<code>TestReporter</code> は、現在のテスト実行に関する追加のデータを出力するために使用できます。
このデータは、<code><a href="https://junit.org/junit5/docs/5.2.0/api/org/junit/platform/launcher/TestExecutionListener.html">TestExecutionListener</a>.reportingEntryPublished()</code>
を通して取得できるので、IDEで参照したり、レポートに含めたりできます。</p>
<div class="paragraph">
<p>JUnit Jupiterでは、JUnit 4で <code>stdout</code> や <code>stderr</code> に情報を出力していた代わりに、
<code>TestReporter</code> を使うべきです。 <code>@RunWith(JUnitPlatform.class)</code> を使うときも、
すべてのレポート情報が <code>stdout</code> に出力されます。</p>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">java.util.HashMap</span>;

<span class="keyword">import</span> <span class="include">org.junit.jupiter.api.Test</span>;
<span class="keyword">import</span> <span class="include">org.junit.jupiter.api.TestReporter</span>;

<span class="type">class</span> <span class="class">TestReporterDemo</span> {

    <span class="annotation">@Test</span>
    <span class="type">void</span> reportSingleValue(TestReporter testReporter) {
        testReporter.publishEntry(<span class="string"><span class="delimiter">&quot;</span><span class="content">a key</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">a value</span><span class="delimiter">&quot;</span></span>);
    }

    <span class="annotation">@Test</span>
    <span class="type">void</span> reportSeveralValues(TestReporter testReporter) {
        <span class="predefined-type">HashMap</span>&lt;<span class="predefined-type">String</span>, <span class="predefined-type">String</span>&gt; values = <span class="keyword">new</span> <span class="predefined-type">HashMap</span>&lt;&gt;();
        values.put(<span class="string"><span class="delimiter">&quot;</span><span class="content">user name</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">dk38</span><span class="delimiter">&quot;</span></span>);
        values.put(<span class="string"><span class="delimiter">&quot;</span><span class="content">award year</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">1974</span><span class="delimiter">&quot;</span></span>);

        testReporter.publishEntry(values);
    }

}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
そのほかの <code>ParameterResolver</code> は、<code>@ExtendWith</code> を使って適切な
<a href="#extensions">拡張機能</a> を登録することで、明示的に有効にしなければなりません。
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>カスタムの <code><a href="https://junit.org/junit5/docs/5.2.0/api/org/junit/jupiter/api/extension/ParameterResolver.html">ParameterResolver</a></code> のサンプルとしては、<code><a href="https://github.com/junit-team/junit5-samples/tree/master/junit5-jupiter-extensions/src/main/java/com/example/random/RandomParametersExtension.java">RandomParametersExtension</a></code>
を参照してください。本番利用を想定したものではありませんが、
拡張モデルとパラメーター解決処理のシンプルさや高い表現力を示しています。
<code>MyRandomParametersTest</code> は、乱数を <code>@Test</code> メソッドに注入する例になっています。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@ExtendWith</span>(RandomParametersExtension.class)
<span class="type">class</span> <span class="class">MyRandomParametersTest</span> {

    <span class="annotation">@Test</span>
    <span class="type">void</span> injectsInteger(<span class="annotation">@Random</span> <span class="type">int</span> i, <span class="annotation">@Random</span> <span class="type">int</span> j) {
        assertNotEquals(i, j);
    }

    <span class="annotation">@Test</span>
    <span class="type">void</span> injectsDouble(<span class="annotation">@Random</span> <span class="type">double</span> d) {
        assertEquals(<span class="float">0.0</span>, d, <span class="float">1.0</span>);
    }

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>実世界のユースケースとしては、<code><a href="https://github.com/mockito/mockito/blob/release/2.x/subprojects/junit-jupiter/src/main/java/org/mockito/junit/jupiter/MockitoExtension.java">MockitoExtension</a></code> や <code><a href="https://github.com/spring-projects/spring-framework/tree/master/spring-test/src/main/java/org/springframework/test/context/junit/jupiter/SpringExtension.java">SpringExtension</a></code>
のソースコードを確認してください。</p>
</div>
</div>
<div class="sect2">
<h3 id="writing-tests-test-interfaces-and-default-methods"><a class="anchor" href="#writing-tests-test-interfaces-and-default-methods"></a>3.12. テストインターフェースとデフォルトメソッド</h3>
<div class="paragraph">
<p>JUnit Jupiterでは、<code>@Test</code>, <code>@RepeatedTest</code>, <code>@ParameterizedTest</code>, <code>@TestFactory</code>,
<code>@TestTemplate</code>, <code>@BeforeEach</code>, <code>@AfterEach</code> アノテーションをインターフェースの
<code>default</code> メソッドに対して宣言することもできます。 <code>@BeforeAll</code> と <code>@AfterAll</code>
はテストインターフェースの <code>static</code> メソッドにしか宣言できませんが、
<code>@TestInstance(Lifecycle.PER_CLASS)</code> がテストインターフェースまたはテストクラスに
付与されていればインターフェースの <code>default</code> メソッドに宣言することもできます
（<a href="#writing-tests-test-instance-lifecycle">テストインスタンスのライフサイクル</a> 参照）。以下はサンプルです。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@TestInstance</span>(Lifecycle.PER_CLASS)
<span class="type">interface</span> <span class="class">TestLifecycleLogger</span> {

    <span class="directive">static</span> <span class="directive">final</span> <span class="predefined-type">Logger</span> LOG = <span class="predefined-type">Logger</span>.getLogger(TestLifecycleLogger.class.getName());

    <span class="annotation">@BeforeAll</span>
    <span class="keyword">default</span> <span class="type">void</span> beforeAllTests() {
        LOG.info(<span class="string"><span class="delimiter">&quot;</span><span class="content">Before all tests</span><span class="delimiter">&quot;</span></span>);
    }

    <span class="annotation">@AfterAll</span>
    <span class="keyword">default</span> <span class="type">void</span> afterAllTests() {
        LOG.info(<span class="string"><span class="delimiter">&quot;</span><span class="content">After all tests</span><span class="delimiter">&quot;</span></span>);
    }

    <span class="annotation">@BeforeEach</span>
    <span class="keyword">default</span> <span class="type">void</span> beforeEachTest(TestInfo testInfo) {
        LOG.info(() -&gt; <span class="predefined-type">String</span>.format(<span class="string"><span class="delimiter">&quot;</span><span class="content">About to execute [%s]</span><span class="delimiter">&quot;</span></span>,
            testInfo.getDisplayName()));
    }

    <span class="annotation">@AfterEach</span>
    <span class="keyword">default</span> <span class="type">void</span> afterEachTest(TestInfo testInfo) {
        LOG.info(() -&gt; <span class="predefined-type">String</span>.format(<span class="string"><span class="delimiter">&quot;</span><span class="content">Finished executing [%s]</span><span class="delimiter">&quot;</span></span>,
            testInfo.getDisplayName()));
    }

}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="type">interface</span> <span class="class">TestInterfaceDynamicTestsDemo</span> {

    <span class="annotation">@TestFactory</span>
    <span class="keyword">default</span> <span class="predefined-type">Collection</span>&lt;DynamicTest&gt; dynamicTestsFromCollection() {
        <span class="keyword">return</span> <span class="predefined-type">Arrays</span>.asList(
            dynamicTest(<span class="string"><span class="delimiter">&quot;</span><span class="content">1st dynamic test in test interface</span><span class="delimiter">&quot;</span></span>, () -&gt; assertTrue(<span class="predefined-constant">true</span>)),
            dynamicTest(<span class="string"><span class="delimiter">&quot;</span><span class="content">2nd dynamic test in test interface</span><span class="delimiter">&quot;</span></span>, () -&gt; assertEquals(<span class="integer">4</span>, <span class="integer">2</span> * <span class="integer">2</span>))
        );
    }

}</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>@ExtendWith</code> と <code>@Tag</code> はテストインターフェースに宣言することで、
そのインタフェースを実装したクラスにタグと拡張機能を自動的に継承させることができます。
<a href="#extensions-lifecycle-callbacks-before-after-execution">テスト実行前後のコールバック</a> にある
<a href="#extensions-lifecycle-callbacks-timing-extension">TimingExtension</a>
のソースコードを参照してください。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Tag</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">timed</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@ExtendWith</span>(TimingExtension.class)
<span class="type">interface</span> <span class="class">TimeExecutionLogger</span> {
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>これらのインタフェースを実装することでテストクラスに適用することができます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="type">class</span> <span class="class">TestInterfaceDemo</span> <span class="directive">implements</span> TestLifecycleLogger,
        TimeExecutionLogger, TestInterfaceDynamicTestsDemo {

    <span class="annotation">@Test</span>
    <span class="type">void</span> isEqualValue() {
        assertEquals(<span class="integer">1</span>, <span class="integer">1</span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">is always equal</span><span class="delimiter">&quot;</span></span>);
    }

}</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>TestInterfaceDemo</code> を実行すると、次のような出力となります。</p>
</div>
<div class="literalblock">
<div class="content">
<pre>:junitPlatformTest
INFO  example.TestLifecycleLogger - Before all tests
INFO  example.TestLifecycleLogger - About to execute [dynamicTestsFromCollection()]
INFO  example.TimingExtension - Method [dynamicTestsFromCollection] took 13 ms.
INFO  example.TestLifecycleLogger - Finished executing [dynamicTestsFromCollection()]
INFO  example.TestLifecycleLogger - About to execute [isEqualValue()]
INFO  example.TimingExtension - Method [isEqualValue] took 1 ms.
INFO  example.TestLifecycleLogger - Finished executing [isEqualValue()]
INFO  example.TestLifecycleLogger - After all tests

Test run finished after 190 ms
[         3 containers found      ]
[         0 containers skipped    ]
[         3 containers started    ]
[         0 containers aborted    ]
[         3 containers successful ]
[         0 containers failed     ]
[         3 tests found           ]
[         0 tests skipped         ]
[         3 tests started         ]
[         0 tests aborted         ]
[         3 tests successful      ]
[         0 tests failed          ]

BUILD SUCCESSFUL</pre>
</div>
</div>
<div class="paragraph">
<p>この機能の別の適用例としては、インタフェース契約に対するテストが考えられます。
例えば、<code>Object.equals</code> や <code>Comparable.compareTo</code> の実装クラスが
どう振る舞うべきかのテストを次のように書くことができます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">interface</span> <span class="class">Testable</span>&lt;T&gt; {

    T createValue();

}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">interface</span> <span class="class">EqualsContract</span>&lt;T&gt; <span class="directive">extends</span> Testable&lt;T&gt; {

    T createNotEqualValue();

    <span class="annotation">@Test</span>
    <span class="keyword">default</span> <span class="type">void</span> valueEqualsItself() {
        T value = createValue();
        assertEquals(value, value);
    }

    <span class="annotation">@Test</span>
    <span class="keyword">default</span> <span class="type">void</span> valueDoesNotEqualNull() {
        T value = createValue();
        assertFalse(value.equals(<span class="predefined-constant">null</span>));
    }

    <span class="annotation">@Test</span>
    <span class="keyword">default</span> <span class="type">void</span> valueDoesNotEqualDifferentValue() {
        T value = createValue();
        T differentValue = createNotEqualValue();
        assertNotEquals(value, differentValue);
        assertNotEquals(differentValue, value);
    }

}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">interface</span> <span class="class">ComparableContract</span>&lt;T <span class="directive">extends</span> <span class="predefined-type">Comparable</span>&lt;T&gt;&gt; <span class="directive">extends</span> Testable&lt;T&gt; {

    T createSmallerValue();

    <span class="annotation">@Test</span>
    <span class="keyword">default</span> <span class="type">void</span> returnsZeroWhenComparedToItself() {
        T value = createValue();
        assertEquals(<span class="integer">0</span>, value.compareTo(value));
    }

    <span class="annotation">@Test</span>
    <span class="keyword">default</span> <span class="type">void</span> returnsPositiveNumberComparedToSmallerValue() {
        T value = createValue();
        T smallerValue = createSmallerValue();
        assertTrue(value.compareTo(smallerValue) &gt; <span class="integer">0</span>);
    }

    <span class="annotation">@Test</span>
    <span class="keyword">default</span> <span class="type">void</span> returnsNegativeNumberComparedToSmallerValue() {
        T value = createValue();
        T smallerValue = createSmallerValue();
        assertTrue(smallerValue.compareTo(value) &lt; <span class="integer">0</span>);
    }

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>テストクラスでこれらの契約インターフェースを実装することで、対応するテストケースを
継承することができます。もちろん、抽象メソッドは自分で実装する必要があります。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="type">class</span> <span class="class">StringTests</span> <span class="directive">implements</span> ComparableContract&lt;<span class="predefined-type">String</span>&gt;, EqualsContract&lt;<span class="predefined-type">String</span>&gt; {

    <span class="annotation">@Override</span>
    <span class="directive">public</span> <span class="predefined-type">String</span> createValue() {
        <span class="keyword">return</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">foo</span><span class="delimiter">&quot;</span></span>;
    }

    <span class="annotation">@Override</span>
    <span class="directive">public</span> <span class="predefined-type">String</span> createSmallerValue() {
        <span class="keyword">return</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">bar</span><span class="delimiter">&quot;</span></span>; <span class="comment">// 'b' &lt; 'f' in &quot;foo&quot;</span>
    }

    <span class="annotation">@Override</span>
    <span class="directive">public</span> <span class="predefined-type">String</span> createNotEqualValue() {
        <span class="keyword">return</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">baz</span><span class="delimiter">&quot;</span></span>;
    }

}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
前述のテストはサンプル目的であり、完全なものではありません。
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="writing-tests-repeated-tests"><a class="anchor" href="#writing-tests-repeated-tests"></a>3.13. 繰り返しテスト</h3>
<div class="paragraph">
<p>JUnit Jupiterは、<code>@RepeatedTest</code> アノテーションを使って指定した回数だけ
繰り返しテストを実行する機能を提供しています。
繰り返しテストの1回毎の呼び出しは、ライフサイクルコールバックや拡張機能など、通常の
<code>@Test</code> メソッドの実行と同じように振る舞います。</p>
</div>
<div class="paragraph">
<p>次の例は、自動的に10回繰り返す <code>repeatedTest()</code> を宣言する方法を示しています。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@RepeatedTest</span>(<span class="integer">10</span>)
<span class="type">void</span> repeatedTest() {
    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>繰り返し回数を指定するだけでなく、<code>@RepeatedTest</code> アノテーションの <code>name</code>
属性を使って、繰り返し実行毎の表示名を変更することもできます。表示名は、
静的なテキストと動的なプレースホルダーを組み合わせたパターンにできます。
以下が、現在サポートされているプレースホルダーです。</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>{displayName}</code>: <code>@RepeatedTest</code> メソッドの表示名</p>
</li>
<li>
<p><code>{currentRepetition}</code>: 現在の実行回数</p>
</li>
<li>
<p><code>{totalRepetitions}</code>: トータルの実行回数</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>デフォルトの表示名は、<code>"repetition {currentRepetition} of {totalRepetitions}"</code>
というパターンに従います。そのため、前述の <code>repeatedTest()</code> に対する表示名は、
<code>repetition 1 of 10</code>, <code>repetition 2 of 10</code> のようになります。
もし <code>@RepeatedTest</code> メソッドの名前を含めたい場合は、カスタムのパターンを指定するか、
定義済みの <code>RepeatedTest.LONG_DISPLAY_NAME</code> パターンを指定できます。
後者は、<code>"{displayName} :: repetition {currentRepetition} of {totalRepetitions}"</code>
というパターンと同等で、<code>repeatedTest() :: repetition 1 of 10</code>,
<code>repeatedTest() :: repetition 2 of 10</code> のようになります。</p>
</div>
<div class="paragraph">
<p>現在の繰り返し回数やトータルの繰り返し回数をプログラムから取得するためには、
<code>RepetitionInfo</code> インスタンスを <code>@RepeatedTest</code>, <code>@BeforeEach</code>, <code>@AfterEach</code>
メソッドのいずれかに注入させることができます。</p>
</div>
<div class="sect3">
<h4 id="writing-tests-repeated-tests-examples"><a class="anchor" href="#writing-tests-repeated-tests-examples"></a>3.13.1. 繰り返しテストの例</h4>
<div class="paragraph">
<p>この節の最後の <code>RepeatedTestsDemo</code> クラスは、繰り返しテストの様々な例を示しています。</p>
</div>
<div class="paragraph">
<p><code>repeatedTest()</code> メソッドは、前の節で紹介した例と同じです。一方、
<code>repeatedTestWithRepetitionInfo()</code> は、トータルの繰り返し回数を取得するために
<code>RepetitionInfo</code> インスタンスをテストに注入させる方法を示しています。</p>
</div>
<div class="paragraph">
<p>その次の2つのメソッドは、<code>@RepeatedTest</code> メソッドに対するカスタムの <code>@DisplayName</code>
を各繰り返しの表示名に含める方法を示しています。<code>customDisplayName()</code> は、
カスタムの表示名とパターンを組み合わせて指定し、生成された表示名を検証するのに
<code>TestInfo</code> を使っています。
<code>{displayName}</code> が <code>@DisplayName</code> の宣言から <code>Repeat!</code> となり、
<code>{currentRepetition}/{totalRepetitions}</code> が <code>1/1</code> となります。
一方、<code>customDisplayNameWithLongPattern()</code> は前述の定義済みパターン
<code>RepeatedTest.LONG_DISPLAY_NAME</code> を使っています。</p>
</div>
<div class="paragraph">
<p><code>repeatedTestInGerman()</code> は、繰り返しテストの表示名を外国語（この場合、ドイツ語）
に翻訳する方法を示しています。各繰り返しの表示名は、<code>Wiederholung 1 von 5</code>,
<code>Wiederholung 2 von 5</code> のようになります。</p>
</div>
<div class="paragraph">
<p><code>beforeEach()</code> メソッドは <code>@BeforeEach</code> アノテーションが付与されているため、
繰り返しテストの個々の繰り返し実行の度に実行されます。<code>TestInfo</code> と
<code>RepetitionInfo</code> をメソッドに注入させることで、現在実行中の繰り返しテストに
関する情報を取得できることが分かります。<code>INFO</code> レベルのログを有効にして
<code>RepeatedTestsDemo</code> を実行すると、次のような出力となります。</p>
</div>
<div class="literalblock">
<div class="content">
<pre>INFO: About to execute repetition 1 of 10 for repeatedTest
INFO: About to execute repetition 2 of 10 for repeatedTest
INFO: About to execute repetition 3 of 10 for repeatedTest
INFO: About to execute repetition 4 of 10 for repeatedTest
INFO: About to execute repetition 5 of 10 for repeatedTest
INFO: About to execute repetition 6 of 10 for repeatedTest
INFO: About to execute repetition 7 of 10 for repeatedTest
INFO: About to execute repetition 8 of 10 for repeatedTest
INFO: About to execute repetition 9 of 10 for repeatedTest
INFO: About to execute repetition 10 of 10 for repeatedTest
INFO: About to execute repetition 1 of 5 for repeatedTestWithRepetitionInfo
INFO: About to execute repetition 2 of 5 for repeatedTestWithRepetitionInfo
INFO: About to execute repetition 3 of 5 for repeatedTestWithRepetitionInfo
INFO: About to execute repetition 4 of 5 for repeatedTestWithRepetitionInfo
INFO: About to execute repetition 5 of 5 for repeatedTestWithRepetitionInfo
INFO: About to execute repetition 1 of 1 for customDisplayName
INFO: About to execute repetition 1 of 1 for customDisplayNameWithLongPattern
INFO: About to execute repetition 1 of 5 for repeatedTestInGerman
INFO: About to execute repetition 2 of 5 for repeatedTestInGerman
INFO: About to execute repetition 3 of 5 for repeatedTestInGerman
INFO: About to execute repetition 4 of 5 for repeatedTestInGerman
INFO: About to execute repetition 5 of 5 for repeatedTestInGerman</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">static</span> <span class="include">org.junit.jupiter.api.Assertions.assertEquals</span>;

<span class="keyword">import</span> <span class="include">java.util.logging.Logger</span>;

<span class="keyword">import</span> <span class="include">org.junit.jupiter.api.BeforeEach</span>;
<span class="keyword">import</span> <span class="include">org.junit.jupiter.api.DisplayName</span>;
<span class="keyword">import</span> <span class="include">org.junit.jupiter.api.RepeatedTest</span>;
<span class="keyword">import</span> <span class="include">org.junit.jupiter.api.RepetitionInfo</span>;
<span class="keyword">import</span> <span class="include">org.junit.jupiter.api.TestInfo</span>;

<span class="type">class</span> <span class="class">RepeatedTestsDemo</span> {

    <span class="directive">private</span> <span class="predefined-type">Logger</span> logger = <span class="comment">// ...</span>

    <span class="annotation">@BeforeEach</span>
    <span class="type">void</span> beforeEach(TestInfo testInfo, RepetitionInfo repetitionInfo) {
        <span class="type">int</span> currentRepetition = repetitionInfo.getCurrentRepetition();
        <span class="type">int</span> totalRepetitions = repetitionInfo.getTotalRepetitions();
        <span class="predefined-type">String</span> methodName = testInfo.getTestMethod().get().getName();
        logger.info(<span class="predefined-type">String</span>.format(<span class="string"><span class="delimiter">&quot;</span><span class="content">About to execute repetition %d of %d for %s</span><span class="delimiter">&quot;</span></span>, <span class="comment">//</span>
            currentRepetition, totalRepetitions, methodName));
    }

    <span class="annotation">@RepeatedTest</span>(<span class="integer">10</span>)
    <span class="type">void</span> repeatedTest() {
        <span class="comment">// ...</span>
    }

    <span class="annotation">@RepeatedTest</span>(<span class="integer">5</span>)
    <span class="type">void</span> repeatedTestWithRepetitionInfo(RepetitionInfo repetitionInfo) {
        assertEquals(<span class="integer">5</span>, repetitionInfo.getTotalRepetitions());
    }

    <span class="annotation">@RepeatedTest</span>(value = <span class="integer">1</span>, name = <span class="string"><span class="delimiter">&quot;</span><span class="content">{displayName} {currentRepetition}/{totalRepetitions}</span><span class="delimiter">&quot;</span></span>)
    <span class="annotation">@DisplayName</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">Repeat!</span><span class="delimiter">&quot;</span></span>)
    <span class="type">void</span> customDisplayName(TestInfo testInfo) {
        assertEquals(testInfo.getDisplayName(), <span class="string"><span class="delimiter">&quot;</span><span class="content">Repeat! 1/1</span><span class="delimiter">&quot;</span></span>);
    }

    <span class="annotation">@RepeatedTest</span>(value = <span class="integer">1</span>, name = RepeatedTest.LONG_DISPLAY_NAME)
    <span class="annotation">@DisplayName</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">Details...</span><span class="delimiter">&quot;</span></span>)
    <span class="type">void</span> customDisplayNameWithLongPattern(TestInfo testInfo) {
        assertEquals(testInfo.getDisplayName(), <span class="string"><span class="delimiter">&quot;</span><span class="content">Details... :: repetition 1 of 1</span><span class="delimiter">&quot;</span></span>);
    }

    <span class="annotation">@RepeatedTest</span>(value = <span class="integer">5</span>, name = <span class="string"><span class="delimiter">&quot;</span><span class="content">Wiederholung {currentRepetition} von {totalRepetitions}</span><span class="delimiter">&quot;</span></span>)
    <span class="type">void</span> repeatedTestInGerman() {
        <span class="comment">// ...</span>
    }

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Unicodeテーマを有効にした <code>ConsoleLauncher</code> または <code>junitPlatformTest</code>
Gradle プラグインで <code>RepeatedTestsDemo</code> を実行すると、コンソールには
以下のように出力されます。</p>
</div>
<div class="literalblock">
<div class="content">
<pre>├─ RepeatedTestsDemo ✔
│  ├─ repeatedTest() ✔
│  │  ├─ repetition 1 of 10 ✔
│  │  ├─ repetition 2 of 10 ✔
│  │  ├─ repetition 3 of 10 ✔
│  │  ├─ repetition 4 of 10 ✔
│  │  ├─ repetition 5 of 10 ✔
│  │  ├─ repetition 6 of 10 ✔
│  │  ├─ repetition 7 of 10 ✔
│  │  ├─ repetition 8 of 10 ✔
│  │  ├─ repetition 9 of 10 ✔
│  │  └─ repetition 10 of 10 ✔
│  ├─ repeatedTestWithRepetitionInfo(RepetitionInfo) ✔
│  │  ├─ repetition 1 of 5 ✔
│  │  ├─ repetition 2 of 5 ✔
│  │  ├─ repetition 3 of 5 ✔
│  │  ├─ repetition 4 of 5 ✔
│  │  └─ repetition 5 of 5 ✔
│  ├─ Repeat! ✔
│  │  └─ Repeat! 1/1 ✔
│  ├─ Details... ✔
│  │  └─ Details... :: repetition 1 of 1 ✔
│  └─ repeatedTestInGerman() ✔
│     ├─ Wiederholung 1 von 5 ✔
│     ├─ Wiederholung 2 von 5 ✔
│     ├─ Wiederholung 3 von 5 ✔
│     ├─ Wiederholung 4 von 5 ✔
│     └─ Wiederholung 5 von 5 ✔</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="writing-tests-parameterized-tests"><a class="anchor" href="#writing-tests-parameterized-tests"></a>3.14. パラメーター化テスト</h3>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>訳注：計算機科学の用語に従うのであれば、
<em>argument</em> を <em>実引数（メソッドを呼び出す側から見た引数）</em>、
<em>parameter</em> を <em>仮引数（メソッドを呼ばれる側から見た引数）</em>
と区別して訳すべきだが、パラメーター化テストの説明では前者の
<em>argument</em> を <em>パラメーター</em> と訳してしまった方が
直感的にイメージしやすいと訳者は考える。
原文でも両者の区別があいまいな箇所があるため、以降では
訳者の解釈に従って意訳している。気になる場合は、原文をあたること。</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>パラメーター化テストは、異なる実引数でテストを複数回実行できるようにします。
通常の <code>@Test</code> メソッドに似ていますが、<code><a href="https://junit.org/junit5/docs/5.2.0/api/org/junit/jupiter/params/ParameterizedTest.html">@ParameterizedTest</a></code> アノテーションを
使って宣言します。各呼び出しに対するパラメーターを生成するための <em>ソース (source)</em>
を少なくとも1つは宣言し、そのパラメーターはテストメソッドで <em>消費 (consume)</em>
する必要があります。</p>
</div>
<div class="paragraph">
<p>以下は、パラメーターのソースとして <code>String</code> 配列を指定するために <code>@ValueSource</code>
アノテーションを使用した例を示しています。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@ParameterizedTest</span>
<span class="annotation">@ValueSource</span>(strings = { <span class="string"><span class="delimiter">&quot;</span><span class="content">racecar</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">radar</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">able was I ere I saw elba</span><span class="delimiter">&quot;</span></span> })
<span class="type">void</span> palindromes(<span class="predefined-type">String</span> candidate) {
    assertTrue(isPalindrome(candidate));
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>上のパラメーター化テストメソッドを実行すると、各実行が別々にレポートされます。
例えば、<code>ConsoleLauncher</code> を使うと次のように出力されます。</p>
</div>
<div class="literalblock">
<div class="content">
<pre>palindromes(String) ✔
├─ [1] racecar ✔
├─ [2] radar ✔
└─ [3] able was I ere I saw elba ✔</pre>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
パラーメーター化テストは、現在 <em>実験中</em> の機能です。
詳細は、<a href="#api-evolution-experimental-apis">実験的なAPI</a> の表を確認してください。
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="writing-tests-parameterized-tests-setup"><a class="anchor" href="#writing-tests-parameterized-tests-setup"></a>3.14.1. 必要なセットアップ</h4>
<div class="paragraph">
<p>パラメーター化テストを使うには、<code>junit-jupiter-params</code> への依存を追加する必要があります。
詳細は、<a href="#dependency-metadata">依存関係メタデータ</a> を参照してください。</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="writing-tests-parameterized-tests-consuming-arguments"><a class="anchor" href="#writing-tests-parameterized-tests-consuming-arguments"></a>3.15. パラメーターの消費</h3>
<div class="paragraph">
<p>パラメーター化テストのメソッドは、通常は設定されたソース
(<a href="#writing-tests-parameterized-tests-sources">パラメーターのソース</a> 参照)
からパラメーターのインデックスとメソッドの仮引数のインデックスが1対1となるように
パラメーターを <em>消費</em> します
(<a href="#writing-tests-parameterized-tests-sources-CsvSource">@CsvSource</a> の例を参照)。
しかし、ソースのすべてのパラメーターを単一のオブジェクトに <em>集約</em>
してメソッドに渡すこともできます
(<a href="#writing-tests-parameterized-tests-argument-aggregation">パラメーターの集約</a> 参照)。
また、<code>ParameterResolver</code> を使って追加の引数を渡すこともできます
(例えば、<code>TestInfo</code> や <code>TestReporter</code> のインスタンスなど)。
パラメーター化テストメソッドは、次のルールに従って仮引数を宣言しなければなりません。</p>
</div>
<div class="ulist">
<ul>
<li>
<p>最初に、<em>インデックス付き引数 (indexed argument)</em> を0個以上宣言します</p>
</li>
<li>
<p>その次に、<em>アグリゲーター (aggregator)</em> を0個以上宣言します</p>
</li>
<li>
<p>最後に、<code>ParameterResolver</code> によって渡される引数を0個以上宣言します</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>ここで、<em>インデックス付き引数 (indexed argument)</em> は、<code>ArgumentsProvider</code>
が生成した <code>Arguments</code> 中の指定されたインデックスに対するパラメーターです。
このパラメーターは、パラメーター化テストメソッドの仮引数リストで
同じインデックスに実引数として渡されます。
<em>アグリゲーター (aggregator)</em> は、<code>ArgumentsAccessor</code> 型または <code>@AggregateWith</code>
アノテーションが付与された仮引数です。</p>
</div>
<div class="sect3">
<h4 id="writing-tests-parameterized-tests-sources"><a class="anchor" href="#writing-tests-parameterized-tests-sources"></a>3.15.1. パラメーターのソース</h4>
<div class="paragraph">
<p>JUnit Jupiterは、あらかじめいくつかの <em>ソース</em> アノテーションを提供しています。
以降では、これらのアノテーションについて簡単な説明とサンプルを示します。
より詳細な情報は、<code><a href="https://junit.org/junit5/docs/5.2.0/api/org/junit/jupiter/params/provider/package-summary.html">org.junit.jupiter.params.provider</a></code> パッケージのJavaDocを参照してください。</p>
</div>
<div class="sect4">
<h5 id="writing-tests-parameterized-tests-sources-ValueSource"><a class="anchor" href="#writing-tests-parameterized-tests-sources-ValueSource"></a>@ValueSource</h5>
<div class="paragraph">
<p><code>@ValueSource</code> は、最もシンプルなソースの1つです。リテラル値の配列を指定できますが、
パラメーター化テストの1回の実行につき1つのパラメーターしか与えることができません。</p>
</div>
<div class="paragraph">
<p><code>@ValueSource</code> では、以下の型のリテラル値がサポートされています。</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>short</code></p>
</li>
<li>
<p><code>byte</code></p>
</li>
<li>
<p><code>int</code></p>
</li>
<li>
<p><code>long</code></p>
</li>
<li>
<p><code>float</code></p>
</li>
<li>
<p><code>double</code></p>
</li>
<li>
<p><code>char</code></p>
</li>
<li>
<p><code>java.lang.String</code></p>
</li>
<li>
<p><code>java.lang.Class</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>例えば、次の <code>@ParameterizedTest</code> メソッドは、値 <code>1</code>, <code>2</code>, <code>3</code> をパラメーターとして
3回呼び出されます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@ParameterizedTest</span>
<span class="annotation">@ValueSource</span>(ints = { <span class="integer">1</span>, <span class="integer">2</span>, <span class="integer">3</span> })
<span class="type">void</span> testWithValueSource(<span class="type">int</span> argument) {
    assertTrue(argument &gt; <span class="integer">0</span> &amp;&amp; argument &lt; <span class="integer">4</span>);
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="writing-tests-parameterized-tests-sources-EnumSource"><a class="anchor" href="#writing-tests-parameterized-tests-sources-EnumSource"></a>@EnumSource</h5>
<div class="paragraph">
<p><code>@EnumSource</code> は、<code>Enum</code> 定数を指定する便利な方法を提供します。このアノテーションでは、
省略可能な <code>names</code> 属性を指定すると、その列挙定数だけが使われます。
省略すると、次の例のようにすべての列挙定数が使われます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@ParameterizedTest</span>
<span class="annotation">@EnumSource</span>(<span class="predefined-type">TimeUnit</span>.class)
<span class="type">void</span> testWithEnumSource(<span class="predefined-type">TimeUnit</span> timeUnit) {
    assertNotNull(timeUnit);
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@ParameterizedTest</span>
<span class="annotation">@EnumSource</span>(value = <span class="predefined-type">TimeUnit</span>.class, names = { <span class="string"><span class="delimiter">&quot;</span><span class="content">DAYS</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">HOURS</span><span class="delimiter">&quot;</span></span> })
<span class="type">void</span> testWithEnumSourceInclude(<span class="predefined-type">TimeUnit</span> timeUnit) {
    assertTrue(<span class="predefined-type">EnumSet</span>.of(<span class="predefined-type">TimeUnit</span>.DAYS, <span class="predefined-type">TimeUnit</span>.HOURS).contains(timeUnit));
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>@EnumSource</code> アノテーションは、テストメソッドに渡される列挙定数をさらに細かく制御するために、
省略可能な <code>mode</code> 属性も提供しています。例えば、一部の名前をもつ列挙定数だけ除外したり、
正規表現で列挙定数を指定したりすることができます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@ParameterizedTest</span>
<span class="annotation">@EnumSource</span>(value = <span class="predefined-type">TimeUnit</span>.class, mode = EXCLUDE, names = { <span class="string"><span class="delimiter">&quot;</span><span class="content">DAYS</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">HOURS</span><span class="delimiter">&quot;</span></span> })
<span class="type">void</span> testWithEnumSourceExclude(<span class="predefined-type">TimeUnit</span> timeUnit) {
    assertFalse(<span class="predefined-type">EnumSet</span>.of(<span class="predefined-type">TimeUnit</span>.DAYS, <span class="predefined-type">TimeUnit</span>.HOURS).contains(timeUnit));
    assertTrue(timeUnit.name().length() &gt; <span class="integer">5</span>);
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@ParameterizedTest</span>
<span class="annotation">@EnumSource</span>(value = <span class="predefined-type">TimeUnit</span>.class, mode = MATCH_ALL, names = <span class="string"><span class="delimiter">&quot;</span><span class="content">^(M|N).+SECONDS$</span><span class="delimiter">&quot;</span></span>)
<span class="type">void</span> testWithEnumSourceRegex(<span class="predefined-type">TimeUnit</span> timeUnit) {
    <span class="predefined-type">String</span> name = timeUnit.name();
    assertTrue(name.startsWith(<span class="string"><span class="delimiter">&quot;</span><span class="content">M</span><span class="delimiter">&quot;</span></span>) || name.startsWith(<span class="string"><span class="delimiter">&quot;</span><span class="content">N</span><span class="delimiter">&quot;</span></span>));
    assertTrue(name.endsWith(<span class="string"><span class="delimiter">&quot;</span><span class="content">SECONDS</span><span class="delimiter">&quot;</span></span>));
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="writing-tests-parameterized-tests-sources-MethodSource"><a class="anchor" href="#writing-tests-parameterized-tests-sources-MethodSource"></a>@MethodSource</h5>
<div class="paragraph">
<p><code>@MethodSource</code> は、テストクラスまたは外部のクラスの <em>ファクトリ</em>
メソッドによるパラメーターの指定を可能にします。
ファクトリメソッドは、<code>Stream</code>, <code>Iterable</code>, <code>Iterator</code> または配列のいずれかを
返さなければいけません。また、引数を受け取ることもできません。
テストクラス内のファクトリメソッドは、<code>@TestInstance(Lifecycle.PER_CLASS)</code>
アノテーションが付与されていない限り、<code>static</code> でなければいけません。
一方、外部クラスのファクトリメソッドは、常に <code>static</code> でなければいけません。</p>
</div>
<div class="paragraph">
<p>パラメーターが1つしか必要なければ、次の例のようにパラメーターのインスタンスを
<code>Stream</code> で返すことができます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@ParameterizedTest</span>
<span class="annotation">@MethodSource</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">stringProvider</span><span class="delimiter">&quot;</span></span>)
<span class="type">void</span> testWithSimpleMethodSource(<span class="predefined-type">String</span> argument) {
    assertNotNull(argument);
}

<span class="directive">static</span> Stream&lt;<span class="predefined-type">String</span>&gt; stringProvider() {
    <span class="keyword">return</span> Stream.of(<span class="string"><span class="delimiter">&quot;</span><span class="content">foo</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">bar</span><span class="delimiter">&quot;</span></span>);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>もし <code>@MethodSource</code> でファクトリメソッドの名前を明示的に指定しなかった場合、JUnit Jupiter
は <code>@ParameterizedTest</code> メソッドと同じ名前をもつファクトリメソッドを自動的に探します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@ParameterizedTest</span>
<span class="annotation">@MethodSource</span>
<span class="type">void</span> testWithSimpleMethodSourceHavingNoValue(<span class="predefined-type">String</span> argument) {
    assertNotNull(argument);
}

<span class="directive">static</span> Stream&lt;<span class="predefined-type">String</span>&gt; testWithSimpleMethodSourceHavingNoValue() {
    <span class="keyword">return</span> Stream.of(<span class="string"><span class="delimiter">&quot;</span><span class="content">foo</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">bar</span><span class="delimiter">&quot;</span></span>);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>プリミティブ型のストリーム (<code>DoubleStream</code>, <code>IntStream</code>, <code>LongStream</code>)
もサポートされています。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@ParameterizedTest</span>
<span class="annotation">@MethodSource</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">range</span><span class="delimiter">&quot;</span></span>)
<span class="type">void</span> testWithRangeMethodSource(<span class="type">int</span> argument) {
    assertNotEquals(<span class="integer">9</span>, argument);
}

<span class="directive">static</span> IntStream range() {
    <span class="keyword">return</span> IntStream.range(<span class="integer">0</span>, <span class="integer">20</span>).skip(<span class="integer">10</span>);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>テストメソッドが複数の仮引数を宣言している場合、以下で示すように <code>Arguments</code>
のコレクションかストリームを返す必要があります。<code>Arguments.of(Object&#8230;&#8203;)</code> は、
<code>Arguments</code> インターフェースで定義されるstaticファクトリメソッドである点に注意してください。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@ParameterizedTest</span>
<span class="annotation">@MethodSource</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">stringIntAndListProvider</span><span class="delimiter">&quot;</span></span>)
<span class="type">void</span> testWithMultiArgMethodSource(<span class="predefined-type">String</span> str, <span class="type">int</span> num, <span class="predefined-type">List</span>&lt;<span class="predefined-type">String</span>&gt; list) {
    assertEquals(<span class="integer">3</span>, str.length());
    assertTrue(num &gt;=<span class="integer">1</span> &amp;&amp; num &lt;=<span class="integer">2</span>);
    assertEquals(<span class="integer">2</span>, list.size());
}

<span class="directive">static</span> Stream&lt;Arguments&gt; stringIntAndListProvider() {
    <span class="keyword">return</span> Stream.of(
        Arguments.of(<span class="string"><span class="delimiter">&quot;</span><span class="content">foo</span><span class="delimiter">&quot;</span></span>, <span class="integer">1</span>, <span class="predefined-type">Arrays</span>.asList(<span class="string"><span class="delimiter">&quot;</span><span class="content">a</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">b</span><span class="delimiter">&quot;</span></span>)),
        Arguments.of(<span class="string"><span class="delimiter">&quot;</span><span class="content">bar</span><span class="delimiter">&quot;</span></span>, <span class="integer">2</span>, <span class="predefined-type">Arrays</span>.asList(<span class="string"><span class="delimiter">&quot;</span><span class="content">x</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">y</span><span class="delimiter">&quot;</span></span>))
    );
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>次の例で示すように、<em>メソッドの完全修飾名</em> を指定することで、外部の <code>static</code> な
<em>ファクトリ</em> メソッドを参照することもできます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">example</span>;

<span class="keyword">import</span> <span class="include">java.util.stream.Stream</span>;

<span class="keyword">import</span> <span class="include">org.junit.jupiter.params.ParameterizedTest</span>;
<span class="keyword">import</span> <span class="include">org.junit.jupiter.params.provider.MethodSource</span>;

<span class="type">class</span> <span class="class">ExternalMethodSourceDemo</span> {

    <span class="annotation">@ParameterizedTest</span>
    <span class="annotation">@MethodSource</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">example.StringsProviders#blankStrings</span><span class="delimiter">&quot;</span></span>)
    <span class="type">void</span> testWithExternalMethodSource(<span class="predefined-type">String</span> blankString) {
        <span class="comment">// test with blank string</span>
    }
}

<span class="type">class</span> <span class="class">StringsProviders</span> {

    <span class="directive">static</span> Stream&lt;<span class="predefined-type">String</span>&gt; blankStrings() {
        <span class="keyword">return</span> Stream.of(<span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content"> </span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content"> </span><span class="char">\n</span><span class="content"> </span><span class="delimiter">&quot;</span></span>);
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="writing-tests-parameterized-tests-sources-CsvSource"><a class="anchor" href="#writing-tests-parameterized-tests-sources-CsvSource"></a>@CsvSource</h5>
<div class="paragraph">
<p><code>@CsvSource</code> は、パラメーターのリストをカンマ区切りの値（<code>String</code> リテラル）
で指定できるようにします。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@ParameterizedTest</span>
<span class="annotation">@CsvSource</span>({ <span class="string"><span class="delimiter">&quot;</span><span class="content">foo, 1</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">bar, 2</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">'baz, qux', 3</span><span class="delimiter">&quot;</span></span> })
<span class="type">void</span> testWithCsvSource(<span class="predefined-type">String</span> first, <span class="type">int</span> second) {
    assertNotNull(first);
    assertNotEquals(<span class="integer">0</span>, second);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>@CsvSource</code> は、シングルクォート <code>'</code> を引用符として使います。
上の例の <code>'baz, qux'</code> と、以下のテーブルを参照してください。
引用符で囲まれた空の値 <code>''</code> は空の <code>String</code> になりますが、
（引用符で囲まれない）完全に <em>空</em> の値は <code>null</code> と解釈されます。
<code>null</code> の代入先の型がプリミティブ型の場合は、
<code>ArgumentConversionException</code> が発生します。</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Example Input</th>
<th class="tableblock halign-left valign-top">Resulting Argument List</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@CsvSource({ "foo, bar" })</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"foo"</code>, <code>"bar"</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@CsvSource({ "foo, 'baz, qux'" })</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"foo"</code>, <code>"baz, qux"</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@CsvSource({ "foo, ''" })</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"foo"</code>, <code>""</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@CsvSource({ "foo, " })</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"foo"</code>, <code>null</code></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="writing-tests-parameterized-tests-sources-CsvFileSource"><a class="anchor" href="#writing-tests-parameterized-tests-sources-CsvFileSource"></a>@CsvFileSource</h5>
<div class="paragraph">
<p><code>@CsvFileSource</code> は、クラスパスにあるCSVファイルを使えるようにします。
CSVファイルの各行は、パラメーター化テストの1回の実行になります。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@ParameterizedTest</span>
<span class="annotation">@CsvFileSource</span>(resources = <span class="string"><span class="delimiter">&quot;</span><span class="content">/two-column.csv</span><span class="delimiter">&quot;</span></span>, numLinesToSkip = <span class="integer">1</span>)
<span class="type">void</span> testWithCsvFileSource(<span class="predefined-type">String</span> first, <span class="type">int</span> second) {
    assertNotNull(first);
    assertNotEquals(<span class="integer">0</span>, second);
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">two-column.csv</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="csv">Country, reference
Sweden, 1
Poland, 2
&quot;United States of America&quot;, 3</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<code>@CsvSource</code> のシンタックスとは異なり、<code>@CsvFileSource</code> はダブルクォート <code>"</code>
を引用符として使います。上の例の、<code>"United States of America"</code> を参考にしてください。
引用符で囲まれた空の値 <code>""</code> は空の <code>String</code> になりますが、
（引用符で囲まれない）完全に <em>空</em> の値は <code>null</code> と解釈されます。
<code>null</code> の代入先の型がプリミティブ型の場合は、
<code>ArgumentConversionException</code> が発生します。
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="writing-tests-parameterized-tests-sources-ArgumentsSource"><a class="anchor" href="#writing-tests-parameterized-tests-sources-ArgumentsSource"></a>@ArgumentsSource</h5>
<div class="paragraph">
<p><code>@ArgumentsSource</code> は、カスタムの再利用可能な <code>ArgumentsProvider</code>
を指定する場合に使えます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@ParameterizedTest</span>
<span class="annotation">@ArgumentsSource</span>(MyArgumentsProvider.class)
<span class="type">void</span> testWithArgumentsSource(<span class="predefined-type">String</span> argument) {
    assertNotNull(argument);
}

<span class="directive">public</span> <span class="type">class</span> <span class="class">MyArgumentsProvider</span> <span class="directive">implements</span> ArgumentsProvider {

    <span class="annotation">@Override</span>
    <span class="directive">public</span> Stream&lt;? <span class="directive">extends</span> Arguments&gt; provideArguments(ExtensionContext context) {
        <span class="keyword">return</span> Stream.of(<span class="string"><span class="delimiter">&quot;</span><span class="content">foo</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">bar</span><span class="delimiter">&quot;</span></span>).map(Arguments::of);
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="writing-tests-parameterized-tests-argument-conversion"><a class="anchor" href="#writing-tests-parameterized-tests-argument-conversion"></a>3.15.2. パラメーターの変換</h4>
<div class="sect4">
<h5 id="writing-tests-parameterized-tests-argument-conversion-widening"><a class="anchor" href="#writing-tests-parameterized-tests-argument-conversion-widening"></a>拡大変換</h5>
<div class="paragraph">
<p>JUnit Jupiterは、<code>@ParameterizedTest</code> に与えられたパラメーターに対して、
<a href="https://docs.oracle.com/javase/specs/jls/se8/html/jls-5.html#jls-5.1.2">プリミティブ型の
拡大変換</a> をサポートしています。例えば、<code>@ValueSource(ints = { 1, 2, 3 })</code>
アノテーションが付与されたパラメーター化テストでは、テストメソッドの仮引数を
<code>int</code> 型だけでなく <code>long</code> や <code>float</code>、<code>double</code> 型でも宣言することができます。</p>
</div>
</div>
<div class="sect4">
<h5 id="writing-tests-parameterized-tests-argument-conversion-implicit"><a class="anchor" href="#writing-tests-parameterized-tests-argument-conversion-implicit"></a>暗黙的な変換</h5>
<div class="paragraph">
<p><code>@CsvSource</code> のようなユースケースをサポートするために、JUnit Jupiter
は多くの組み込みの型変換を提供しています。
変換処理は、メソッドの仮引数の型に依存します。</p>
</div>
<div class="paragraph">
<p>例えば、<code>@ParameterizedTest</code> が <code>TimeUnit</code> 型の仮引数を宣言し、
ソースから実際に渡される型が <code>String</code> の場合、その文字列は対応する
<code>TimeUnit</code> 列挙定数に自動的に変換されます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@ParameterizedTest</span>
<span class="annotation">@ValueSource</span>(strings = <span class="string"><span class="delimiter">&quot;</span><span class="content">SECONDS</span><span class="delimiter">&quot;</span></span>)
<span class="type">void</span> testWithImplicitArgumentConversion(<span class="predefined-type">TimeUnit</span> argument) {
    assertNotNull(argument.name());
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>String</code> インスタンスは、今のところ次のようなターゲット型に暗黙的に変換されます。</p>
</div>
<table id="writing-tests-parameterized-tests-argument-conversion-implicit-table" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 10%;">
<col style="width: 90%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Target Type</th>
<th class="tableblock halign-left valign-top">Example</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>boolean</code>/<code>Boolean</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"true"</code>                                 &#8594; <code>true</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>byte</code>/<code>Byte</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"1"</code>                                    &#8594; <code>(byte) 1</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>char</code>/<code>Character</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"o"</code>                                    &#8594; <code>'o'</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>short</code>/<code>Short</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"1"</code>                                    &#8594; <code>(short) 1</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>int</code>/<code>Integer</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"1"</code>                                    &#8594; <code>1</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>long</code>/<code>Long</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"1"</code>                                    &#8594; <code>1L</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>float</code>/<code>Float</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"1.0"</code>                                  &#8594; <code>1.0f</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>double</code>/<code>Double</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"1.0"</code>                                  &#8594; <code>1.0d</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Enum</code> subclass</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"SECONDS"</code>                              &#8594; <code>TimeUnit.SECONDS</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java.io.File</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"/path/to/file"</code>                        &#8594; <code>new File("/path/to/file")</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java.math.BigDecimal</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"123.456e789"</code>                          &#8594; <code>new BigDecimal("123.456e789")</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java.math.BigInteger</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"1234567890123456789"</code>                  &#8594; <code>new BigInteger("1234567890123456789")</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java.net.URI</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"http://junit.org/"</code>                    &#8594; <code>URI.create("http://junit.org/")</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java.net.URL</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"http://junit.org/"</code>                    &#8594; <code>new URL("http://junit.org/")</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java.nio.charset.Charset</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"UTF-8"</code>                                &#8594; <code>Charset.forName("UTF-8")</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java.nio.file.Path</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"/path/to/file"</code>                        &#8594; <code>Paths.get("/path/to/file")</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java.time.Instant</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"1970-01-01T00:00:00Z"</code>                 &#8594; <code>Instant.ofEpochMilli(0)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java.time.LocalDateTime</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"2017-03-14T12:34:56.789"</code>              &#8594; <code>LocalDateTime.of(2017, 3, 14, 12, 34, 56, 789_000_000)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java.time.LocalDate</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"2017-03-14"</code>                           &#8594; <code>LocalDate.of(2017, 3, 14)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java.time.LocalTime</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"12:34:56.789"</code>                         &#8594; <code>LocalTime.of(12, 34, 56, 789_000_000)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java.time.OffsetDateTime</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"2017-03-14T12:34:56.789Z"</code>             &#8594; <code>OffsetDateTime.of(2017, 3, 14, 12, 34, 56, 789_000_000, ZoneOffset.UTC)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java.time.OffsetTime</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"12:34:56.789Z"</code>                        &#8594; <code>OffsetTime.of(12, 34, 56, 789_000_000, ZoneOffset.UTC)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java.time.YearMonth</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"2017-03"</code>                              &#8594; <code>YearMonth.of(2017, 3)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java.time.Year</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"2017"</code>                                 &#8594; <code>Year.of(2017)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java.time.ZonedDateTime</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"2017-03-14T12:34:56.789Z"</code>             &#8594; <code>ZonedDateTime.of(2017, 3, 14, 12, 34, 56, 789_000_000, ZoneOffset.UTC)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java.util.Currency</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"JPY"</code>                                  &#8594; <code>Currency.getInstance("JPY")</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java.util.Locale</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"en"</code>                                   &#8594; <code>new Locale("en")</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java.util.UUID</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"d043e930-7b3b-48e3-bdbe-5a3ccfb833db"</code> &#8594; <code>UUID.fromString("d043e930-7b3b-48e3-bdbe-5a3ccfb833db")</code></p></td>
</tr>
</tbody>
</table>
<div class="sect5">
<h6 id="writing-tests-parameterized-tests-argument-conversion-implicit-fallback"><a class="anchor" href="#writing-tests-parameterized-tests-argument-conversion-implicit-fallback"></a>String → Object変換のフォールバック</h6>
<div class="paragraph">
<p>上の表で示した文字列からターゲット型への暗黙的な変換に加えて、JUnit Jupiter
は <code>String</code> 型からターゲット型に自動変換するフォールバックの仕組みも提供しています。
この変換は、ターゲット型が以下に示す <em>ファクトリメソッド</em> か <em>ファクトリコンストラクタ</em>
を1つだけ宣言している場合に機能します。</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>ファクトリメソッド</em>: ターゲット型に宣言された非privateの <code>static</code> メソッドで、
<code>String</code> 型の引数を1つだけ受け取ってターゲット型のインスタンスを返す。
メソッドの名前は任意であり、特定のルールに従う必要はない。</p>
</li>
<li>
<p><em>ファクトリコンストラクタ</em>: ターゲット型に宣言された非privateのコンストラクタで、
<code>String</code> 型の引数を1つだけ受け取ってインスタンスを作る。</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
複数の <em>ファクトリメソッド</em> が見つかった場合、それらは無視されます。
<em>ファクトリメソッド</em> と <em>ファクトリコンストラクタ</em> が両方見つかった場合は、
ファクトリメソッドの方が使われます。
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>例えば、次の <code>@ParameterizedTest</code> メソッドでは、<code>Book</code> 型の引数は
<code>Book.fromTitle(String)</code> ファクトリメソッドに本のタイトルとして <code>"42 Cats"</code>
を渡して実行することで作られます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@ParameterizedTest</span>
<span class="annotation">@ValueSource</span>(strings = <span class="string"><span class="delimiter">&quot;</span><span class="content">42 Cats</span><span class="delimiter">&quot;</span></span>)
<span class="type">void</span> testWithImplicitFallbackArgumentConversion(<span class="predefined-type">Book</span> book) {
    assertEquals(<span class="string"><span class="delimiter">&quot;</span><span class="content">42 Cats</span><span class="delimiter">&quot;</span></span>, book.getTitle());
}

<span class="directive">public</span> <span class="type">class</span> <span class="class">Book</span> {

    <span class="directive">private</span> <span class="directive">final</span> <span class="predefined-type">String</span> title;

    <span class="directive">private</span> <span class="predefined-type">Book</span>(<span class="predefined-type">String</span> title) {
        <span class="local-variable">this</span>.title = title;
    }

    <span class="directive">public</span> <span class="directive">static</span> <span class="predefined-type">Book</span> fromTitle(<span class="predefined-type">String</span> title) {
        <span class="keyword">return</span> <span class="keyword">new</span> <span class="predefined-type">Book</span>(title);
    }

    <span class="directive">public</span> <span class="predefined-type">String</span> getTitle() {
        <span class="keyword">return</span> <span class="local-variable">this</span>.title;
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="writing-tests-parameterized-tests-argument-conversion-explicit"><a class="anchor" href="#writing-tests-parameterized-tests-argument-conversion-explicit"></a>明示的な変換</h5>
<div class="paragraph">
<p>暗黙的な変換を使う代わりに、<code>@ConvertWith</code> アノテーションで
仮引数の変換に使う <code>ArgumentConverter</code> を明示的に指定することもできます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@ParameterizedTest</span>
<span class="annotation">@EnumSource</span>(<span class="predefined-type">TimeUnit</span>.class)
<span class="type">void</span> testWithExplicitArgumentConversion(
        <span class="annotation">@ConvertWith</span>(ToStringArgumentConverter.class) <span class="predefined-type">String</span> argument) {

    assertNotNull(<span class="predefined-type">TimeUnit</span>.valueOf(argument));
}

<span class="directive">public</span> <span class="type">class</span> <span class="class">ToStringArgumentConverter</span> <span class="directive">extends</span> SimpleArgumentConverter {

    <span class="annotation">@Override</span>
    <span class="directive">protected</span> <span class="predefined-type">Object</span> convert(<span class="predefined-type">Object</span> source, <span class="predefined-type">Class</span>&lt;?&gt; targetType) {
        assertEquals(<span class="predefined-type">String</span>.class, targetType, <span class="string"><span class="delimiter">&quot;</span><span class="content">Can only convert to String</span><span class="delimiter">&quot;</span></span>);
        <span class="keyword">return</span> <span class="predefined-type">String</span>.valueOf(source);
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>明示的な型変換器はテストまたは拡張機能の作者に実装されることを想定しています。
そのため、<code>junit-jupiter-params</code> モジュールは参照実装として <code>JavaTimeArgumentConverter</code>
の1つだけしか提供していません。これは、合成アノテーション <code>JavaTimeConversionPattern</code>
経由で使用できます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@ParameterizedTest</span>
<span class="annotation">@ValueSource</span>(strings = { <span class="string"><span class="delimiter">&quot;</span><span class="content">01.01.2017</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">31.12.2017</span><span class="delimiter">&quot;</span></span> })
<span class="type">void</span> testWithExplicitJavaTimeConverter(
        <span class="annotation">@JavaTimeConversionPattern</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">dd.MM.yyyy</span><span class="delimiter">&quot;</span></span>) LocalDate argument) {

    assertEquals(<span class="integer">2017</span>, argument.getYear());
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="writing-tests-parameterized-tests-argument-aggregation"><a class="anchor" href="#writing-tests-parameterized-tests-argument-aggregation"></a>3.15.3. パラメーターの集約</h4>
<div class="paragraph">
<p>デフォルトでは、<code>@ParameterizedTest</code> のメソッドに与えられる各パラメーター
は、1つの仮引数に対応します。結果として、ソースが多数のパラメーターを生成する場合、
メソッドシグネチャが大きく（仮引数が多く）なります。</p>
</div>
<div class="paragraph">
<p>そのような場合には、複数の仮引数を定義する代わりに <code><a href="https://junit.org/junit5/docs/5.2.0/api/org/junit/jupiter/params/aggregator/ArgumentsAccessor.html">ArgumentsAccessor</a></code>
を使うことができます。このAPIを使うと、テストメソッドに渡した単一の
<code><a href="https://junit.org/junit5/docs/5.2.0/api/org/junit/jupiter/params/aggregator/ArgumentsAccessor.html">ArgumentsAccessor</a></code> 経由ですべてのパラメーターにアクセスすることができます。
加えて、
<a href="#writing-tests-parameterized-tests-argument-conversion-implicit">暗黙的な変換</a>
で説明した型変換もサポートされます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@ParameterizedTest</span>
<span class="annotation">@CsvSource</span>({
    <span class="string"><span class="delimiter">&quot;</span><span class="content">Jane, Doe, F, 1990-05-20</span><span class="delimiter">&quot;</span></span>,
    <span class="string"><span class="delimiter">&quot;</span><span class="content">John, Doe, M, 1990-10-22</span><span class="delimiter">&quot;</span></span>
})
<span class="type">void</span> testWithArgumentsAccessor(ArgumentsAccessor arguments) {
    Person person = <span class="keyword">new</span> Person(arguments.getString(<span class="integer">0</span>),
                               arguments.getString(<span class="integer">1</span>),
                               arguments.get(<span class="integer">2</span>, Gender.class),
                               arguments.get(<span class="integer">3</span>, LocalDate.class));

    <span class="keyword">if</span> (person.getFirstName().equals(<span class="string"><span class="delimiter">&quot;</span><span class="content">Jane</span><span class="delimiter">&quot;</span></span>)) {
        assertEquals(Gender.F, person.getGender());
    }
    <span class="keyword">else</span> {
        assertEquals(Gender.M, person.getGender());
    }
    assertEquals(<span class="string"><span class="delimiter">&quot;</span><span class="content">Doe</span><span class="delimiter">&quot;</span></span>, person.getLastName());
    assertEquals(<span class="integer">1990</span>, person.getDateOfBirth().getYear());
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>ArgumentsAccessor</code> 型の仮引数には、自動的に <code>ArgumentsAccessor</code> のインスタンスが注入されます。</p>
</div>
<div class="sect4">
<h5 id="writing-tests-parameterized-tests-argument-aggregation-custom"><a class="anchor" href="#writing-tests-parameterized-tests-argument-aggregation-custom"></a>カスタムアグリゲーター</h5>
<div class="paragraph">
<p><code>ArgumentsAccessor</code> を使って <code>@ParameterizedTest</code> メソッドのパラメーターに
直接アクセスする以外に、JUnit Jupiterはカスタムの再利用可能な
<em>アグリゲーター (aggregator)</em> もサポートしています。</p>
</div>
<div class="paragraph">
<p>カスタムアグリゲーターを使うには、<code><a href="https://junit.org/junit5/docs/5.2.0/api/org/junit/jupiter/params/aggregator/ArgumentsAggregator.html">ArgumentsAggregator</a></code> インターフェースを実装し、
<code>@ParameterizedTest</code> メソッドの仮引数に <code>@AggregateWith</code>
アノテーションを使って登録します。集約した結果は、
パラメーター化テストが実行されるときに
対象の仮引数に対する実引数として渡されます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@ParameterizedTest</span>
<span class="annotation">@CsvSource</span>({
    <span class="string"><span class="delimiter">&quot;</span><span class="content">Jane, Doe, F, 1990-05-20</span><span class="delimiter">&quot;</span></span>,
    <span class="string"><span class="delimiter">&quot;</span><span class="content">John, Doe, M, 1990-10-22</span><span class="delimiter">&quot;</span></span>
})
<span class="type">void</span> testWithArgumentsAggregator(<span class="annotation">@AggregateWith</span>(PersonAggregator.class) Person person) {
    <span class="comment">// perform assertions against person</span>
}

<span class="directive">public</span> <span class="type">class</span> <span class="class">PersonAggregator</span> <span class="directive">implements</span> ArgumentsAggregator {
    <span class="annotation">@Override</span>
    <span class="directive">public</span> Person aggregateArguments(ArgumentsAccessor arguments, ParameterContext context) {
        <span class="keyword">return</span> <span class="keyword">new</span> Person(arguments.getString(<span class="integer">0</span>),
                          arguments.getString(<span class="integer">1</span>),
                          arguments.get(<span class="integer">2</span>, Gender.class),
                          arguments.get(<span class="integer">3</span>, LocalDate.class));
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>複数のパラメーター化テストメソッドに対して何回も <code>@AggregateWith(MyTypeAggregator.class)</code>
を宣言していることに気付いたら、<code>@AggregateWith(MyTypeAggregator.class)</code>
をメタアノテーションとして付与した <code>@CsvToMyType</code> のようなカスタム <em>合成アノテーション</em>
を作りたくなるでしょう。
次の例は、実際にカスタムの <code>@CsvToPerson</code> アノテーションを作る例を示しています。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@ParameterizedTest</span>
<span class="annotation">@CsvSource</span>({
    <span class="string"><span class="delimiter">&quot;</span><span class="content">Jane, Doe, F, 1990-05-20</span><span class="delimiter">&quot;</span></span>,
    <span class="string"><span class="delimiter">&quot;</span><span class="content">John, Doe, M, 1990-10-22</span><span class="delimiter">&quot;</span></span>
})
<span class="type">void</span> testWithCustomAggregatorAnnotation(<span class="annotation">@CsvToPerson</span> Person person) {
    <span class="comment">// perform assertions against person</span>
}

<span class="annotation">@Retention</span>(<span class="predefined-type">RetentionPolicy</span>.RUNTIME)
<span class="annotation">@Target</span>(<span class="predefined-type">ElementType</span>.PARAMETER)
<span class="annotation">@AggregateWith</span>(PersonAggregator.class)
<span class="directive">public</span> <span class="annotation">@interface</span> CsvToPerson {
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="writing-tests-parameterized-tests-display-names"><a class="anchor" href="#writing-tests-parameterized-tests-display-names"></a>3.15.4. 表示名のカスタマイズ</h4>
<div class="paragraph">
<p>デフォルトでは、パラメーター化テストの表示名には、呼び出しインデックスとすべてのパラメーターの
<code>String</code> 表現が含まれます。ただし、<code>@ParameterizedTest</code> アノテーションの <code>name</code>
属性を指定すれば、次の例のようにカスタマイズすることもできます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@DisplayName</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">Display name of container</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@ParameterizedTest</span>(name = <span class="string"><span class="delimiter">&quot;</span><span class="content">{index} ==&gt; first=''{0}'', second={1}</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@CsvSource</span>({ <span class="string"><span class="delimiter">&quot;</span><span class="content">foo, 1</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">bar, 2</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">'baz, qux', 3</span><span class="delimiter">&quot;</span></span> })
<span class="type">void</span> testWithCustomDisplayNames(<span class="predefined-type">String</span> first, <span class="type">int</span> second) {
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>上のメソッドを <code>ConsoleLauncher</code> で実行すると、以下のような出力となります。</p>
</div>
<div class="literalblock">
<div class="content">
<pre>Display name of container ✔
├─ 1 ==&gt; first='foo', second=1 ✔
├─ 2 ==&gt; first='bar', second=2 ✔
└─ 3 ==&gt; first='baz, qux', second=3 ✔</pre>
</div>
</div>
<div class="paragraph">
<p>次のプレースホルダーがサポートされています。</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Placeholder</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>{index}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">現在の呼び出しインデックス（1始まり）</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>{arguments}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">カンマ区切りの完全なパラメーターのリスト</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>{0}</code>, <code>{1}</code>, &#8230;&#8203;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">個々のパラメーター</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="writing-tests-parameterized-tests-lifecycle-interop"><a class="anchor" href="#writing-tests-parameterized-tests-lifecycle-interop"></a>3.15.5. ライフサイクルと相互運用性</h4>
<div class="paragraph">
<p>パラメーター化テストの各呼び出しは、通常の <code>@Test</code> メソッドと同じライフサイクルをもちます。
例えば、<code>@BeforeEach</code> メソッドが各呼び出しの前に実行されます。
<a href="#writing-tests-dynamic-tests">動的テスト</a> と同様に、パラメーター化テストの各呼び出しは、
IDEのテストツリーの中に1つずつ表示されます。同じテストクラスの中で、
<code>@Test</code> メソッドと <code>@ParameterizedTest</code> メソッドを混在させるのも自由です。</p>
</div>
<div class="paragraph">
<p><code>ParameterResolver</code> 拡張を <code>@ParameterizedTest</code> メソッドと使いたいかもしれません。
その場合は、パラメーターのソースから渡される引数を先に宣言する必要があります。
テストクラスは、パラメーター化テストだけでなく通常のテストを含んでいる可能性もあるので、
パラメーターをライフサイクルメソッド (例えば、<code>@BeforeEach</code>)
やテストコンストラクタに渡すことができません。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@BeforeEach</span>
<span class="type">void</span> beforeEach(TestInfo testInfo) {
    <span class="comment">// ...</span>
}

<span class="annotation">@ParameterizedTest</span>
<span class="annotation">@ValueSource</span>(strings = <span class="string"><span class="delimiter">&quot;</span><span class="content">foo</span><span class="delimiter">&quot;</span></span>)
<span class="type">void</span> testWithRegularParameterResolver(<span class="predefined-type">String</span> argument, TestReporter testReporter) {
    testReporter.publishEntry(<span class="string"><span class="delimiter">&quot;</span><span class="content">argument</span><span class="delimiter">&quot;</span></span>, argument);
}

<span class="annotation">@AfterEach</span>
<span class="type">void</span> afterEach(TestInfo testInfo) {
    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="writing-tests-test-templates"><a class="anchor" href="#writing-tests-test-templates"></a>3.16. テストテンプレート</h3>
<div class="paragraph">
<p><code><a href="https://junit.org/junit5/docs/5.2.0/api/org/junit/jupiter/api/TestTemplate.html">@TestTemplate</a></code> メソッドは、通常のテストケースではなく、テストケースのテンプレートです。
登録したプロバイダが返す実行コンテキストの数に応じて、複数回呼び出されるよう設計されています。
そのため、テストテンプレートは <code><a href="https://junit.org/junit5/docs/5.2.0/api/org/junit/jupiter/api/extension/TestTemplateInvocationContextProvider.html">TestTemplateInvocationContextProvider</a></code>
と一緒に使う必要があります。
テストテンプレートメソッドの各呼び出しは、ライフサイクルコールバックや拡張機能など、
通常の <code>@Test</code> メソッドの実行と同じように振る舞います。使用例については、
<a href="#extensions-test-templates">テストテンプレートに実行コンテキストを与える</a> を参照してください。</p>
</div>
</div>
<div class="sect2">
<h3 id="writing-tests-dynamic-tests"><a class="anchor" href="#writing-tests-dynamic-tests"></a>3.17. 動的テスト</h3>
<div class="paragraph">
<p><a href="#writing-tests-annotations">アノテーション</a> で説明したJUnit Jupiterの標準の <code>@Test</code>
アノテーションは、JUnit 4の <code>@Test</code> アノテーションととてもよく似ています。
どちらもテストケースを実装するメソッドを示します。これらのテストケースは、
完全にコンパイル時に指定され、その振る舞いが実行時には変えられないという意味で、
静的なものです。 <em>前提条件 (Assumption) の機能は、動的な振る舞いの基本を
提供しますが、表現力は意図的に限定されています。</em></p>
</div>
<div class="paragraph">
<p>JUnit Jupiterでは、これらの標準的なテストに加えて、完全に新しいプログラミング
モデルが導入されました。それは、<em>動的テスト</em> です。動的テストは、
<code>@TestFactory</code> アノテーションを付与したファクトリメソッドによって、
実行時に生成されます。</p>
</div>
<div class="paragraph">
<p><code>@Test</code> メソッドとは異なり、<code>@TestFactory</code> メソッド自身はテストケースではなく、
テストケースのファクトリとなります。ファクトリの出力が動的テストになります。
技術的に言うと、<code>@TestFactory</code> メソッドは、<code>DynamicNode</code> インスタンスの
<code>Stream</code>, <code>Collection</code>, <code>Iterable</code>, <code>Iterator</code> いずれかを
返さなければなりません。<code>DynamicNode</code> のインスタンス化可能なサブクラスには、
<code>DynamicContainer</code> と <code>DynamicTest</code> があります。<code>DynamicContainer</code>
インスタンスは、<em>表示名</em> と子どもの <code>DynamicNode</code> リストで構成され、
入れ子になった <code>DynamicNode</code> の階層を作成できるようになっています。
<code>DynamicTest</code> インスタンスが遅延実行されることで、動的かつ非決定的な
テストケースの生成を実現します。</p>
</div>
<div class="paragraph">
<p><code>@TestFactory</code> が返した <code>Stream</code> は、<code>stream.close()</code> 呼び出しによって
適切にクローズされます。これにより、<code>Files.lines()</code> などのリソースを
安全に使うことができます。</p>
</div>
<div class="paragraph">
<p><code>@Test</code> メソッドと同じように、<code>@TestFactory</code> メソッドも <code>private</code> または
<code>static</code> であってはいけません。また、<code>ParameterResolvers</code> で解決される
パラメーターを宣言することもできます。</p>
</div>
<div class="paragraph">
<p><code>DynamicTest</code> は、実行時に生成されるテストケースで、<em>表示名</em> と <code>Executable</code>
で構成されます。<code>Executable</code> は、<code>@FunctionalInterface</code> であり、
動的テストの実装が <em>ラムダ式</em> または <em>メソッド参照</em> で与えられることを意味します。</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="title">動的テストのライフサイクル</div>
動的テストの実行ライフサイクルは、通常の <code>@Test</code> とはかなり違います。
特に、個々の動的テストに対しては、ライフサイクルコールバックはありません。
これは、<code>@BeforeEach</code> や <code>@AfterEach</code> メソッドとその拡張コールバックが、
<code>@TestFactory</code> メソッドに対して実行され、個々の <em>動的テスト</em>
に対しては実行されないことを意味しています。言い換えれば、動的テストのラムダ式から
テストインスタンスのフィールドにアクセスしていたとしても、同じ <code>@TestFactory</code>
メソッドから生成された個々の動的テストを実行する間は、コールバックメソッドにも
拡張機能にもそのフィールドはリセットされないのです。
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>JUnit Jupiter 5.2.0 の時点では、動的テストは常にファクトリメソッドで
生成しなければなりません。ただし、将来のリリースで、登録の仕組みが追加されるかもしれません。</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
動的テストは現在 <em>実験中</em> の機能です。詳細は、
<a href="#api-evolution-experimental-apis">実験的なAPI</a> の表を参照してください。
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="writing-tests-dynamic-tests-examples"><a class="anchor" href="#writing-tests-dynamic-tests-examples"></a>3.17.1. 動的テストの例</h4>
<div class="paragraph">
<p>次の <code>DynamicTestsDemo</code> クラスは、テストファクトリと動的テストの例を示しています。</p>
</div>
<div class="paragraph">
<p>最初のメソッドは、不正な戻り値型を返しています。不正な戻り値型はコンパイル時には
検出できないため、実行時に検出されて <code>JUnitException</code> がスローされます。</p>
</div>
<div class="paragraph">
<p>その次の5つのメソッドは、<code>DynamicTest</code> インスタンスの <code>Collection</code>, <code>Iterable</code>,
<code>Iterator</code>, <code>Stream</code> を生成するとてもシンプルな例です。ほとんどの例は、
動的な振る舞いではなく、単にサポートされている戻り値の型をデモしています。
しかし、<code>dynamicTestsFromStream()</code> と <code>dynamicTestsFromIntStream()</code> は、
与えられた文字列リストや数値の範囲に対して簡単に動的なテストを生成できることを
示しています。</p>
</div>
<div class="paragraph">
<p>その次のメソッドは、真に動的な性質のものです。<code>generateRandomNumberOfTests()</code>
は、乱数を生成する <code>Iterator</code>、表示名の生成器、テストの実行器の3つを実装し、
これらを <code>DynamicTest.stream()</code> に渡しています。
<code>generateRandomNumberOfTests()</code> の非決定的な振る舞いは、
もちろんテストの再現性に反するため注意して使うべきですが、
動的テストの高い表現力とパワーを示すのに役立っています。</p>
</div>
<div class="paragraph">
<p>最後のメソッドは、<code>DynamicContainer</code> を使って動的テストを入れ子階層にする例を示しています。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">static</span> <span class="include">org.junit.jupiter.api.Assertions.assertEquals</span>;
<span class="keyword">import</span> <span class="include">static</span> <span class="include">org.junit.jupiter.api.Assertions.assertFalse</span>;
<span class="keyword">import</span> <span class="include">static</span> <span class="include">org.junit.jupiter.api.Assertions.assertNotNull</span>;
<span class="keyword">import</span> <span class="include">static</span> <span class="include">org.junit.jupiter.api.Assertions.assertTrue</span>;
<span class="keyword">import</span> <span class="include">static</span> <span class="include">org.junit.jupiter.api.DynamicContainer.dynamicContainer</span>;
<span class="keyword">import</span> <span class="include">static</span> <span class="include">org.junit.jupiter.api.DynamicTest.dynamicTest</span>;

<span class="keyword">import</span> <span class="include">java.util.Arrays</span>;
<span class="keyword">import</span> <span class="include">java.util.Collection</span>;
<span class="keyword">import</span> <span class="include">java.util.Iterator</span>;
<span class="keyword">import</span> <span class="include">java.util.List</span>;
<span class="keyword">import</span> <span class="include">java.util.Random</span>;
<span class="keyword">import</span> <span class="include">java.util.function.Function</span>;
<span class="keyword">import</span> <span class="include">java.util.stream.IntStream</span>;
<span class="keyword">import</span> <span class="include">java.util.stream.Stream</span>;

<span class="keyword">import</span> <span class="include">org.junit.jupiter.api.DynamicNode</span>;
<span class="keyword">import</span> <span class="include">org.junit.jupiter.api.DynamicTest</span>;
<span class="keyword">import</span> <span class="include">org.junit.jupiter.api.Tag</span>;
<span class="keyword">import</span> <span class="include">org.junit.jupiter.api.TestFactory</span>;
<span class="keyword">import</span> <span class="include">org.junit.jupiter.api.function.ThrowingConsumer</span>;

<span class="type">class</span> <span class="class">DynamicTestsDemo</span> {

    <span class="comment">// This will result in a JUnitException!</span>
    <span class="annotation">@TestFactory</span>
    <span class="predefined-type">List</span>&lt;<span class="predefined-type">String</span>&gt; dynamicTestsWithInvalidReturnType() {
        <span class="keyword">return</span> <span class="predefined-type">Arrays</span>.asList(<span class="string"><span class="delimiter">&quot;</span><span class="content">Hello</span><span class="delimiter">&quot;</span></span>);
    }

    <span class="annotation">@TestFactory</span>
    <span class="predefined-type">Collection</span>&lt;DynamicTest&gt; dynamicTestsFromCollection() {
        <span class="keyword">return</span> <span class="predefined-type">Arrays</span>.asList(
            dynamicTest(<span class="string"><span class="delimiter">&quot;</span><span class="content">1st dynamic test</span><span class="delimiter">&quot;</span></span>, () -&gt; assertTrue(<span class="predefined-constant">true</span>)),
            dynamicTest(<span class="string"><span class="delimiter">&quot;</span><span class="content">2nd dynamic test</span><span class="delimiter">&quot;</span></span>, () -&gt; assertEquals(<span class="integer">4</span>, <span class="integer">2</span> * <span class="integer">2</span>))
        );
    }

    <span class="annotation">@TestFactory</span>
    <span class="predefined-type">Iterable</span>&lt;DynamicTest&gt; dynamicTestsFromIterable() {
        <span class="keyword">return</span> <span class="predefined-type">Arrays</span>.asList(
            dynamicTest(<span class="string"><span class="delimiter">&quot;</span><span class="content">3rd dynamic test</span><span class="delimiter">&quot;</span></span>, () -&gt; assertTrue(<span class="predefined-constant">true</span>)),
            dynamicTest(<span class="string"><span class="delimiter">&quot;</span><span class="content">4th dynamic test</span><span class="delimiter">&quot;</span></span>, () -&gt; assertEquals(<span class="integer">4</span>, <span class="integer">2</span> * <span class="integer">2</span>))
        );
    }

    <span class="annotation">@TestFactory</span>
    <span class="predefined-type">Iterator</span>&lt;DynamicTest&gt; dynamicTestsFromIterator() {
        <span class="keyword">return</span> <span class="predefined-type">Arrays</span>.asList(
            dynamicTest(<span class="string"><span class="delimiter">&quot;</span><span class="content">5th dynamic test</span><span class="delimiter">&quot;</span></span>, () -&gt; assertTrue(<span class="predefined-constant">true</span>)),
            dynamicTest(<span class="string"><span class="delimiter">&quot;</span><span class="content">6th dynamic test</span><span class="delimiter">&quot;</span></span>, () -&gt; assertEquals(<span class="integer">4</span>, <span class="integer">2</span> * <span class="integer">2</span>))
        ).iterator();
    }

    <span class="annotation">@TestFactory</span>
    Stream&lt;DynamicTest&gt; dynamicTestsFromStream() {
        <span class="keyword">return</span> Stream.of(<span class="string"><span class="delimiter">&quot;</span><span class="content">A</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">B</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">C</span><span class="delimiter">&quot;</span></span>)
            .map(str -&gt; dynamicTest(<span class="string"><span class="delimiter">&quot;</span><span class="content">test</span><span class="delimiter">&quot;</span></span> + str, () -&gt; { <span class="comment">/* ... */</span> }));
    }

    <span class="annotation">@TestFactory</span>
    Stream&lt;DynamicTest&gt; dynamicTestsFromIntStream() {
        <span class="comment">// Generates tests for the first 10 even integers.</span>
        <span class="keyword">return</span> IntStream.iterate(<span class="integer">0</span>, n -&gt; n + <span class="integer">2</span>).limit(<span class="integer">10</span>)
            .mapToObj(n -&gt; dynamicTest(<span class="string"><span class="delimiter">&quot;</span><span class="content">test</span><span class="delimiter">&quot;</span></span> + n, () -&gt; assertTrue(n % <span class="integer">2</span> == <span class="integer">0</span>)));
    }

    <span class="annotation">@TestFactory</span>
    Stream&lt;DynamicTest&gt; generateRandomNumberOfTests() {

        <span class="comment">// Generates random positive integers between 0 and 100 until</span>
        <span class="comment">// a number evenly divisible by 7 is encountered.</span>
        <span class="predefined-type">Iterator</span>&lt;<span class="predefined-type">Integer</span>&gt; inputGenerator = <span class="keyword">new</span> <span class="predefined-type">Iterator</span>&lt;<span class="predefined-type">Integer</span>&gt;() {

            <span class="predefined-type">Random</span> random = <span class="keyword">new</span> <span class="predefined-type">Random</span>();
            <span class="type">int</span> current;

            <span class="annotation">@Override</span>
            <span class="directive">public</span> <span class="type">boolean</span> hasNext() {
                current = random.nextInt(<span class="integer">100</span>);
                <span class="keyword">return</span> current % <span class="integer">7</span> != <span class="integer">0</span>;
            }

            <span class="annotation">@Override</span>
            <span class="directive">public</span> <span class="predefined-type">Integer</span> next() {
                <span class="keyword">return</span> current;
            }
        };

        <span class="comment">// Generates display names like: input:5, input:37, input:85, etc.</span>
        Function&lt;<span class="predefined-type">Integer</span>, <span class="predefined-type">String</span>&gt; displayNameGenerator = (input) -&gt; <span class="string"><span class="delimiter">&quot;</span><span class="content">input:</span><span class="delimiter">&quot;</span></span> + input;

        <span class="comment">// Executes tests based on the current input value.</span>
        ThrowingConsumer&lt;<span class="predefined-type">Integer</span>&gt; testExecutor = (input) -&gt; assertTrue(input % <span class="integer">7</span> != <span class="integer">0</span>);

        <span class="comment">// Returns a stream of dynamic tests.</span>
        <span class="keyword">return</span> DynamicTest.stream(inputGenerator, displayNameGenerator, testExecutor);
    }

    <span class="annotation">@TestFactory</span>
    Stream&lt;DynamicNode&gt; dynamicTestsWithContainers() {
        <span class="keyword">return</span> Stream.of(<span class="string"><span class="delimiter">&quot;</span><span class="content">A</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">B</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">C</span><span class="delimiter">&quot;</span></span>)
            .map(input -&gt; dynamicContainer(<span class="string"><span class="delimiter">&quot;</span><span class="content">Container </span><span class="delimiter">&quot;</span></span> + input, Stream.of(
                dynamicTest(<span class="string"><span class="delimiter">&quot;</span><span class="content">not null</span><span class="delimiter">&quot;</span></span>, () -&gt; assertNotNull(input)),
                dynamicContainer(<span class="string"><span class="delimiter">&quot;</span><span class="content">properties</span><span class="delimiter">&quot;</span></span>, Stream.of(
                    dynamicTest(<span class="string"><span class="delimiter">&quot;</span><span class="content">length &gt; 0</span><span class="delimiter">&quot;</span></span>, () -&gt; assertTrue(input.length() &gt; <span class="integer">0</span>)),
                    dynamicTest(<span class="string"><span class="delimiter">&quot;</span><span class="content">not empty</span><span class="delimiter">&quot;</span></span>, () -&gt; assertFalse(input.isEmpty()))
                ))
            )));
    }

}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="running-tests"><a class="anchor" href="#running-tests"></a>4. テストを実行する</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="running-tests-ide"><a class="anchor" href="#running-tests-ide"></a>4.1. IDEのサポート</h3>
<div class="sect3">
<h4 id="running-tests-ide-intellij-idea"><a class="anchor" href="#running-tests-ide-intellij-idea"></a>4.1.1. IntelliJ IDEA</h4>
<div class="paragraph">
<p>IntelliJ IDEAは、バージョン2016.2からJUnit Platform上でのテスト実行をサポートしています。
詳細は、
<a href="https://blog.jetbrains.com/idea/2016/08/using-junit-5-in-intellij-idea/">IntelliJ IDEAブログの投稿</a>
を参照してください。ただし、実際にはIntelliJ IDEA 2017.3またはそれより新しいバージョンの
利用が推奨される点に注意してください。というのも、プロジェクトで利用されるAPIバージョンに応じて
<code>junit-platform-launcher</code>, <code>junit-jupiter-engine</code>, <code>junit-vintage-engine</code>
のJARを自動的にダウンロードしてくれるからです。</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
IntelliJ IDEAのバージョン2017.3より前のリリースは、JUnit 5
の特定のバージョンを同梱している点に注意してください。もしもJUnit Jupiter
の新しいバージョンを使いたい場合、IDE内でのテスト実行はバージョンのコンフリクトで
失敗する可能性があります。そのような場合は、IntelliJ IDEAに同梱されている
JUnit 5より新しいバージョンを使うために、以下の手順に従ってください。
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>JUnit 5の異なるバージョン (例えば、 5.2.0) を使うには、
<code>junit-platform-launcher</code>, <code>junit-jupiter-engine</code>, <code>junit-vintage-engine</code>
の対応するバージョンのJARをクラスパスに追加する必要があります。</p>
</div>
<div class="listingblock">
<div class="title">Gradleの追加の依存関係</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="comment">// Only needed to run tests in a version of IntelliJ IDEA that bundles older versions</span>
testRuntime(<span class="string"><span class="delimiter">&quot;</span><span class="content">org.junit.platform:junit-platform-launcher:1.2.0</span><span class="delimiter">&quot;</span></span>)
testRuntime(<span class="string"><span class="delimiter">&quot;</span><span class="content">org.junit.jupiter:junit-jupiter-engine:5.2.0</span><span class="delimiter">&quot;</span></span>)
testRuntime(<span class="string"><span class="delimiter">&quot;</span><span class="content">org.junit.vintage:junit-vintage-engine:5.2.0</span><span class="delimiter">&quot;</span></span>)</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Mavenの追加の依存関係</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="comment">&lt;!-- Only needed to run tests in a version of IntelliJ IDEA that bundles older versions --&gt;</span>
<span class="tag">&lt;dependency&gt;</span>
    <span class="tag">&lt;groupId&gt;</span>org.junit.platform<span class="tag">&lt;/groupId&gt;</span>
    <span class="tag">&lt;artifactId&gt;</span>junit-platform-launcher<span class="tag">&lt;/artifactId&gt;</span>
    <span class="tag">&lt;version&gt;</span>1.2.0<span class="tag">&lt;/version&gt;</span>
    <span class="tag">&lt;scope&gt;</span>test<span class="tag">&lt;/scope&gt;</span>
<span class="tag">&lt;/dependency&gt;</span>
<span class="tag">&lt;dependency&gt;</span>
    <span class="tag">&lt;groupId&gt;</span>org.junit.jupiter<span class="tag">&lt;/groupId&gt;</span>
    <span class="tag">&lt;artifactId&gt;</span>junit-jupiter-engine<span class="tag">&lt;/artifactId&gt;</span>
    <span class="tag">&lt;version&gt;</span>5.2.0<span class="tag">&lt;/version&gt;</span>
    <span class="tag">&lt;scope&gt;</span>test<span class="tag">&lt;/scope&gt;</span>
<span class="tag">&lt;/dependency&gt;</span>
<span class="tag">&lt;dependency&gt;</span>
    <span class="tag">&lt;groupId&gt;</span>org.junit.vintage<span class="tag">&lt;/groupId&gt;</span>
    <span class="tag">&lt;artifactId&gt;</span>junit-vintage-engine<span class="tag">&lt;/artifactId&gt;</span>
    <span class="tag">&lt;version&gt;</span>5.2.0<span class="tag">&lt;/version&gt;</span>
    <span class="tag">&lt;scope&gt;</span>test<span class="tag">&lt;/scope&gt;</span>
<span class="tag">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="running-tests-ide-eclipse"><a class="anchor" href="#running-tests-ide-eclipse"></a>4.1.2. Eclipse</h4>
<div class="paragraph">
<p>Eclipse IDEは、Oxygen.1a (4.7.1a)リリースからJUnit Platformをサポートしています。</p>
</div>
<div class="paragraph">
<p>EclipseでJUnit 5を使うための情報は、公式ドキュメント
<a href="https://www.eclipse.org/eclipse/news/4.7.1a/#junit-5-support">Eclipse Project Oxygen.1a
(4.7.1a) - New and Noteworthy</a> の <em>Eclipse support for JUnit 5</em> の節を参照してください。</p>
</div>
</div>
<div class="sect3">
<h4 id="running-tests-ide-other"><a class="anchor" href="#running-tests-ide-other"></a>4.1.3. その他のIDE</h4>
<div class="paragraph">
<p>本書執筆時点では、IntelliJ IDEAとEclipse以外のIDEは、JUnit Platform
上でのテスト実行を直接はサポートしていません。しかし、JUnitチームは
あなたが使っているIDEでJUnit 5を試せるように、2つの中間解を提供しています。
<a href="#running-tests-console-launcher">Console Launcher</a> を手動で使うか、
<a href="#running-tests-junit-platform-runner">JUnit 4ベースのランナー</a>
でテストを実行することができます。</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="running-tests-build"><a class="anchor" href="#running-tests-build"></a>4.2. ビルドサポート</h3>
<div class="sect3">
<h4 id="running-tests-build-gradle"><a class="anchor" href="#running-tests-build-gradle"></a>4.2.1. Gradle</h4>
<div class="paragraph">
<p>Gradleは <a href="https://docs.gradle.org/4.6/release-notes.html">バージョン4.6</a> から、
JUnit Platformでテストを実行するための機能を
<a href="https://docs.gradle.org/current/userguide/java_testing.html#using_junit5">ネイティブでサポート</a>
しています。有効にするには、<code>build.gradle</code> の <code>test</code> タスク宣言内で <code>useJUnitPlatform()</code>
を指定するだけです。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">test {
    useJUnitPlatform()
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>タグやテストエンジンによるフィルタリングもサポートしています。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">test {
    useJUnitPlatform {
        includeTags <span class="string"><span class="delimiter">'</span><span class="content">fast</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">smoke &amp; feature-a</span><span class="delimiter">'</span></span>
        <span class="comment">// excludeTags 'slow', 'ci'</span>
        includeEngines <span class="string"><span class="delimiter">'</span><span class="content">junit-jupiter</span><span class="delimiter">'</span></span>
        <span class="comment">// excludeEngines 'junit-vintage'</span>
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>使用できるオプションの一覧は、
<a href="https://docs.gradle.org/current/userguide/java_plugin.html#sec:java_test">Gradle公式ドキュメント</a>
を参照してください。</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="title">JUnit Platform Gradleプラグインは非推奨 (deprecated)</div>
<div class="paragraph">
<p>JUnitチームによって開発されていた <code>junit-platform-gradle-plugin</code> は、
JUnit Platform 1.2 から非推奨となり、1.3 で廃止されます。
Gradle標準の <code>test</code> タスクに移行してください。</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="running-tests-build-gradle-config-params"><a class="anchor" href="#running-tests-build-gradle-config-params"></a>設定パラメーター</h5>
<div class="paragraph">
<p>Gradle標準の <code>test</code> タスクは、テストの発見・実行に影響を与えるJUnit Platformの
<a href="#running-tests-config-params">設定パラメーター</a> を指定する専用DSL
を今のところ提供していません。
しかし、以下に示すようにビルドスクリプト内でシステムプロパティを使うか、
<code>junit-platform.properties</code> ファイルを使うことで、設定パラメーターを指定できます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">test {
    <span class="comment">// ...</span>
    systemProperty <span class="string"><span class="delimiter">'</span><span class="content">junit.jupiter.conditions.deactivate</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">*</span><span class="delimiter">'</span></span>
    systemProperties = [
        <span class="string"><span class="delimiter">'</span><span class="content">junit.jupiter.extensions.autodetection.enabled</span><span class="delimiter">'</span></span>: <span class="string"><span class="delimiter">'</span><span class="content">true</span><span class="delimiter">'</span></span>,
        <span class="string"><span class="delimiter">'</span><span class="content">junit.jupiter.testinstance.lifecycle.default</span><span class="delimiter">'</span></span>: <span class="string"><span class="delimiter">'</span><span class="content">per_class</span><span class="delimiter">'</span></span>
    ]
    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="running-tests-build-gradle-engines-configure"><a class="anchor" href="#running-tests-build-gradle-engines-configure"></a>テストエンジンを設定する</h5>
<div class="paragraph">
<p>テストを実行させるためには、<code>TestEngine</code> の実装がクラスパスに存在しなければなりません。</p>
</div>
<div class="paragraph">
<p>JUnit Jupiterベースのテストをサポートするためには、JUnit Jupiter API
に対する <code>testCompile</code> 依存と、JUnit Jupiter <code>TestEngine</code>
実装に対する <code>testRuntime</code> 依存を次のように指定する必要があります。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">dependencies {
    testCompile(<span class="string"><span class="delimiter">&quot;</span><span class="content">org.junit.jupiter:junit-jupiter-api:5.2.0</span><span class="delimiter">&quot;</span></span>)
    testRuntime(<span class="string"><span class="delimiter">&quot;</span><span class="content">org.junit.jupiter:junit-jupiter-engine:5.2.0</span><span class="delimiter">&quot;</span></span>)
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>JUnit Platformは、JUnit 4ベースのテストも実行することができます。
そのためには、JUnit 4に対する <code>testCompile</code> 依存と、JUnit Vintage
<code>TestEngine</code> 実装に対する <code>testRuntime</code> 依存が必要です。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">dependencies {
    testCompile(<span class="string"><span class="delimiter">&quot;</span><span class="content">junit:junit:4.12</span><span class="delimiter">&quot;</span></span>)
    testRuntime(<span class="string"><span class="delimiter">&quot;</span><span class="content">org.junit.vintage:junit-vintage-engine:5.2.0</span><span class="delimiter">&quot;</span></span>)
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="running-tests-build-gradle-logging"><a class="anchor" href="#running-tests-build-gradle-logging"></a>ロギングを設定する（省略可）</h5>
<div class="paragraph">
<p>JUnitは、<code>java.util.logging</code> パッケージ（別名、<em>JUL</em>）の Java Logging API
を警告やデバッグ情報の出力に利用しています。設定オプションについては、
<code><a href="https://docs.oracle.com/javase/8/docs/api/java/util/logging/LogManager.html">LogManager</a></code> の公式ドキュメントを参照してください。</p>
</div>
<div class="paragraph">
<p>ログを <a href="https://logging.apache.org/log4j/2.x/">Log4j</a> や <a href="https://logback.qos.ch/">Logback</a> のような他のロギングフレームワークにリダイレクトする
ことも可能です。<code><a href="https://docs.oracle.com/javase/8/docs/api/java/util/logging/LogManager.html">LogManager</a></code> のカスタム実装を提供するロギングフレームワークを
使う場合は、<code>java.util.logging.manager</code> システムプロパティに <code><a href="https://docs.oracle.com/javase/8/docs/api/java/util/logging/LogManager.html">LogManager</a></code>
実装クラスの <em>完全修飾名</em> を指定してください。以下は、Log4j&#160;2.x
（詳細は、 <a href="https://logging.apache.org/log4j/2.x/log4j-jul/index.html">Log4j JDK Logging Adapter</a> 参照）を設定する例です。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">test {
    systemProperty <span class="string"><span class="delimiter">'</span><span class="content">java.util.logging.manager</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">org.apache.logging.log4j.jul.LogManager</span><span class="delimiter">'</span></span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>その他のロギングフレームワークは、<code>java.util.logging</code> のログをリダイレクトする
方法が異なります。例えば <a href="https://logback.qos.ch/">Logback</a> では、
<a href="https://www.slf4j.org/legacy.html#jul-to-slf4j">JULからSLF4Jへのブリッジ</a>
を実行時のクラスパスに依存関係として追加して使います。</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="running-tests-build-maven"><a class="anchor" href="#running-tests-build-maven"></a>4.2.2. Maven</h4>
<div class="paragraph">
<p>JUnitチームは、<code>mvn test</code> でJUnit 4とJUnit Jupiterのテストを実行できる
Maven Surefireプロバイダを開発しています。 <code><a href="https://github.com/junit-team/junit5-samples/tree/master/junit5-jupiter-starter-maven">junit5-jupiter-starter-maven</a></code>
プロジェクトの <code>pom.xml</code> ファイルが使い方を示しています。</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<code>junit-platform-surefire-provider</code> とはMaven Surefire 2.21.0
を使ってください。
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml">...
<span class="tag">&lt;build&gt;</span>
    <span class="tag">&lt;plugins&gt;</span>
        ...
        <span class="tag">&lt;plugin&gt;</span>
            <span class="tag">&lt;artifactId&gt;</span>maven-surefire-plugin<span class="tag">&lt;/artifactId&gt;</span>
            <span class="tag">&lt;version&gt;</span>2.21.0<span class="tag">&lt;/version&gt;</span>
            <span class="tag">&lt;dependencies&gt;</span>
                <span class="tag">&lt;dependency&gt;</span>
                    <span class="tag">&lt;groupId&gt;</span>org.junit.platform<span class="tag">&lt;/groupId&gt;</span>
                    <span class="tag">&lt;artifactId&gt;</span>junit-platform-surefire-provider<span class="tag">&lt;/artifactId&gt;</span>
                    <span class="tag">&lt;version&gt;</span>1.2.0<span class="tag">&lt;/version&gt;</span>
                <span class="tag">&lt;/dependency&gt;</span>
            <span class="tag">&lt;/dependencies&gt;</span>
        <span class="tag">&lt;/plugin&gt;</span>
    <span class="tag">&lt;/plugins&gt;</span>
<span class="tag">&lt;/build&gt;</span>
...</code></pre>
</div>
</div>
<div class="sect4">
<h5 id="running-tests-build-maven-engines-configure"><a class="anchor" href="#running-tests-build-maven-engines-configure"></a>テストエンジンを設定する</h5>
<div class="paragraph">
<p>Maven Surefireにテストを実行させるためには、<code>TestEngine</code> の実装が
実行時のクラスパスに必要です。</p>
</div>
<div class="paragraph">
<p>JUnit Jupiterベースのテストをサポートするためには、JUnit Jupiter API
に対する <code>test</code> 依存と、JUnit Jupiter <code>TestEngine</code> 実装に対する
<code>maven-surefire-plugin</code> の依存を次のように指定する必要があります。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml">...
<span class="tag">&lt;build&gt;</span>
    <span class="tag">&lt;plugins&gt;</span>
        ...
        <span class="tag">&lt;plugin&gt;</span>
            <span class="tag">&lt;artifactId&gt;</span>maven-surefire-plugin<span class="tag">&lt;/artifactId&gt;</span>
            <span class="tag">&lt;version&gt;</span>2.21.0<span class="tag">&lt;/version&gt;</span>
            <span class="tag">&lt;dependencies&gt;</span>
                <span class="tag">&lt;dependency&gt;</span>
                    <span class="tag">&lt;groupId&gt;</span>org.junit.platform<span class="tag">&lt;/groupId&gt;</span>
                    <span class="tag">&lt;artifactId&gt;</span>junit-platform-surefire-provider<span class="tag">&lt;/artifactId&gt;</span>
                    <span class="tag">&lt;version&gt;</span>1.2.0<span class="tag">&lt;/version&gt;</span>
                <span class="tag">&lt;/dependency&gt;</span>
                <span class="tag">&lt;dependency&gt;</span>
                    <span class="tag">&lt;groupId&gt;</span>org.junit.jupiter<span class="tag">&lt;/groupId&gt;</span>
                    <span class="tag">&lt;artifactId&gt;</span>junit-jupiter-engine<span class="tag">&lt;/artifactId&gt;</span>
                    <span class="tag">&lt;version&gt;</span>5.2.0<span class="tag">&lt;/version&gt;</span>
                <span class="tag">&lt;/dependency&gt;</span>
            <span class="tag">&lt;/dependencies&gt;</span>
        <span class="tag">&lt;/plugin&gt;</span>
    <span class="tag">&lt;/plugins&gt;</span>
<span class="tag">&lt;/build&gt;</span>
...
<span class="tag">&lt;dependencies&gt;</span>
    ...
    <span class="tag">&lt;dependency&gt;</span>
        <span class="tag">&lt;groupId&gt;</span>org.junit.jupiter<span class="tag">&lt;/groupId&gt;</span>
        <span class="tag">&lt;artifactId&gt;</span>junit-jupiter-api<span class="tag">&lt;/artifactId&gt;</span>
        <span class="tag">&lt;version&gt;</span>5.2.0<span class="tag">&lt;/version&gt;</span>
        <span class="tag">&lt;scope&gt;</span>test<span class="tag">&lt;/scope&gt;</span>
    <span class="tag">&lt;/dependency&gt;</span>
<span class="tag">&lt;/dependencies&gt;</span>
...</code></pre>
</div>
</div>
<div class="paragraph">
<p>JUnit Platform Surefireプロバイダは、JUnit 4ベースのテストも実行することができます。
そのためには、JUnit 4に対する <code>test</code> 依存と、JUnit Vintage <code>TestEngine</code> 実装に対する
<code>maven-surefire-plugin</code> の依存が必要です。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml">...
<span class="tag">&lt;build&gt;</span>
    <span class="tag">&lt;plugins&gt;</span>
        ...
        <span class="tag">&lt;plugin&gt;</span>
            <span class="tag">&lt;artifactId&gt;</span>maven-surefire-plugin<span class="tag">&lt;/artifactId&gt;</span>
            <span class="tag">&lt;version&gt;</span>2.21.0<span class="tag">&lt;/version&gt;</span>
            <span class="tag">&lt;dependencies&gt;</span>
                <span class="tag">&lt;dependency&gt;</span>
                    <span class="tag">&lt;groupId&gt;</span>org.junit.platform<span class="tag">&lt;/groupId&gt;</span>
                    <span class="tag">&lt;artifactId&gt;</span>junit-platform-surefire-provider<span class="tag">&lt;/artifactId&gt;</span>
                    <span class="tag">&lt;version&gt;</span>1.2.0<span class="tag">&lt;/version&gt;</span>
                <span class="tag">&lt;/dependency&gt;</span>
                ...
                <span class="tag">&lt;dependency&gt;</span>
                    <span class="tag">&lt;groupId&gt;</span>org.junit.vintage<span class="tag">&lt;/groupId&gt;</span>
                    <span class="tag">&lt;artifactId&gt;</span>junit-vintage-engine<span class="tag">&lt;/artifactId&gt;</span>
                    <span class="tag">&lt;version&gt;</span>5.2.0<span class="tag">&lt;/version&gt;</span>
                <span class="tag">&lt;/dependency&gt;</span>
            <span class="tag">&lt;/dependencies&gt;</span>
        <span class="tag">&lt;/plugin&gt;</span>
    <span class="tag">&lt;/plugins&gt;</span>
<span class="tag">&lt;/build&gt;</span>
...
<span class="tag">&lt;dependencies&gt;</span>
    ...
    <span class="tag">&lt;dependency&gt;</span>
        <span class="tag">&lt;groupId&gt;</span>junit<span class="tag">&lt;/groupId&gt;</span>
        <span class="tag">&lt;artifactId&gt;</span>junit<span class="tag">&lt;/artifactId&gt;</span>
        <span class="tag">&lt;version&gt;</span>4.12<span class="tag">&lt;/version&gt;</span>
        <span class="tag">&lt;scope&gt;</span>test<span class="tag">&lt;/scope&gt;</span>
    <span class="tag">&lt;/dependency&gt;</span>
<span class="tag">&lt;/dependencies&gt;</span>
...</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="running-tests-build-maven-test-system-property"><a class="anchor" href="#running-tests-build-maven-test-system-property"></a>単一のテストクラスを実行する</h5>
<div class="paragraph">
<p>JUnit Platform Surefireプロバイダは、Maven Surefireプラグインがサポートする
JVMシステムプロパティ <code>test</code> に対応しています。例えば、コマンドラインから
<code>mvn -Dtest=org.example.MyTest test</code> を実行することで、テストクラス
<code>org.example.MyTest</code> のテストメソッドだけを実行できます。詳細は、
<a href="https://maven.apache.org/surefire/maven-surefire-plugin/examples/single-test.html">Maven Surefireプラグイン</a>
のドキュメントを参照してください。</p>
</div>
</div>
<div class="sect4">
<h5 id="running-tests-build-maven-filter-test-class-names"><a class="anchor" href="#running-tests-build-maven-filter-test-class-names"></a>テストクラス名でフィルタリングする</h5>
<div class="paragraph">
<p>Maven Surefireプラグインは、完全修飾名が次のパターンにマッチするテストクラスを探します。</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>**/Test*.java</code></p>
</li>
<li>
<p><code>**/*Test.java</code></p>
</li>
<li>
<p><code>**/*Tests.java</code></p>
</li>
<li>
<p><code>**/*TestCase.java</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>なお、すべてのネストクラス（staticな内部クラスも含む）はデフォルトで除外されます。</p>
</div>
<div class="paragraph">
<p>ただし、<code>pom.xml</code> ファイルの <code>include</code> および <code>exclude</code>
ルールを明示的に設定することで、デフォルトの動作を変更することもできます。
例えば、Maven Surefireがstaticな内部クラスを除外しないようにするなどです。</p>
</div>
<div class="listingblock">
<div class="title">Maven Surefireのexcludeルールを上書きする</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml">...
<span class="tag">&lt;build&gt;</span>
    <span class="tag">&lt;plugins&gt;</span>
        ...
        <span class="tag">&lt;plugin&gt;</span>
            <span class="tag">&lt;artifactId&gt;</span>maven-surefire-plugin<span class="tag">&lt;/artifactId&gt;</span>
            <span class="tag">&lt;version&gt;</span>2.21.0<span class="tag">&lt;/version&gt;</span>
            <span class="tag">&lt;configuration&gt;</span>
                <span class="tag">&lt;excludes&gt;</span>
                    <span class="tag">&lt;exclude</span><span class="tag">/&gt;</span>
                <span class="tag">&lt;/excludes&gt;</span>
            <span class="tag">&lt;/configuration&gt;</span>
            ...
        <span class="tag">&lt;/plugin&gt;</span>
    <span class="tag">&lt;/plugins&gt;</span>
<span class="tag">&lt;/build&gt;</span>
...</code></pre>
</div>
</div>
<div class="paragraph">
<p>詳細は、 Maven Surefireのドキュメント
<a href="https://maven.apache.org/surefire/maven-surefire-plugin/examples/inclusion-exclusion.html">Inclusions and Exclusions of Tests</a>
を参照してください。</p>
</div>
</div>
<div class="sect4">
<h5 id="running-tests-build-maven-filter-tags"><a class="anchor" href="#running-tests-build-maven-filter-tags"></a>タグでフィルタリングする</h5>
<div class="paragraph">
<p>次のように、タグまたは <a href="#running-tests-tag-expressions">タグ式</a>
を使ってテストをフィルタリングすることもできます。</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>タグ</em> または <em>タグ式</em> をテスト対象に含めるには、<code>groups</code> または <code>includeTags</code> を指定します。</p>
</li>
<li>
<p><em>タグ</em> または <em>タグ式</em> をテスト対象から除外するには、<code>excludedGroups</code> または <code>excludeTags</code> を指定します。</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml">...
<span class="tag">&lt;build&gt;</span>
    <span class="tag">&lt;plugins&gt;</span>
        ...
        <span class="tag">&lt;plugin&gt;</span>
            <span class="tag">&lt;artifactId&gt;</span>maven-surefire-plugin<span class="tag">&lt;/artifactId&gt;</span>
            <span class="tag">&lt;version&gt;</span>2.21.0<span class="tag">&lt;/version&gt;</span>
            <span class="tag">&lt;configuration&gt;</span>
                <span class="tag">&lt;properties&gt;</span>
                    <span class="tag">&lt;includeTags&gt;</span>acceptance | !feature-a<span class="tag">&lt;/includeTags&gt;</span>
                    <span class="tag">&lt;excludeTags&gt;</span>integration, regression<span class="tag">&lt;/excludeTags&gt;</span>
                <span class="tag">&lt;/properties&gt;</span>
            <span class="tag">&lt;/configuration&gt;</span>
            <span class="tag">&lt;dependencies&gt;</span>
                ...
            <span class="tag">&lt;/dependencies&gt;</span>
        <span class="tag">&lt;/plugin&gt;</span>
    <span class="tag">&lt;/plugins&gt;</span>
<span class="tag">&lt;/build&gt;</span>
...</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="running-tests-build-maven-config-params"><a class="anchor" href="#running-tests-build-maven-config-params"></a>設定パラメーター</h5>
<div class="paragraph">
<p><code>configurationParameters</code> プロパティにJavaの <code>Properties</code> ファイル形式の
キー・値のペアを与えるか、<code>junit-platform.properties</code> ファイルを与えることで、
テストの発見・実行に影響を与えるJUnit Platformの
<a href="#running-tests-config-params">設定パラメーター</a> を指定できます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml">...
<span class="tag">&lt;build&gt;</span>
    <span class="tag">&lt;plugins&gt;</span>
        ...
        <span class="tag">&lt;plugin&gt;</span>
            <span class="tag">&lt;artifactId&gt;</span>maven-surefire-plugin<span class="tag">&lt;/artifactId&gt;</span>
            <span class="tag">&lt;version&gt;</span>2.21.0<span class="tag">&lt;/version&gt;</span>
            <span class="tag">&lt;configuration&gt;</span>
                <span class="tag">&lt;properties&gt;</span>
                    <span class="tag">&lt;configurationParameters&gt;</span>
                        junit.jupiter.conditions.deactivate = *
                        junit.jupiter.extensions.autodetection.enabled = true
                        junit.jupiter.testinstance.lifecycle.default = per_class
                    <span class="tag">&lt;/configurationParameters&gt;</span>
                <span class="tag">&lt;/properties&gt;</span>
            <span class="tag">&lt;/configuration&gt;</span>
            <span class="tag">&lt;dependencies&gt;</span>
                ...
            <span class="tag">&lt;/dependencies&gt;</span>
        <span class="tag">&lt;/plugin&gt;</span>
    <span class="tag">&lt;/plugins&gt;</span>
<span class="tag">&lt;/build&gt;</span>
...</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="running-tests-build-ant"><a class="anchor" href="#running-tests-build-ant"></a>4.2.3. Ant</h4>
<div class="paragraph">
<p><a href="https://ant.apache.org/">Ant</a> のバージョン <code>1.10.3</code> から、
JUnit Platform上でのテスト実行をネイティブサポートするために
<a href="https://ant.apache.org/manual/Tasks/junitlauncher.html"><code>junitlauncher</code></a>
タスクが導入されました。<code>junitlauncher</code> タスクは、単にJUnit Platform
を起動して、選択したテストを渡すだけの責務をもちます。その後、JUnit Platform
が登録されたテストエンジンにテストの発見・実行を移譲します。</p>
</div>
<div class="paragraph">
<p><code>junitlauncher</code> タスクは、
ユーザーがテストエンジンに実行させたいテストを選択するための
<a href="https://ant.apache.org/manual/Types/resources.html#collection">リソース集合</a>
のように、Antの既存機能と可能な限り一貫性を保とうとしています。
これにより、Antの他のコアタスクと比べても、一貫性があり直感的なものになっています。</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Ant 1.10.3 でリリースされた <code>junitlauncher</code> タスクは、
JUnit Platformを起動する基本的かつ最低限のサポートだけを提供します。
追加の機能強化 (異なるJVMにforkしてのテスト実行サポートを含む) は、
今後のAntリリースで利用可能になる予定です。
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code><a href="https://github.com/junit-team/junit5-samples/tree/master/junit5-jupiter-starter-ant">junit5-jupiter-starter-ant</a></code> プロジェクトの <code>build.xml</code>
ファイルが使い方を示しています。</p>
</div>
<div class="sect4">
<h5 id="基本的な使い方"><a class="anchor" href="#基本的な使い方"></a>基本的な使い方</h5>
<div class="paragraph">
<p>次の例は、単一のテストクラス (<code>org.myapp.test.MyFirstJUnit5Test</code>)
を選択するように <code>junitlauncher</code> タスクを設定する方法を示します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;path</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">test.classpath</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="comment">&lt;!-- The location where you have your compiled classes --&gt;</span>
    <span class="tag">&lt;pathelement</span> <span class="attribute-name">location</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">${build.classes.dir}</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
<span class="tag">&lt;/path&gt;</span>

<span class="comment">&lt;!-- ... --&gt;</span>

<span class="tag">&lt;junitlauncher&gt;</span>
    <span class="tag">&lt;classpath</span> <span class="attribute-name">refid</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">test.classpath</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
    <span class="tag">&lt;test</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">org.myapp.test.MyFirstJUnit5Test</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
<span class="tag">&lt;/junitlauncher&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><code>test</code> 要素で実行したい単一のテストクラスを指定することができます。
<code>classpath</code> 要素でJUnit Platformを起動するのに使うクラスパスを指定することができます。
このクラスパスは、実行するテストクラスを探すのにも使われます。</p>
</div>
<div class="paragraph">
<p>次の例は、複数の場所からテストクラスを選択するように <code>junitlauncher</code>
タスクを設定する方法を示します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;path</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">test.classpath</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="comment">&lt;!-- The location where you have your compiled classes --&gt;</span>
    <span class="tag">&lt;pathelement</span> <span class="attribute-name">location</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">${build.classes.dir}</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
<span class="tag">&lt;/path&gt;</span>
....
<span class="tag">&lt;junitlauncher&gt;</span>
    <span class="tag">&lt;classpath</span> <span class="attribute-name">refid</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">test.classpath</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
    <span class="tag">&lt;testclasses</span> <span class="attribute-name">outputdir</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">${output.dir}</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;fileset</span> <span class="attribute-name">dir</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">${build.classes.dir}</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
            <span class="tag">&lt;include</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">org/example/**/demo/**/</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
        <span class="tag">&lt;/fileset&gt;</span>
        <span class="tag">&lt;fileset</span> <span class="attribute-name">dir</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">${some.other.dir}</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
            <span class="tag">&lt;include</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">org/myapp/**/</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
        <span class="tag">&lt;/fileset&gt;</span>
    <span class="tag">&lt;/testclasses&gt;</span>
<span class="tag">&lt;/junitlauncher&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>上の例のように <code>testclasses</code> 要素を使うと、異なる場所にある複数のテストクラスを選択できます。</p>
</div>
<div class="paragraph">
<p>使い方と設定オプションに関する詳細は、Ant公式ドキュメントの
<a href="https://ant.apache.org/manual/Tasks/junitlauncher.html"><code>junitlauncher</code> タスク</a>
を参照してください。</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="running-tests-console-launcher"><a class="anchor" href="#running-tests-console-launcher"></a>4.3. Console Launcher</h3>
<div class="paragraph">
<p><code><a href="https://junit.org/junit5/docs/5.2.0/api/org/junit/platform/console/ConsoleLauncher.html">ConsoleLauncher</a></code> は、コンソールからJUnit Platformを起動するための
Javaのコマンドラインアプリケーションです。例えば、JUnit VintageとJUnit Jupiter
のテストを実行し、結果をコンソールに表示するのに使えます。</p>
</div>
<div class="paragraph">
<p>すべての依存関係を含んだ実行可能な <code>junit-platform-console-standalone-1.2.0.jar</code>
がMavenセントラルリポジトリの
<a href="https://repo1.maven.org/maven2/org/junit/platform/junit-platform-console-standalone">junit-platform-console-standalone</a>
ディレクトリで公開されています。スタンドアロン版の <code>ConsoleLauncher</code> は、次のように
<a href="https://docs.oracle.com/javase/tutorial/deployment/jar/run.html">実行する</a> ことができます。</p>
</div>
<div class="paragraph">
<p><code>java -jar junit-platform-console-standalone-1.2.0.jar &lt;<a href="#running-tests-console-launcher-options">オプション</a>&gt;</code></p>
</div>
<div class="paragraph">
<p>出力の例は次の通りです。</p>
</div>
<div class="literalblock">
<div class="content">
<pre>├─ JUnit Vintage
│  └─ example.JUnit4Tests
│     └─ standardJUnit4Test ✔
└─ JUnit Jupiter
   ├─ StandardTests
   │  ├─ succeedingTest() ✔
   │  └─ skippedTest() ↷ for demonstration purposes
   └─ A special test case
      ├─ Custom test name containing spaces ✔
      ├─ ╯°□°）╯ ✔
      └─ 😱 ✔

Test run finished after 64 ms
[         5 containers found      ]
[         0 containers skipped    ]
[         5 containers started    ]
[         0 containers aborted    ]
[         5 containers successful ]
[         0 containers failed     ]
[         6 tests found           ]
[         1 tests skipped         ]
[         5 tests started         ]
[         0 tests aborted         ]
[         5 tests successful      ]
[         0 tests failed          ]</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">終了コード</div>
<code><a href="https://junit.org/junit5/docs/5.2.0/api/org/junit/platform/console/ConsoleLauncher.html">ConsoleLauncher</a></code> は、コンテナやテストが失敗するとステータスコード
<code>1</code> で終了します。成功した場合は、<code>0</code> です。
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="running-tests-console-launcher-options"><a class="anchor" href="#running-tests-console-launcher-options"></a>4.3.1. オプション</h4>
<div class="listingblock">
<div class="content">
<pre>Option                                         Description
------                                         -----------
-h, --help                                     Display help information.
--disable-ansi-colors                          Disable ANSI colors in output (not
                                                 supported by all terminals).
--details &lt;[none,summary,flat,tree,verbose]    Select an output details mode for when
  &gt;                                              tests are executed. Use one of: [none,
                                                 summary, flat, tree, verbose]. If 'none'
                                                 is selected, then only the summary and
                                                 test failures are shown. (default: tree)
--details-theme &lt;[ascii,unicode]&gt;              Select an output details tree theme for
                                                 when tests are executed. Use one of:
                                                 [ascii, unicode] (default: unicode)
--class-path, --classpath, --cp &lt;Path:         Provide additional classpath entries --
  path1:path2:...&gt;                               for example, for adding engines and
                                                 their dependencies. This option can be
                                                 repeated.
--reports-dir &lt;Path&gt;                           Enable report output into a specified
                                                 local directory (will be created if it
                                                 does not exist).
--scan-modules                                 EXPERIMENTAL: Scan all resolved modules
                                                 for test discovery.
-o, --select-module &lt;String: module name&gt;      EXPERIMENTAL: Select single module for
                                                 test discovery. This option can be
                                                 repeated.
--scan-class-path, --scan-classpath [Path:     Scan all directories on the classpath or
  path1:path2:...]                               explicit classpath roots. Without
                                                 arguments, only directories on the
                                                 system classpath as well as additional
                                                 classpath entries supplied via -cp
                                                 (directories and JAR files) are scanned.
                                                 Explicit classpath roots that are not on
                                                 the classpath will be silently ignored.
                                                 This option can be repeated.
-u, --select-uri &lt;URI&gt;                         Select a URI for test discovery. This
                                                 option can be repeated.
-f, --select-file &lt;String&gt;                     Select a file for test discovery. This
                                                 option can be repeated.
-d, --select-directory &lt;String&gt;                Select a directory for test discovery.
                                                 This option can be repeated.
-p, --select-package &lt;String&gt;                  Select a package for test discovery. This
                                                 option can be repeated.
-c, --select-class &lt;String&gt;                    Select a class for test discovery. This
                                                 option can be repeated.
-m, --select-method &lt;String&gt;                   Select a method for test discovery. This
                                                 option can be repeated.
-r, --select-resource &lt;String&gt;                 Select a classpath resource for test
                                                 discovery. This option can be repeated.
-n, --include-classname &lt;String&gt;               Provide a regular expression to include
                                                 only classes whose fully qualified names
                                                 match. To avoid loading classes
                                                 unnecessarily, the default pattern only
                                                 includes class names that begin with
                                                 "Test" or end with "Test" or "Tests".
                                                 When this option is repeated, all
                                                 patterns will be combined using OR
                                                 semantics. (default: ^(Test.*|.+[.$]Test.
                                                 *|.*Tests?)$)
-N, --exclude-classname &lt;String&gt;               Provide a regular expression to exclude
                                                 those classes whose fully qualified
                                                 names match. When this option is
                                                 repeated, all patterns will be combined
                                                 using OR semantics.
--include-package &lt;String&gt;                     Provide a package to be included in the
                                                 test run. This option can be repeated.
--exclude-package &lt;String&gt;                     Provide a package to be excluded from the
                                                 test run. This option can be repeated.
-t, --include-tag &lt;String&gt;                     Provide a tag or tag expression to include
                                                 only tests whose tags match. When this
                                                 option is repeated, all patterns will be
                                                 combined using OR semantics.
-T, --exclude-tag &lt;String&gt;                     Provide a tag or tag expression to exclude
                                                 those tests whose tags match. When this
                                                 option is repeated, all patterns will be
                                                 combined using OR semantics.
-e, --include-engine &lt;String&gt;                  Provide the ID of an engine to be included
                                                 in the test run. This option can be
                                                 repeated.
-E, --exclude-engine &lt;String&gt;                  Provide the ID of an engine to be excluded
                                                 from the test run. This option can be
                                                 repeated.
--config &lt;key=value&gt;                           Set a configuration parameter for test
                                                 discovery and execution. This option can
                                                 be repeated.</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="running-tests-junit-platform-runner"><a class="anchor" href="#running-tests-junit-platform-runner"></a>4.4. JUnit Platformの実行にJUnit 4を使う</h3>
<div class="paragraph">
<p><code>JUnitPlatform</code> ランナーは、JUnit Platformのプログラミングモデルに従ったテスト
（例えば、JUnit Jupiterのテストクラス）をJUnit 4環境で実行可能にするための
JUnit 4ベースの <code>Runner</code> です。</p>
</div>
<div class="paragraph">
<p>テストクラスに <code>@RunWith(JUnitPlatform.class)</code> アノテーションを付与すると、
まだJUnit Platformを直接はサポートしていないけれどもJUnit 4ならサポートしている
IDEやビルドシステムでも実行できるようになります。</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
JUnit PlatformはJUnit 4にない機能をもっているため、特にレポート周り
(<a href="#running-tests-junit-platform-runner-technical-names">表示名 vs. 技術名</a> を参照)など、
JUnit Platformの機能のサブセットしかサポートすることができません。
しかし、さしあたっては <code>JUnitPlatform</code> ランナーを使って始めるのが簡単です。
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="running-tests-junit-platform-runner-setup"><a class="anchor" href="#running-tests-junit-platform-runner-setup"></a>4.4.1. セットアップ</h4>
<div class="paragraph">
<p>クラスパスに以下のライブラリとその依存ライブラリが必要です。Group IDやArtifact ID、
バージョンの詳細については、 <a href="#dependency-metadata">依存関係メタデータ</a> を参照してください。</p>
</div>
<div class="sect4">
<h5 id="明示的な依存関係"><a class="anchor" href="#明示的な依存関係"></a>明示的な依存関係</h5>
<div class="ulist">
<ul>
<li>
<p><code>junit-platform-runner</code> は <em>test</em> スコープ: <code>JUnitPlatform</code> ランナーが含まれる</p>
</li>
<li>
<p><code>junit-4.12.jar</code> は <em>test</em> スコープ: JUnit 4を使ってテストを実行するため</p>
</li>
<li>
<p><code>junit-jupiter-api</code> は <em>test</em> スコープ: <code>@Test</code> などJUnit Jupiterを使ってテストを書くためのAPI</p>
</li>
<li>
<p><code>junit-jupiter-engine</code> は <em>test runtime</em> スコープ: JUnit Jupiterのための <code>TestEngine</code> API実装</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="推移的な依存関係"><a class="anchor" href="#推移的な依存関係"></a>推移的な依存関係</h5>
<div class="ulist">
<ul>
<li>
<p><code>junit-platform-suite-api</code> は <em>test</em> スコープ</p>
</li>
<li>
<p><code>junit-platform-launcher</code> は <em>test</em> スコープ</p>
</li>
<li>
<p><code>junit-platform-engine</code> は <em>test</em> スコープ</p>
</li>
<li>
<p><code>junit-platform-commons</code> は <em>test</em> スコープ</p>
</li>
<li>
<p><code>opentest4j</code> は <em>test</em> スコープ</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="running-tests-junit-platform-runner-technical-names"><a class="anchor" href="#running-tests-junit-platform-runner-technical-names"></a>4.4.2. 表示名 vs. 技術名</h4>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>訳注：本文書では <em>Display Name</em> に対して <em>表示名</em> という訳語を使用し、
本節で登場する <em>Technical Name</em> に対しては <em>技術名</em> という訳語を使用した。
しかし、後者は直感的ではないと思うので、適切な訳があればフィードバックをいただきたい。</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>@RunWith(JUnitPlatform.class)</code> ランナーで実行されるクラスにカスタムの
<em>表示名 (display name)</em> を定義するためには、<code>@SuiteDisplayName</code>
アノテーションを付与します。</p>
</div>
<div class="paragraph">
<p>デフォルトでは、 <em>表示名</em> はテストの成果物に使われます。しかし、Gradleや
Mavenのようなビルドツールが <code>JUnitPlatform</code> ランナーを使う場合、
生成されるテストレポートには、テストクラスの単純名や
特殊文字を含むカスタム表示名ではなく、完全修飾クラス名のような
<em>技術名 (technical name)</em> が必要になることがあります。
レポート出力で <em>技術名</em> を有効にするためには、
<code>@RunWith(JUnitPlatform.class)</code> と一緒に <code>@UseTechnicalNames</code>
アノテーションを宣言してください。</p>
</div>
<div class="paragraph">
<p><code>@UseTechnicalNames</code> を付与すると、<code>@SuiteDisplayName</code>
でしたカスタム表示名は無視される点に注意してください。</p>
</div>
</div>
<div class="sect3">
<h4 id="running-tests-junit-platform-runner-single-test"><a class="anchor" href="#running-tests-junit-platform-runner-single-test"></a>4.4.3. 単一のテストクラス</h4>
<div class="paragraph">
<p><code>JUnitPlatform</code> ランナーを使う方法の1つは、テストクラスに直接
<code>@RunWith(JUnitPlatform.class)</code> アノテーションを付与することです。
以下の例のテストメソッドには、<code>org.junit.Test</code> (JUnit Vintage) ではなく、
<code>org.junit.jupiter.api.Test</code> (JUnit Jupiter)
アノテーションが付与されている点に注意してください。さらに、
この場合はテストクラスを <code>public</code> にしなければならない点にも注意してください。
そうしないと、一部のIDEやビルドツールではJUnit 4のテストクラスとして
認識されません。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">static</span> <span class="include">org.junit.jupiter.api.Assertions.fail</span>;

<span class="keyword">import</span> <span class="include">org.junit.jupiter.api.Test</span>;
<span class="keyword">import</span> <span class="include">org.junit.platform.runner.JUnitPlatform</span>;
<span class="keyword">import</span> <span class="include">org.junit.runner.RunWith</span>;

<span class="annotation">@RunWith</span>(JUnitPlatform.class)
<span class="directive">public</span> <span class="type">class</span> <span class="class">JUnit4ClassDemo</span> {

    <span class="annotation">@Test</span>
    <span class="type">void</span> succeedingTest() {
        <span class="comment">/* no-op */</span>
    }

    <span class="annotation">@Test</span>
    <span class="type">void</span> failingTest() {
        fail(<span class="string"><span class="delimiter">&quot;</span><span class="content">Failing for failing's sake.</span><span class="delimiter">&quot;</span></span>);
    }

}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="running-tests-junit-platform-runner-test-suite"><a class="anchor" href="#running-tests-junit-platform-runner-test-suite"></a>4.4.4. テストスイート</h4>
<div class="paragraph">
<p>複数のテストクラスがある場合、次の例のようにテストスイートを作成できます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">org.junit.platform.runner.JUnitPlatform</span>;
<span class="keyword">import</span> <span class="include">org.junit.platform.suite.api.SelectPackages</span>;
<span class="keyword">import</span> <span class="include">org.junit.platform.suite.api.SuiteDisplayName</span>;
<span class="keyword">import</span> <span class="include">org.junit.runner.RunWith</span>;

<span class="annotation">@RunWith</span>(JUnitPlatform.class)
<span class="annotation">@SuiteDisplayName</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">JUnit 4 Suite Demo</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@SelectPackages</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">example</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">JUnit4SuiteDemo</span> {
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>JUnit4SuiteDemo</code> は、<code>example</code> パッケージとそのサブパッケージから
すべてのテストを探して実行します。デフォルトでは、名前が <code>Test</code> で始まるか、
<code>Test</code> または <code>Tests</code> で終わるテストクラスだけを実行します。</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">追加の設定オプション</div>
<code>@SelectPackages</code> 以外にも、テストを検索したりフィルタリングしたりするための
設定オプションがあります。詳細は、
<a href="https://junit.org/junit5/docs/5.2.0/api/org/junit/platform/suite/api/package-summary.html">Javadoc</a>
を参照してください。
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="running-tests-config-params"><a class="anchor" href="#running-tests-config-params"></a>4.5. 設定パラメーター</h3>
<div class="paragraph">
<p>どのテストクラスやテストエンジンを含むか、どのパッケージを検索するか、といったことを
プラットフォームに指示するだけでなく、特定のテストエンジンや拡張機能に固有の
追加の設定パラメーターを渡したい場合もあります。例えば、JUnit Jupiterの <code>TestEngine</code>
は、次のユースケースのために <em>設定パラメーター</em> をサポートしています。</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#writing-tests-test-instance-lifecycle-changing-default">テストインスタンスのデフォルトのライフサイクルの変更</a></p>
</li>
<li>
<p><a href="#extensions-registration-automatic-enabling">拡張機能の自動検出を有効にする</a></p>
</li>
<li>
<p><a href="#extensions-conditions-deactivation">条件を非アクティブにする</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><em>設定パラメーター</em> は、テキストベースのキーと値のペアで、JUnit Platform
で動作するテストエンジンに次のいずれかの方法で渡されます。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>LauncherDiscoveryRequestBuilder</code> クラスの <code>configurationParameter()</code>
または <code>configurationParameters()</code> メソッドを使って構築したリクエストを
<a href="#launcher-api"><code>Launcher</code> API</a> に渡します。JUnit Platform
が提供するツールを使ってテストを実行する場合、設定パラメーターは次のように指定できます。</p>
<div class="ulist">
<ul>
<li>
<p><a href="#running-tests-console-launcher">Console Launcher</a>: <code>--config</code>
コマンドラインオプションを使います</p>
</li>
<li>
<p><a href="#running-tests-build-gradle-config-params">Gradleプラグイン</a>:
<code>configurationParameter</code> または <code>configurationParameters</code> DSLを使います</p>
</li>
<li>
<p><a href="#running-tests-build-maven-config-params">Maven Surefireプロバイダ</a>:
<code>configurationParameters</code> プロパティを使います</p>
</li>
</ul>
</div>
</li>
<li>
<p>JVMシステムプロパティ</p>
</li>
<li>
<p>JUnit Platform設定ファイル: クラスパスのルートに <code>junit-platform.properties</code>
という名前で配置され、Javaの <code>Properties</code> ファイルと同じシンタックスに従います。</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
設定パラメーターは、上で定義された順番に従って解決されます。つまり、
<code>Launcher</code> に直接与えられた設定パラメーターの方が、システムプロパティや設定ファイルで
与えられたものより優先されます。同様に、システムプロパティで与えられた設定パラメーターの方が、
設定ファイルで与えられたものより優先されます。
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="running-tests-tag-expressions"><a class="anchor" href="#running-tests-tag-expressions"></a>4.6. タグ式</h3>
<div class="paragraph">
<p>タグ式は、 <code>!</code>, <code>&amp;</code>, <code>|</code> 演算子からなるブール式です。
演算子の優先順位を調整するために、<code>(</code> と <code>)</code> も使えます。</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 1. 演算子 (優先順位の降順)</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">演算子</th>
<th class="tableblock halign-left valign-top">意味</th>
<th class="tableblock halign-left valign-top">結合性</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>!</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">not</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">right</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&amp;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">and</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">left</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>|</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">or</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">left</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>テストに直交するタグを付与している場合、実行するテストを選択するのにタグ式は便利です。
テストの種類 (例えば、<em>micro</em>, <em>integration</em>, <em>end-to-end</em>) と機能
(例えば、 <strong>foo</strong>, <strong>bar</strong>, <strong>baz</strong>) のタグを付与すると、次のようなタグ式が使えます。</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 40%;">
<col style="width: 60%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">タグ式</th>
<th class="tableblock halign-left valign-top">該当するテスト</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">foo</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>foo</strong> に対するすべてのテスト</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">bar | baz</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>bar</strong> または <strong>baz</strong> に対するすべてのテスト</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">bar &amp; baz</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>bar</strong> かつ <strong>baz</strong> に対するすべてのテスト</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">foo &amp; !end-to-end</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>foo</strong>　に対するテストのうち、<em>end-to-end</em> レベル以外のすべてのテスト</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">(micro | integration) &amp; (foo | baz)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>foo</strong> または <strong>baz</strong> に対するテストのうち、<em>micro</em> または <em>integration</em> レベルのすべてのテスト</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="extensions"><a class="anchor" href="#extensions"></a>5. 拡張モデル</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="extensions-overview"><a class="anchor" href="#extensions-overview"></a>5.1. 概要</h3>
<div class="paragraph">
<p>JUnit 4の <code>Runner</code>, <code>@Rule</code>, <code>@ClassRule</code> などの拡張ポイントとは異なり、
JUnit Jupiterの拡張モデルは、単一の一貫したコンセプトである <code>Extension</code> API
で構成されます。ただし、<code>Extension</code> 自身はただのマーカーインターフェースである点に
注意してください。</p>
</div>
</div>
<div class="sect2">
<h3 id="extensions-registration"><a class="anchor" href="#extensions-registration"></a>5.2. 拡張機能の登録</h3>
<div class="paragraph">
<p>拡張機能は、 <a href="#extensions-registration-declarative"><code>@ExtendWith</code></a>
を使って <em>宣言的に</em> 登録するか、
<a href="#extensions-registration-programmatic"><code>@RegisterExtension</code></a>
を使って <em>手続き的に</em> 登録するか、あるいは
Javaの <a href="#extensions-registration-automatic"><code>ServiceLoader</code></a>
の仕組みを使って <em>自動的に</em> 登録することができます。</p>
</div>
<div class="sect3">
<h4 id="extensions-registration-declarative"><a class="anchor" href="#extensions-registration-declarative"></a>5.2.1. 宣言的な登録</h4>
<div class="paragraph">
<p>開発者は、テストインターフェースやテストクラス、テストメソッド、
<em><a href="#writing-tests-meta-annotations">合成アノテーション</a></em> に
<code>@ExtendWith(&#8230;&#8203;)</code> アノテーションを付与し、
拡張機能として登録したいクラスの参照を指定することで
1つ以上の拡張機能を <em>宣言的に</em> 登録することができます。</p>
</div>
<div class="paragraph">
<p>例えば、特定のテストメソッドに <code>RandomParametersExtension</code> を登録したい場合は、
テストメソッドに次のようにアノテーションを付与します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@ExtendWith</span>(RandomParametersExtension.class)
<span class="annotation">@Test</span>
<span class="type">void</span> test(<span class="annotation">@Random</span> <span class="type">int</span> i) {
    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>特定のクラスとそのサブクラスのすべてのテストに <code>RandomParametersExtension</code>
を登録したい場合は、テストクラスに次のようにアノテーションを付与します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@ExtendWith</span>(RandomParametersExtension.class)
<span class="type">class</span> <span class="class">MyTests</span> {
    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>複数の拡張機能は、次のように同時に登録することができます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@ExtendWith</span>({ FooExtension.class, BarExtension.class })
<span class="type">class</span> <span class="class">MyFirstTests</span> {
    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>別の方法としては、次のように個別に登録することができます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@ExtendWith</span>(FooExtension.class)
<span class="annotation">@ExtendWith</span>(BarExtension.class)
<span class="type">class</span> <span class="class">MySecondTests</span> {
    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">拡張機能の登録順序</div>
<code>@ExtendWith</code> で宣言的に登録された拡張機能は、ソースコード上での宣言順で実行されます。
例えば、<code>MyFirstTests</code> と <code>MySecondTests</code> のテスト実行は、<code>FooExtension</code> と
<code>BarExtension</code> によって <strong>まさにこの順序で</strong> 拡張されます。
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="extensions-registration-programmatic"><a class="anchor" href="#extensions-registration-programmatic"></a>5.2.2. 手続き的な登録</h4>
<div class="paragraph">
<p>開発者は、テストクラスのフィールドに
<code><a href="https://junit.org/junit5/docs/5.2.0/api/org/junit/jupiter/api/extension/RegisterExtension.html">@RegisterExtension</a></code> アノテーションを付与することで、
拡張機能を <em>手続き的に</em> 登録することができます。</p>
</div>
<div class="paragraph">
<p>拡張機能を <a href="#extensions-registration-declarative"><code>@ExtendWith</code></a> で
<em>宣言的に</em> 登録する場合、拡張機能の設定はアノテーション経由でしか行なえません。
しかし、拡張機能を <code>@RegisterExtension</code> で登録する場合は、
拡張機能のコンストラクタやstaticファクトリメソッド、
ビルダーAPIに引数を渡して <em>手続き的に</em> 設定することができます。</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<code>@RegisterExtension</code> フィールドは、<code>private</code> または <code>null</code> (評価時)
であってはなりませんが、<code>static</code> か非 <code>static</code> はどちらでもかまいません。
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="extensions-registration-programmatic-static-fields"><a class="anchor" href="#extensions-registration-programmatic-static-fields"></a>staticフィールド</h5>
<div class="paragraph">
<p><code>@RegisterExtension</code> フィールドが <code>static</code> の場合、その拡張機能は
<code>@ExtendWith</code> でクラスレベルに登録される拡張機能の後で登録されます。
そのような <em>staticな拡張機能</em> は、実装する拡張APIに制限がありません。
そのため、staticフィールドとして登録される拡張機能は、
<code>BeforeAllCallback</code>, <code>AfterAllCallback</code>, <code>TestInstancePostProcessor</code>
のようなクラスレベルやインスタンスレベルの拡張APIだけでなく、
<code>BeforeEachCallback</code> などのようなメソッドレベルの拡張APIも実装できます。</p>
</div>
<div class="paragraph">
<p>次の例では、テストクラスの <code>server</code> フィールドは <code>WebServerExtension</code>
がサポートするビルダーパターンを使って手続き的に初期化されます。設定された
<code>WebServerExtension</code> は、クラスレベルの拡張機能として自動的に登録され、
例えば、すべてのテストを開始する前にサーバーを起動したり、
すべてのテストが完了した後でサーバーを停止したりすることができます。
加えて、<code>@BeforeEach</code>, <code>@AfterEach</code>, <code>@Test</code> メソッドだけでなく、
<code>@BeforeAll</code> や <code>@AfterAll</code> のようなstaticなライフサイクルメソッドも
必要であれば <code>server</code> フィールド経由でこの拡張機能のインスタンスにアクセスできます。</p>
</div>
<div class="listingblock">
<div class="title">staticフィールド経由で登録される拡張機能</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="type">class</span> <span class="class">WebServerDemo</span> {

    <span class="annotation">@RegisterExtension</span>
    <span class="directive">static</span> WebServerExtension server = WebServerExtension.builder()
        .enableSecurity(<span class="predefined-constant">false</span>)
        .build();

    <span class="annotation">@Test</span>
    <span class="type">void</span> getProductList() {
        WebClient webClient = <span class="keyword">new</span> WebClient();
        <span class="predefined-type">String</span> serverUrl = server.getServerUrl();
        <span class="comment">// Use WebClient to connect to web server using serverUrl and verify response</span>
        assertEquals(<span class="integer">200</span>, webClient.get(serverUrl + <span class="string"><span class="delimiter">&quot;</span><span class="content">/products</span><span class="delimiter">&quot;</span></span>).getResponseStatus());
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="extensions-registration-programmatic-instance-fields"><a class="anchor" href="#extensions-registration-programmatic-instance-fields"></a>インスタンスフィールド</h5>
<div class="paragraph">
<p><code>@RegisterExtension</code> フィールドが非static (つまり、インスタンスフィールド)
の場合、その拡張機能はテストクラスがインスタンス化され、登録済みの各
<code>TestInstancePostProcessor</code> がテストインスタンスの事後処理
(拡張機能のインスタンスをアノテーションの付与されたフィールドに注入するなど)
をした後で登録されます。そのため、<em>インスタンスフィールドの拡張機能</em> が
<code>BeforeAllCallback</code>, <code>AfterAllCallback</code>, <code>TestInstancePostProcessor</code>
のようなクラスレベルやインスタンスレベルの拡張APIを実装しても意味がありません。
デフォルトでは、インスタンスフィールドの拡張機能は <code>@ExtendWith</code>
でメソッドレベルに登録される拡張機能より <em>後で</em> 登録されます。しかし、
テストクラスが <code>@TestInstance(Lifecycle.PER_CLASS)</code> モードに設定されている場合は、
<code>@ExtendWith</code> でメソッドレベルに登録される拡張機能の <em>前に</em> 登録されます。</p>
</div>
<div class="paragraph">
<p>次の例では、テストクラスの <code>docs</code> フィールドは <code>lookUpDocsDir()</code>
メソッドを呼び出した結果を <code>DocumentationExtension</code> のstaticファクトリメソッド
<code>forPath()</code> に渡すことで、手続き的に初期化されます。設定された
<code>DocumentationExtension</code> は、メソッドレベルの拡張機能として自動的に登録されます。
加えて、<code>@BeforeEach</code>, <code>@AfterEach</code>, <code>@Test</code> メソッドは
必要であれば <code>docs</code> フィールド経由でこの拡張機能のインスタンスにアクセスできます。</p>
</div>
<div class="listingblock">
<div class="title">インスタンスフィールド経由で登録される拡張機能</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="type">class</span> <span class="class">DocumentationDemo</span> {

    <span class="directive">static</span> Path lookUpDocsDir() {
        <span class="comment">// return path to docs dir</span>
    }

    <span class="annotation">@RegisterExtension</span>
    DocumentationExtension docs = DocumentationExtension.forPath(lookUpDocsDir());

    <span class="annotation">@Test</span>
    <span class="type">void</span> generateDocumentation() {
        <span class="comment">// use this.docs ...</span>
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="extensions-registration-automatic"><a class="anchor" href="#extensions-registration-automatic"></a>5.2.3. 自動的な登録</h4>
<div class="paragraph">
<p>アノテーションを使った拡張機能の
<a href="#extensions-registration-declarative">宣言的な登録</a> と
<a href="#extensions-registration-programmatic">手続き的な登録</a> に加えて、
JUnit JupiterはJavaの <code>java.util.ServiceLoader</code> の仕組みを使った拡張機能の
<em>グローバルな登録</em> もサポートしています。
これにより、クラスパスから利用可能なサードパーティの拡張機能を自動検出し、
自動的に登録させることができます。</p>
</div>
<div class="paragraph">
<p>具体的には、JARファイルの <code>/META-INF/services</code> フォルダの中に
<code>org.junit.jupiter.api.extension.Extension</code> という名前のファイルを作成し、
クラスの完全修飾名を指定することで拡張機能を登録できます。</p>
</div>
<div class="sect4">
<h5 id="extensions-registration-automatic-enabling"><a class="anchor" href="#extensions-registration-automatic-enabling"></a>拡張機能の自動検出を有効にする</h5>
<div class="paragraph">
<p>自動検出は高度な機能なので、デフォルトでは有効になっていません。有効化するには、
<em>設定パラメーター</em> <code>junit.jupiter.extensions.autodetection.enabled</code>
に <code>true</code> を指定します。これは、JVMのシステムプロパティか、
<code>Launcher</code> に渡される <code>LauncherDiscoveryRequest</code> の <em>設定パラメーター</em>、
あるいはJUnit Platform 設定ファイルで指定することができます
(詳細は、<a href="#running-tests-config-params">設定パラメーター</a> を参照)。</p>
</div>
<div class="paragraph">
<p>例えば、拡張機能の自動検出を有効化するには、JVMを次のシステムプロパティ付きで起動します。</p>
</div>
<div class="paragraph">
<p><code>-Djunit.jupiter.extensions.autodetection.enabled=true</code></p>
</div>
<div class="paragraph">
<p>自動検出が有効化されると、<code>ServiceLoader</code> の仕組みで検知された拡張機能は、
JUnit Jupiterのグローバルな拡張機能 (例えば、<code>TestInfo</code> や <code>TestReporter</code>
のサポート) の後で拡張機能レジストリに登録されます。</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="extensions-registration-inheritance"><a class="anchor" href="#extensions-registration-inheritance"></a>5.2.4. 拡張機能の継承</h4>
<div class="paragraph">
<p>登録された拡張機能は、テストクラス階層の中で親から子に継承されます。
同様に、クラスレベルで登録された拡張機能は、メソッドレベルに継承されます。
また、同一の拡張機能実装は、与えられた拡張コンテキストとその親の拡張コンテキストに対して
一回だけしか登録することができません。
結果として、重複して拡張機能実装を登録しようとしても無視されます。</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="extensions-conditions"><a class="anchor" href="#extensions-conditions"></a>5.3. 条件付きテスト実行</h3>
<div class="paragraph">
<p><code><a href="https://junit.org/junit5/docs/5.2.0/api/org/junit/jupiter/api/extension/ExecutionCondition.html">ExecutionCondition</a></code> は、プログラムの <em>条件付きテスト実行</em> のための <code>Extension</code> APIを定めています。</p>
</div>
<div class="paragraph">
<p><code>ExecutionCondition</code> は、コンテナ (例えば、テストクラス) がもつテストを与えられた
<code>ExtensionContext</code> で実行すべきか判断するためにコンテナ毎に評価されます。
同様に、<code>ExecutionCondition</code> は、個々のテストメソッドを与えられた <code>ExtensionContext</code>
で実行すべきか判断するためにテスト毎に評価されます。</p>
</div>
<div class="paragraph">
<p>複数の <code>ExecutionCondition</code> 拡張が登録された場合、<em>無効</em> と判定する拡張機能が1つでもあれば、
コンテナやテストはただちに無効化されます。別の拡張機能がすでにコンテナやテストを無効化していることがあるので、
ある拡張機能が必ず評価されるという保証はありません。言い換えると、論理OR演算子の短絡評価のように評価されます。</p>
</div>
<div class="paragraph">
<p>具体的な例は、<code><a href="https://github.com/junit-team/junit5/tree/master/junit-jupiter-engine/src/main/java/org/junit/jupiter/engine/extension/DisabledCondition.java">DisabledCondition</a></code> と <code><a href="https://junit.org/junit5/docs/5.2.0/api/org/junit/jupiter/api/Disabled.html">@Disabled</a></code> のソースコードを参照してください。</p>
</div>
<div class="sect3">
<h4 id="extensions-conditions-deactivation"><a class="anchor" href="#extensions-conditions-deactivation"></a>5.3.1. 条件を非アクティブにする</h4>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>訳注：テストの条件 (<code>ExecutionCondition</code>) が成立し、該当テストが実行される状態を
<em>有効</em>、逆に実行されない状態を <em>無効</em> と訳している。これに対して、
テストの条件自体が評価される状態であることを <em>アクティブ</em>、
評価されない状態であることを <em>非アクティブ</em> と区別して訳す。</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>ときには、特定の条件をアクティブにせずにテストスイートを実行できると有用な場合があります。
例えば、<code>@Disabled</code> アノテーションが付与されているテストであっても、今もまだ <em>壊れた</em>
ままかを確認するために実行したいと思うことがあるかもしれません。そのためには、
<em>設定パラメーター</em> <code>junit.jupiter.conditions.deactivate</code> を使って、
現在のテスト実行に対してどの条件を非アクティブ (つまり、評価されない) にするか
パターンを指定するだけです。パターンは、JVMのシステムプロパティか、 <code>Launcher</code> に渡される
<code>LauncherDiscoveryRequest</code> の <em>設定パラメーター</em>、あるいはJUnit Platform
設定ファイルで指定することができます (詳細は、<a href="#running-tests-config-params">設定パラメーター</a> を参照)。</p>
</div>
<div class="paragraph">
<p>例えば、JUnitの <code>@Disabled</code> 条件を非アクティブにするには、
JVMを次のシステムプロパティ付きで起動します。</p>
</div>
<div class="paragraph">
<p><code>-Djunit.jupiter.conditions.deactivate=org.junit.*DisabledCondition</code></p>
</div>
<div class="sect4">
<h5 id="extensions-conditions-deactivation-patterns"><a class="anchor" href="#extensions-conditions-deactivation-patterns"></a>パターンマッチング構文</h5>
<div class="paragraph">
<p><code>junit.jupiter.conditions.deactivate</code> のパターンがアスタリスク (<code>*</code>)
のみからなる場合、すべての条件が非アクティブになります。一方、
登録された条件の完全修飾クラス名 (<em>FQCN</em>) に対するパターンマッチも使えます。
パターン中のドット (<code>.</code>) は、FQCN中のドット (<code>.</code>) またはドル記号 (<code>$</code>) にマッチします。
アスタリスク (<code>*</code>) は、FQCN中の1つ以上の文字にマッチします。
ほかのすべての文字は、FQCN中の文字に1対1でマッチします。</p>
</div>
<div class="paragraph">
<p>例:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>*</code>: すべての条件を非アクティブにします。</p>
</li>
<li>
<p><code>org.junit.*</code>: <code>org.junit</code> パッケージおよびすべてのサブパッケージにある条件を非アクティブにします。</p>
</li>
<li>
<p><code>*.MyCondition</code>: 単純クラス名が <code>MyCondition</code> である条件をすべて非アクティブにします。</p>
</li>
<li>
<p><code>*System*</code>: 単純クラス名に <code>System</code> を含む条件をすべて非アクティブにします。</p>
</li>
<li>
<p><code>org.example.MyCondition</code>: FQCNが <code>org.example.MyCondition</code> である条件を非アクティブにします。</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="extensions-test-instance-post-processing"><a class="anchor" href="#extensions-test-instance-post-processing"></a>5.4. テストインスタンスの後処理</h3>
<div class="paragraph">
<p><code><a href="https://junit.org/junit5/docs/5.2.0/api/org/junit/jupiter/api/extension/TestInstancePostProcessor.html">TestInstancePostProcessor</a></code> は、テストインスタンスの <em>後処理</em> をするための <code>Extension</code>
APIを定めています。</p>
</div>
<div class="paragraph">
<p>よくあるユースケースは、テストインスタンスへの依存性注入や、テストインスタンスのカスタムの
初期化メソッド呼び出しなどがあります。</p>
</div>
<div class="paragraph">
<p>具体例は、<code><a href="https://github.com/mockito/mockito/blob/release/2.x/subprojects/junit-jupiter/src/main/java/org/mockito/junit/jupiter/MockitoExtension.java">MockitoExtension</a></code> や <code><a href="https://github.com/spring-projects/spring-framework/tree/master/spring-test/src/main/java/org/springframework/test/context/junit/jupiter/SpringExtension.java">SpringExtension</a></code> のソースコードを参照してください。</p>
</div>
</div>
<div class="sect2">
<h3 id="extensions-parameter-resolution"><a class="anchor" href="#extensions-parameter-resolution"></a>5.5. 引数の解決</h3>
<div class="paragraph">
<p><code><a href="https://junit.org/junit5/docs/5.2.0/api/org/junit/jupiter/api/extension/ParameterResolver.html">ParameterResolver</a></code> は、実行時に動的に引数を解決するための <code>Extension</code> APIを定めています。</p>
</div>
<div class="paragraph">
<p>テストコンストラクタや <code>@Test</code>, <code>@RepeatedTest</code>, <code>@ParameterizedTest</code>, <code>@TestFactory</code>,
<code>@BeforeEach</code>, <code>@AfterEach</code>, <code>@BeforeAll</code>, <code>@AfterAll</code> メソッドが引数をもつ場合、
その引数は <code>ParameterResolver</code> によって実行時に <em>解決</em> されなければいけません。
<code>ParameterResolver</code> は、ビルトインのもの (<code><a href="https://github.com/junit-team/junit5/tree/master/junit-jupiter-engine/src/main/java/org/junit/jupiter/engine/extension/TestInfoParameterResolver.java">TestInfoParameterResolver</a></code> 参照) または
<a href="#extensions-registration">ユーザーが登録したもの</a> のどちらかです。一般的に言うと、
引数は <em>名前</em>、<em>型</em>、<em>アノテーション</em>、あるいはその組み合わせで解決されます。
具体例は、<code><a href="https://github.com/junit-team/junit5/tree/master/junit-jupiter-engine/src/test/java/org/junit/jupiter/engine/execution/injection/sample/CustomTypeParameterResolver.java">CustomTypeParameterResolver</a></code> や <code><a href="https://github.com/junit-team/junit5/tree/master/junit-jupiter-engine/src/test/java/org/junit/jupiter/engine/execution/injection/sample/CustomAnnotationParameterResolver.java">CustomAnnotationParameterResolver</a></code>
のソースコードを参照してください。</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>JDK 9以前の <code>javac</code> が生成するバイトコードのバグのせいで、<em>内部クラス</em> のコンストラクタ
(例えば、<code>@Nested</code> テストクラスのコンストラクタ) に対して引数のアノテーションを
<code>java.lang.reflect.Parameter</code> API経由で直接探そうとすると、常に失敗します。</p>
</div>
<div class="paragraph">
<p>そのため、<code>ParameterResolver</code> 実装に与えられる <code><a href="https://junit.org/junit5/docs/5.2.0/api/org/junit/jupiter/api/extension/ParameterContext.html">ParameterContext</a></code> APIは、
引数のアノテーションを正しく検索するための以下の便利メソッドを含んでいます。
拡張機能の作者は、JDKのバグを回避するために <code>java.lang.reflect.Parameter</code> ではなく、
これらのメソッドを使用することが強く推奨されます。</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>boolean isAnnotated(Class&lt;? extends Annotation&gt; annotationType)</code></p>
</li>
<li>
<p><code>Optional&lt;A&gt; findAnnotation(Class&lt;A&gt; annotationType)</code></p>
</li>
<li>
<p><code>List&lt;A&gt; findRepeatableAnnotations(Class&lt;A&gt; annotationType)</code></p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="extensions-lifecycle-callbacks"><a class="anchor" href="#extensions-lifecycle-callbacks"></a>5.6. テストライフサイクルコールバック</h3>
<div class="paragraph">
<p>以下のインターフェースは、テスト実行のライフサイクルにおける様々なタイミングでテストを拡張するための
APIを定めています。詳細は、以降の節にあるサンプルと、<code><a href="https://junit.org/junit5/docs/5.2.0/api/org/junit/jupiter/api/extension/package-summary.html">org.junit.jupiter.api.extension</a></code> パッケージにある
これらのインターフェースのJavadocを参照してください。</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code><a href="https://junit.org/junit5/docs/5.2.0/api/org/junit/jupiter/api/extension/BeforeAllCallback.html">BeforeAllCallback</a></code></p>
<div class="ulist">
<ul>
<li>
<p><code><a href="https://junit.org/junit5/docs/5.2.0/api/org/junit/jupiter/api/extension/BeforeEachCallback.html">BeforeEachCallback</a></code></p>
<div class="ulist">
<ul>
<li>
<p><code><a href="https://junit.org/junit5/docs/5.2.0/api/org/junit/jupiter/api/extension/BeforeTestExecutionCallback.html">BeforeTestExecutionCallback</a></code></p>
</li>
<li>
<p><code><a href="https://junit.org/junit5/docs/5.2.0/api/org/junit/jupiter/api/extension/AfterTestExecutionCallback.html">AfterTestExecutionCallback</a></code></p>
</li>
</ul>
</div>
</li>
<li>
<p><code><a href="https://junit.org/junit5/docs/5.2.0/api/org/junit/jupiter/api/extension/AfterEachCallback.html">AfterEachCallback</a></code></p>
</li>
</ul>
</div>
</li>
<li>
<p><code><a href="https://junit.org/junit5/docs/5.2.0/api/org/junit/jupiter/api/extension/AfterAllCallback.html">AfterAllCallback</a></code></p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">複数のExtension APIを実装する</div>
拡張機能の開発者は、1つの拡張機能でこれらのインターフェースをいくつでも実装することができます。
具体例は、<code><a href="https://github.com/spring-projects/spring-framework/tree/master/spring-test/src/main/java/org/springframework/test/context/junit/jupiter/SpringExtension.java">SpringExtension</a></code> のソースコードを参照してください。
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="extensions-lifecycle-callbacks-before-after-execution"><a class="anchor" href="#extensions-lifecycle-callbacks-before-after-execution"></a>5.6.1. テスト実行前後のコールバック</h4>
<div class="paragraph">
<p><code><a href="https://junit.org/junit5/docs/5.2.0/api/org/junit/jupiter/api/extension/BeforeTestExecutionCallback.html">BeforeTestExecutionCallback</a></code> と <code><a href="https://junit.org/junit5/docs/5.2.0/api/org/junit/jupiter/api/extension/AfterTestExecutionCallback.html">AfterTestExecutionCallback</a></code> は、
テストメソッドが実行される <em>直前</em> と <em>直後</em> に実行されるような振る舞いを追加したい場合の
<code>Extension</code> API を定めています。実行時間の計測や、処理のトレースなどのユースケースに適しています。
もしも <code>@BeforeEach</code> メソッドや <code>@AfterEach</code> メソッドの <em>前後</em> に呼び出されるコールバックが
必要な場合は、代わりに <code>BeforeEachCallback</code> や <code>AfterEachCallback</code> を実装してください。</p>
</div>
<div class="paragraph">
<p>次の例は、テストメソッドの実行時間を計測してログ出力するために、
これらのコールバックを利用する方法を示しています。<code>TimingExtension</code> は、
<code>BeforeTestExecutionCallback</code> と <code>AfterTestExecutionCallback</code> の両方を実装しています。</p>
</div>
<div id="extensions-lifecycle-callbacks-timing-extension" class="listingblock">
<div class="title">テストメソッドの実行時間を計測してログ出力する拡張機能</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">java.lang.reflect.Method</span>;
<span class="keyword">import</span> <span class="include">java.util.logging.Logger</span>;

<span class="keyword">import</span> <span class="include">org.junit.jupiter.api.extension.AfterTestExecutionCallback</span>;
<span class="keyword">import</span> <span class="include">org.junit.jupiter.api.extension.BeforeTestExecutionCallback</span>;
<span class="keyword">import</span> <span class="include">org.junit.jupiter.api.extension.ExtensionContext</span>;
<span class="keyword">import</span> <span class="include">org.junit.jupiter.api.extension.ExtensionContext.Namespace</span>;
<span class="keyword">import</span> <span class="include">org.junit.jupiter.api.extension.ExtensionContext.Store</span>;

<span class="directive">public</span> <span class="type">class</span> <span class="class">TimingExtension</span> <span class="directive">implements</span> BeforeTestExecutionCallback, AfterTestExecutionCallback {

    <span class="directive">private</span> <span class="directive">static</span> <span class="directive">final</span> <span class="predefined-type">Logger</span> logger = <span class="predefined-type">Logger</span>.getLogger(TimingExtension.class.getName());

    <span class="directive">private</span> <span class="directive">static</span> <span class="directive">final</span> <span class="predefined-type">String</span> START_TIME = <span class="string"><span class="delimiter">&quot;</span><span class="content">start time</span><span class="delimiter">&quot;</span></span>;

    <span class="annotation">@Override</span>
    <span class="directive">public</span> <span class="type">void</span> beforeTestExecution(ExtensionContext context) <span class="directive">throws</span> <span class="exception">Exception</span> {
        getStore(context).put(START_TIME, <span class="predefined-type">System</span>.currentTimeMillis());
    }

    <span class="annotation">@Override</span>
    <span class="directive">public</span> <span class="type">void</span> afterTestExecution(ExtensionContext context) <span class="directive">throws</span> <span class="exception">Exception</span> {
        <span class="predefined-type">Method</span> testMethod = context.getRequiredTestMethod();
        <span class="type">long</span> startTime = getStore(context).remove(START_TIME, <span class="type">long</span>.class);
        <span class="type">long</span> duration = <span class="predefined-type">System</span>.currentTimeMillis() - startTime;

        logger.info(() -&gt; <span class="predefined-type">String</span>.format(<span class="string"><span class="delimiter">&quot;</span><span class="content">Method [%s] took %s ms.</span><span class="delimiter">&quot;</span></span>, testMethod.getName(), duration));
    }

    <span class="directive">private</span> Store getStore(ExtensionContext context) {
        <span class="keyword">return</span> context.getStore(Namespace.create(getClass(), context.getRequiredTestMethod()));
    }

}</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>TimingExtensionTests</code> クラスは <code>@ExtendWith</code> を使って <code>TimingExtension</code>
を登録しているので、テストを実行すると時間計測が有効になります。</p>
</div>
<div class="listingblock">
<div class="title">TimingExtensionを使うテストクラス</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@ExtendWith</span>(TimingExtension.class)
<span class="type">class</span> <span class="class">TimingExtensionTests</span> {

    <span class="annotation">@Test</span>
    <span class="type">void</span> sleep20ms() <span class="directive">throws</span> <span class="exception">Exception</span> {
        <span class="predefined-type">Thread</span>.sleep(<span class="integer">20</span>);
    }

    <span class="annotation">@Test</span>
    <span class="type">void</span> sleep50ms() <span class="directive">throws</span> <span class="exception">Exception</span> {
        <span class="predefined-type">Thread</span>.sleep(<span class="integer">50</span>);
    }

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>以下は、<code>TimingExtensionTests</code> が実行されたときに出力されるログの例です。</p>
</div>
<div class="literalblock">
<div class="content">
<pre>INFO: Method [sleep20ms] took 24 ms.
INFO: Method [sleep50ms] took 53 ms.</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="extensions-exception-handling"><a class="anchor" href="#extensions-exception-handling"></a>5.7. 例外ハンドリング</h3>
<div class="paragraph">
<p><code><a href="https://junit.org/junit5/docs/5.2.0/api/org/junit/jupiter/api/extension/TestExecutionExceptionHandler.html">TestExecutionExceptionHandler</a></code> は、テスト実行中に投げられた例外を扱うための
<code>Extension</code> API を定めています。</p>
</div>
<div class="paragraph">
<p>次の例は、<code>IOException</code> のすべてのインスタンスをもみ消し、
それ以外の例外は再スローするような拡張機能を示しています。</p>
</div>
<div class="listingblock">
<div class="title">例外をハンドリングする拡張機能</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">IgnoreIOExceptionExtension</span> <span class="directive">implements</span> TestExecutionExceptionHandler {

    <span class="annotation">@Override</span>
    <span class="directive">public</span> <span class="type">void</span> handleTestExecutionException(ExtensionContext context, <span class="predefined-type">Throwable</span> throwable)
            <span class="directive">throws</span> <span class="predefined-type">Throwable</span> {

        <span class="keyword">if</span> (throwable <span class="keyword">instanceof</span> <span class="exception">IOException</span>) {
            <span class="keyword">return</span>;
        }
        <span class="keyword">throw</span> throwable;
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="extensions-test-templates"><a class="anchor" href="#extensions-test-templates"></a>5.8. テストテンプレートに実行コンテキストを与える</h3>
<div class="paragraph">
<p><code><a href="https://junit.org/junit5/docs/5.2.0/api/org/junit/jupiter/api/TestTemplate.html">@TestTemplate</a></code> メソッドは、<code><a href="https://junit.org/junit5/docs/5.2.0/api/org/junit/jupiter/api/extension/TestTemplateInvocationContextProvider.html">TestTemplateInvocationContextProvider</a></code>
が少なくとも1つ登録されている場合のみ実行されます。これらのプロバイダは、
<code><a href="https://junit.org/junit5/docs/5.2.0/api/org/junit/jupiter/api/extension/TestTemplateInvocationContext.html">TestTemplateInvocationContext</a></code> インスタンスの <code>Stream</code> を返す責任をもちます。
各コンテキストは、カスタム表示名と <code><a href="https://junit.org/junit5/docs/5.2.0/api/org/junit/jupiter/api/TestTemplate.html">@TestTemplate</a></code> メソッドの次の呼び出しだけで使われる
追加の拡張機能のリストを指定します。</p>
</div>
<div class="paragraph">
<p>次の例は、<code><a href="https://junit.org/junit5/docs/5.2.0/api/org/junit/jupiter/api/extension/TestTemplateInvocationContextProvider.html">TestTemplateInvocationContextProvider</a></code> を実装して登録する方法と、
テストテンプレートを記述する方法を示しています。</p>
</div>
<div class="listingblock">
<div class="title">テストテンプレートと拡張機能</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@TestTemplate</span>
<span class="annotation">@ExtendWith</span>(MyTestTemplateInvocationContextProvider.class)
<span class="type">void</span> testTemplate(<span class="predefined-type">String</span> parameter) {
    assertEquals(<span class="integer">3</span>, parameter.length());
}

<span class="directive">public</span> <span class="type">class</span> <span class="class">MyTestTemplateInvocationContextProvider</span> <span class="directive">implements</span> TestTemplateInvocationContextProvider {
    <span class="annotation">@Override</span>
    <span class="directive">public</span> <span class="type">boolean</span> supportsTestTemplate(ExtensionContext context) {
        <span class="keyword">return</span> <span class="predefined-constant">true</span>;
    }

    <span class="annotation">@Override</span>
    <span class="directive">public</span> Stream&lt;TestTemplateInvocationContext&gt; provideTestTemplateInvocationContexts(ExtensionContext context) {
        <span class="keyword">return</span> Stream.of(invocationContext(<span class="string"><span class="delimiter">&quot;</span><span class="content">foo</span><span class="delimiter">&quot;</span></span>), invocationContext(<span class="string"><span class="delimiter">&quot;</span><span class="content">bar</span><span class="delimiter">&quot;</span></span>));
    }

    <span class="directive">private</span> TestTemplateInvocationContext invocationContext(<span class="predefined-type">String</span> parameter) {
        <span class="keyword">return</span> <span class="keyword">new</span> TestTemplateInvocationContext() {
            <span class="annotation">@Override</span>
            <span class="directive">public</span> <span class="predefined-type">String</span> getDisplayName(<span class="type">int</span> invocationIndex) {
                <span class="keyword">return</span> parameter;
            }

            <span class="annotation">@Override</span>
            <span class="directive">public</span> <span class="predefined-type">List</span>&lt;Extension&gt; getAdditionalExtensions() {
                <span class="keyword">return</span> <span class="predefined-type">Collections</span>.singletonList(<span class="keyword">new</span> ParameterResolver() {
                    <span class="annotation">@Override</span>
                    <span class="directive">public</span> <span class="type">boolean</span> supportsParameter(ParameterContext parameterContext,
                            ExtensionContext extensionContext) {
                        <span class="keyword">return</span> parameterContext.getParameter().getType().equals(<span class="predefined-type">String</span>.class);
                    }

                    <span class="annotation">@Override</span>
                    <span class="directive">public</span> <span class="predefined-type">Object</span> resolveParameter(ParameterContext parameterContext,
                            ExtensionContext extensionContext) {
                        <span class="keyword">return</span> parameter;
                    }
                });
            }
        };
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>この例では、テストテンプレートは2回実行されます。各実行の表示名は、実行コンテキストで指定された通り、
&#8220;foo&#8221; と &#8220;bar&#8221; になります。各実行では、メソッド引数を解決するために使われるカスタムの
<code><a href="https://junit.org/junit5/docs/5.2.0/api/org/junit/jupiter/api/extension/ParameterResolver.html">ParameterResolver</a></code> を登録しています。 <code>ConsoleLauncher</code> を使ったときの出力は、次のようになります。</p>
</div>
<div class="literalblock">
<div class="content">
<pre>└─ testTemplate(String) ✔
   ├─ foo ✔
   └─ bar ✔</pre>
</div>
</div>
<div class="paragraph">
<p><code><a href="https://junit.org/junit5/docs/5.2.0/api/org/junit/jupiter/api/extension/TestTemplateInvocationContextProvider.html">TestTemplateInvocationContextProvider</a></code> 拡張APIは、
テストクラスのインスタンスを異なるコンテキスト（例えば、異なる引数）で準備したり、
同じコンテキストで何回も呼び出したりするような、メソッドを繰り返し実行する様々なテストを
実装することを主目的としています。
<a href="#writing-tests-repeated-tests">繰り返しテスト</a> や <a href="#writing-tests-parameterized-tests">パラメーター化テスト</a> が、
その機能を実現するためにこの拡張ポイントをどのように使っているか参考にしてください。</p>
</div>
</div>
<div class="sect2">
<h3 id="extensions-keeping-state"><a class="anchor" href="#extensions-keeping-state"></a>5.9. 拡張機能の状態を保持する</h3>
<div class="paragraph">
<p>通常、拡張機能は一度だけしかインスタンス化されません。そのため、
拡張機能のある実行から次の実行までどのように状態を保持するのか？が問題となります。
<code>ExtensionContext</code> APIは、まさにこの目的のために <code>Store</code> を提供しています。
拡張機能は、値を <code>Store</code> に保存しておいて、あとで取得することができます。
メソッドレベルのスコープで <code>Store</code> を使用する例については、
<code><a href="#extensions-lifecycle-callbacks-timing-extension">TimingExtension</a></code>
を参照してください。
テスト実行の間に <code>ExtensionContext</code> に保存された値は、その外側の <code>ExtensionContext</code>
では利用できないことを覚えておくのは重要です。<code>ExtensionContext</code> はネストされうるので、
内側の拡張コンテキストのスコープも制限されることがあります。
<code><a href="https://junit.org/junit5/docs/5.2.0/api/org/junit/jupiter/api/extension/ExtensionContext.Store.html">Store</a></code> 経由で保存・取得するために使えるメソッドの詳細については、
関連する JavaDoc を参照してください。</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title"><code>ExtensionContext.Store.CloseableResource</code></div>
拡張コンテキストのストアは、その拡張コンテキストのライフサイクルに束縛されています。
拡張コンテキストのライフサイクルが終了すると、関連するストアもクローズされます。
保存されている値が <code>CloseableResource</code> のインスタンスである場合は、その <code>close()</code>
メソッドが呼び出されて通知されます。
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="extensions-supported-utilities"><a class="anchor" href="#extensions-supported-utilities"></a>5.10. 拡張機能でサポートされるユーティリティ</h3>
<div class="paragraph">
<p><code>junit-platform-commons</code> は、アノテーションやクラス、リフレクション、
クラスパスの探索処理に使える <em>メンテナンスされた</em> ユーティリティメソッドを含む
<code><a href="https://junit.org/junit5/docs/5.2.0/api/org/junit/platform/commons/support/package-summary.html">org.junit.platform.commons.support</a></code> というパッケージを提供しています。
<code>TestEngine</code> や <code>Extension</code> の作者は、JUnit Platformの振る舞いに合わせるために、
これらのメソッドを利用することが推奨されます。</p>
</div>
<div class="sect3">
<h4 id="extensions-supported-utilities-annotations"><a class="anchor" href="#extensions-supported-utilities-annotations"></a>5.10.1. アノテーションサポート</h4>
<div class="paragraph">
<p><code>AnnotationSupport</code> は、アノテーションが付与された要素（例えば、パッケージやアノテーション、
クラス、インターフェース、コンストラクタ、メソッド、フィールド）を操作するstatic
なユーティリティメソッドを提供します。その中には、
ある要素に特定のアノテーションやメタアノテーションが付与されているかチェックしたり、
特定のアノテーションを探したり、クラスやフィールドからアノテーションの付与されたメソッドを
探したりするメソッドが含まれます。これらのメソッドのいくつかは、
アノテーションを探すために実装インターフェースやクラス階層を探索します。
さらなる詳細は、<code><a href="https://junit.org/junit5/docs/5.2.0/api/org/junit/platform/commons/support/AnnotationSupport.html">AnnotationSupport</a></code> のJavaDocを確認してください。</p>
</div>
</div>
<div class="sect3">
<h4 id="extensions-supported-utilities-classes"><a class="anchor" href="#extensions-supported-utilities-classes"></a>5.10.2. クラスサポート</h4>
<div class="paragraph">
<p><code>ClassSupport</code> は、クラス（つまり、<code>java.lang.Class</code> のインスタンス）を操作する
staticなユーティリティメソッドを提供します。詳細は、<code><a href="https://junit.org/junit5/docs/5.2.0/api/org/junit/platform/commons/support/ClassSupport.html">ClassSupport</a></code> のJavaDoc
を参照してください。</p>
</div>
</div>
<div class="sect3">
<h4 id="extensions-supported-utilities-reflection"><a class="anchor" href="#extensions-supported-utilities-reflection"></a>5.10.3. リフレクションサポート</h4>
<div class="paragraph">
<p><code>ReflectionSupport</code> は、標準JDKのリフレクションとクラスロードの仕組みを強化する
staticなユーティリティメソッドを提供します。
その中には、指定された述語にマッチするクラスを求めてクラスパスを探索したり、
あるクラスをロードして新しいインスタンスを作成したり、メソッドを探して実行したりする
メソッドが含まれます。
これらのメソッドのいくつかは、マッチするメソッドを特定するためにクラス階層を探索します。
さらなる詳細は、<code><a href="https://junit.org/junit5/docs/5.2.0/api/org/junit/platform/commons/support/ReflectionSupport.html">ReflectionSupport</a></code> のJavaDocを確認してください。</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="extensions-execution-order"><a class="anchor" href="#extensions-execution-order"></a>5.11. ユーザーコードと拡張機能の相対的な実行順序</h3>
<div class="paragraph">
<p>1つ以上のテストメソッドを含むテストクラスを実行する場合、ユーザーが指定するテストメソッドと
ライフサイクルメソッドに加えて、多くの拡張機能コールバックが呼び出されます。次の図は、
ユーザーコードと拡張機能コードの相対的な実行順序を示しています。</p>
</div>
<div id="extensions-execution-order-diagram" class="imageblock">
<div class="content">
<img src="images/extensions_lifecycle.png" alt="extensions lifecycle">
</div>
<div class="title">ユーザーコードと拡張機能コード</div>
</div>
<div class="paragraph">
<p>ユーザーが提供するテストメソッドとライフサイクルメソッドはオレンジ色、
拡張機能が提供するコールバックコードは青色で示されています。灰色のボックスは、
単一のテストメソッドの実行を表し、テストクラス内のテストメソッド毎に繰り返されます。</p>
</div>
<div class="paragraph">
<p>次の表は、<a href="#extensions-execution-order-diagram">ユーザーコードと拡張機能コード</a> の図の12ステップをさらに説明しています。</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 5%;">
<col style="width: 15%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">ステップ</th>
<th class="tableblock halign-left valign-top">インターフェース／アノテーション</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.jupiter.api.extension.BeforeAllCallback</code> インターフェース</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">コンテナのすべてのテストが実行される前に実行される拡張機能のコード</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.jupiter.api.BeforeAll</code> アノテーション</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">コンテナのすべてのテストが実行される前に実行されるユーザーコード</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.jupiter.api.extension.BeforeEachCallback</code> インターフェース</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">各テストが実行される前に実行される拡張機能のコード</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.jupiter.api.BeforeEach</code> アノテーション</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">各テストが実行される前に実行されるユーザーコード</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.jupiter.api.extension.BeforeTestExecutionCallback</code> インターフェース</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">テストが実行される直前に実行される拡張機能のコード</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.jupiter.api.Test</code> アノテーション</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">実際のテストメソッドとなるユーザーコード</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.jupiter.api.extension.TestExecutionExceptionHandler</code> インターフェース</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">テストの間に投げられた例外をハンドリングするための拡張機能のコード</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.jupiter.api.extension.AfterTestExecutionCallback</code> インターフェース</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">テストが実行され、その例外ハンドラが処理された直後に実行される拡張機能のコード</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">9</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.jupiter.api.AfterEach</code> アノテーション</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">各テストが実行された後に実行されるユーザーコード</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.jupiter.api.extension.AfterEachCallback</code> インターフェース</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">各テストが実行された後に実行される拡張機能のコード</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">11</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.jupiter.api.AfterAll</code> アノテーション</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">コンテナのすべてのテストが実行された後に実行されるユーザーコード</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">12</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.jupiter.api.extension.AfterAllCallback</code> インターフェース</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">コンテナのすべてのテストが実行された後に実行される拡張機能のコード</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>最も単純な場合は、実際のテストメソッドだけが実行されます (ステップ 6)。
ほかのすべてのステップは、ライフサイクルコールバックに対するユーザーコードや拡張機能コードの
有無によって省略可能です。様々なライフサイクルコールバックに関する詳細については、
各アノテーションや拡張機能に対する JavaDoc を参照してください。</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="migrating-from-junit4"><a class="anchor" href="#migrating-from-junit4"></a>6. JUnit 4からの移行</h2>
<div class="sectionbody">
<div class="paragraph">
<p>JUnit Jupiterのプログラミングモデルと拡張モデルは、<code>Rule</code> や <code>Runner</code>
のようなJUnit 4の機能をネイティブにはサポートしていません。しかし、
ソースコードのメンテナがJUnit Jupiterへ移行するためにすべての既存テストやテスト拡張、
カスタムビルド基盤を書き換えることを求めているわけではありません。</p>
</div>
<div class="paragraph">
<p>代わりに、JUnit Platform上でJUnit 3またはJUnit 4ベースの既存テストを実行できる
ようにする <em>JUnit Vintageテストエンジン</em> を通して、なだらかな移行パスを提供しています。
JUnit Jupiter固有のクラスやアノテーションはすべて新設された <code>org.junit.jupiter</code>
パッケージ配下にあるため、JUnit 4とJUnit Jupiterが同時にクラスパスに含まれていても
コンフリクトは発生しません。そのため、既存のJUnit 4テストをJUnit Jupiter
テストと並行してメンテナンスしても安全です。さらに、JUnitチームはJUnit 4.x
系のメンテナンスとバグフィックスリリースを継続しているため、
開発者は自身のスケジュールに合わせてJUnit Jupiterに移行する十分な時間があります。</p>
</div>
<div class="sect2">
<h3 id="migrating-from-junit4-running"><a class="anchor" href="#migrating-from-junit4-running"></a>6.1. JUnit Platform上でJUnit 4テストを実行する</h3>
<div class="paragraph">
<p><code>junit-vintage-engine</code> がテストランタイムパスに含まれていることを確認してください。
そうすれば、JUnit Platformランチャーが、JUnit 3およびJUnit 4のテストを自動的に
ピックアップしてくれます。</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/junit-team/junit5-samples"><code>junit5-samples</code></a> リポジトリにあるサンプルプロジェクトを
参照して、GradleやMavenでどのように実現するか確認してください。</p>
</div>
<div class="sect3">
<h4 id="migrating-from-junit4-categories-support"><a class="anchor" href="#migrating-from-junit4-categories-support"></a>6.1.1. カテゴリのサポート</h4>
<div class="paragraph">
<p><code>@Category</code> アノテーションの付与されたテストクラスやテストメソッドに対しては、
<em>JUnit Vintageテストエンジン</em> はカテゴリの完全修飾クラス名を該当テストのタグとみなします。
例えば、テストメソッドに <code>@Category(Example.class)</code> アノテーションが付与されている場合、
<code>"com.acme.Example"</code> でタグ付けされます。JUnit 4の <code>Categories</code> ランナーと同様に、
この情報は実行するテストのフィルタリングに使われます (詳細は、<a href="#running-tests">テストを実行する</a> 参照)。</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="migrating-from-junit4-tips"><a class="anchor" href="#migrating-from-junit4-tips"></a>6.2. 移行のヒント</h3>
<div class="paragraph">
<p>既存のJUnit 4テストをJUnit Jupiterに移行するときに気をつけなければいけないことは、
次の通りです。</p>
</div>
<div class="ulist">
<ul>
<li>
<p>アノテーションは、<code>org.junit.jupiter.api</code> パッケージにあります。</p>
</li>
<li>
<p>アサーションは、<code>org.junit.jupiter.api.Assertions</code> にあります。</p>
</li>
<li>
<p>前提条件は、<code>org.junit.jupiter.api.Assumptions</code> にあります。</p>
</li>
<li>
<p><code>@Before</code> と <code>@After</code> は、なくなりました。代わりに、<code>@BeforeEach</code> と <code>@AfterEach</code> を使ってください。</p>
</li>
<li>
<p><code>@BeforeClass</code> と <code>@AfterClass</code> は、なくなりました。代わりに、<code>@BeforeAll</code> と <code>@AfterAll</code> を使ってください。</p>
</li>
<li>
<p><code>@Ignore</code> は、なくなりました。代わりに、<code>@Disabled</code> を使ってください。</p>
</li>
<li>
<p><code>@Category</code> は、なくなりました。代わりに、<code>@Tag</code> を使ってください。</p>
</li>
<li>
<p><code>@RunWith</code> は、なくなりました。<code>@ExtendWith</code> に置き換えられました。</p>
</li>
<li>
<p><code>@Rule</code> と <code>@ClassRule</code> は、なくなりました。<code>@ExtendWith</code> に置き換えられました。
部分的なルールのサポートについては、次節を参照してください。</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="migrating-from-junit4-rule-support"><a class="anchor" href="#migrating-from-junit4-rule-support"></a>6.3. JUnit 4のルールの限定的なサポート</h3>
<div class="paragraph">
<p>前述したように、JUnit JupiterはJUnit 4のルールをサポートしていませんし、
その予定もありません。しかし、JUnitチームは、多くの組織が（特に大きな組織ほど）
カスタムルールを使ったJUnit 4のコードベースを保持していることを理解しています。
このような組織に段階的な移行パスを用意するため、JUnitチームはJUnit Jupiter
でJUnit 4のルールをサポートすることを決めました。
このサポートはアダプタをベースにしており、JUnit Jupiterの拡張モデルと意味的に
互換性があるルールに限定されています。
例えば、テストの実行フローを完全に変えてしまうようなことがないものです。</p>
</div>
<div class="paragraph">
<p>JUnit Jupiterの <code>junit-jupiter-migrationsupport</code> モジュールは、
今のところ次の3つの <code>Rule</code> とそのサブクラスをサポートしています。</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>org.junit.rules.ExternalResource</code> (<code>org.junit.rules.TemporaryFolder</code> も含む)</p>
</li>
<li>
<p><code>org.junit.rules.Verifier</code> (<code>org.junit.rules.ErrorCollector</code> も含む)</p>
</li>
<li>
<p><code>org.junit.rules.ExpectedException</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>JUnit 4と同様に、Ruleアノテーションが付与されたフィールドとメソッドをサポートします。
これらのクラスレベルの拡張機能を使うことで、レガシーコードがもつ <code>Rule</code>
実装をJUnit 4のimport文も含めて <em>変更せずにそのままにしておく</em> ことができます。</p>
</div>
<div class="paragraph">
<p>この限定的な形での <code>Rule</code> サポートは、クラスレベルのアノテーション
<code>org.junit.jupiter.migrationsupport.rules.EnableRuleMigrationSupport</code>
を使って有効にすることができます。このアノテーションは、
<code>VerifierSupport</code>, <code>ExternalResourceSupport</code>, <code>ExpectedExceptionSupport</code>
のすべての移行サポート拡張を有効にするための <em>合成アノテーション</em> になっています。</p>
</div>
<div class="paragraph">
<p>なお、JUnit 5に対する新しい拡張機能を開発するときには、JUnit 4
のルールベースのモデルではなく、JUnit Jupiterの拡張モデルを使ってください。</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
JUnit JupiterにおけるJUnit 4の <code>Rule</code> サポートは、今のところ
<em>実験的な</em> 機能です。詳細は、<a href="#api-evolution-experimental-apis">実験的なAPI</a>
の表を確認してください。
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="advanced-topics"><a class="anchor" href="#advanced-topics"></a>7. Advanced Topics</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="launcher-api"><a class="anchor" href="#launcher-api"></a>7.1. JUnit Platform Launcher API</h3>
<div class="paragraph">
<p>One of the prominent goals of JUnit 5 is to make the interface between JUnit and its
programmatic clients – build tools and IDEs – more powerful and stable. The purpose is to
decouple the internals of discovering and executing tests from all the filtering and
configuration that&#8217;s necessary from the outside.</p>
</div>
<div class="paragraph">
<p>JUnit 5 introduces the concept of a <code>Launcher</code> that can be used to discover, filter, and
execute tests. Moreover, third party test libraries – like Spock, Cucumber, and FitNesse
– can plug into the JUnit Platform&#8217;s launching infrastructure by providing a custom
<code><a href="https://junit.org/junit5/docs/5.2.0/api/org/junit/platform/engine/TestEngine.html">TestEngine</a></code>.</p>
</div>
<div class="paragraph">
<p>The launching API is in the <code><a href="https://junit.org/junit5/docs/5.2.0/api/org/junit/platform/launcher/package-summary.html">junit-platform-launcher</a></code> module.</p>
</div>
<div class="paragraph">
<p>An example consumer of the launching API is the <code><a href="https://junit.org/junit5/docs/5.2.0/api/org/junit/platform/console/ConsoleLauncher.html">ConsoleLauncher</a></code> in the
<code><a href="https://junit.org/junit5/docs/5.2.0/api/org/junit/platform/console/package-summary.html">junit-platform-console</a></code> project.</p>
</div>
<div class="sect3">
<h4 id="launcher-api-discovery"><a class="anchor" href="#launcher-api-discovery"></a>7.1.1. Discovering Tests</h4>
<div class="paragraph">
<p>Introducing <em>test discovery</em> as a dedicated feature of the platform itself will
(hopefully) free IDEs and build tools from most of the difficulties they had to go
through to identify test classes and test methods in the past.</p>
</div>
<div class="paragraph">
<p>Usage Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">static</span> <span class="include">org.junit.platform.engine.discovery.ClassNameFilter.includeClassNamePatterns</span>;
<span class="keyword">import</span> <span class="include">static</span> <span class="include">org.junit.platform.engine.discovery.DiscoverySelectors.selectClass</span>;
<span class="keyword">import</span> <span class="include">static</span> <span class="include">org.junit.platform.engine.discovery.DiscoverySelectors.selectPackage</span>;

<span class="keyword">import</span> <span class="include">org.junit.platform.launcher.Launcher</span>;
<span class="keyword">import</span> <span class="include">org.junit.platform.launcher.LauncherDiscoveryRequest</span>;
<span class="keyword">import</span> <span class="include">org.junit.platform.launcher.TestExecutionListener</span>;
<span class="keyword">import</span> <span class="include">org.junit.platform.launcher.TestPlan</span>;
<span class="keyword">import</span> <span class="include">org.junit.platform.launcher.core.LauncherDiscoveryRequestBuilder</span>;
<span class="keyword">import</span> <span class="include">org.junit.platform.launcher.core.LauncherFactory</span>;
<span class="keyword">import</span> <span class="include">org.junit.platform.launcher.listeners.SummaryGeneratingListener</span>;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">LauncherDiscoveryRequest request = LauncherDiscoveryRequestBuilder.request()
    .selectors(
        selectPackage(<span class="string"><span class="delimiter">&quot;</span><span class="content">com.example.mytests</span><span class="delimiter">&quot;</span></span>),
        selectClass(MyTestClass.class)
    )
    .filters(
        includeClassNamePatterns(<span class="string"><span class="delimiter">&quot;</span><span class="content">.*Tests</span><span class="delimiter">&quot;</span></span>)
    )
    .build();

Launcher launcher = LauncherFactory.create();

TestPlan testPlan = launcher.discover(request);</code></pre>
</div>
</div>
<div class="paragraph">
<p>There&#8217;s currently the possibility to select classes, methods, and all classes in a
package or even search for all tests in the classpath. Discovery takes place across all
participating test engines.</p>
</div>
<div class="paragraph">
<p>The resulting <code>TestPlan</code> is a hierarchical (and read-only) description of all engines,
classes, and test methods that fit the <code>LauncherDiscoveryRequest</code>. The client can
traverse the tree, retrieve details about a node, and get a link to the original source
(like class, method, or file position). Every node in the test plan has a <em>unique ID</em>
that can be used to invoke a particular test or group of tests.</p>
</div>
</div>
<div class="sect3">
<h4 id="launcher-api-execution"><a class="anchor" href="#launcher-api-execution"></a>7.1.2. Executing Tests</h4>
<div class="paragraph">
<p>To execute tests, clients can use the same <code>LauncherDiscoveryRequest</code> as in the discovery
phase or create a new request. Test progress and reporting can be achieved by registering
one or more <code><a href="https://junit.org/junit5/docs/5.2.0/api/org/junit/platform/launcher/TestExecutionListener.html">TestExecutionListener</a></code> implementations with the <code>Launcher</code> as in the
following example.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">LauncherDiscoveryRequest request = LauncherDiscoveryRequestBuilder.request()
    .selectors(
        selectPackage(<span class="string"><span class="delimiter">&quot;</span><span class="content">com.example.mytests</span><span class="delimiter">&quot;</span></span>),
        selectClass(MyTestClass.class)
    )
    .filters(
        includeClassNamePatterns(<span class="string"><span class="delimiter">&quot;</span><span class="content">.*Tests</span><span class="delimiter">&quot;</span></span>)
    )
    .build();

Launcher launcher = LauncherFactory.create();

<span class="comment">// Register a listener of your choice</span>
TestExecutionListener listener = <span class="keyword">new</span> SummaryGeneratingListener();
launcher.registerTestExecutionListeners(listener);

launcher.execute(request);</code></pre>
</div>
</div>
<div class="paragraph">
<p>There is no return value for the <code>execute()</code> method, but you can easily use a listener to
aggregate the final results in an object of your own. For an example see the
<code><a href="https://junit.org/junit5/docs/5.2.0/api/org/junit/platform/launcher/listeners/SummaryGeneratingListener.html">SummaryGeneratingListener</a></code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="launcher-api-engines-custom"><a class="anchor" href="#launcher-api-engines-custom"></a>7.1.3. Plugging in Your Own Test Engine</h4>
<div class="paragraph">
<p>JUnit currently provides two <code><a href="https://junit.org/junit5/docs/5.2.0/api/org/junit/platform/engine/TestEngine.html">TestEngine</a></code> implementations out of the box:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code><a href="https://junit.org/junit5/docs/5.2.0/api/org/junit/jupiter/engine/package-summary.html">junit-jupiter-engine</a></code>: The core of JUnit Jupiter.</p>
</li>
<li>
<p><code><a href="https://junit.org/junit5/docs/5.2.0/api/org/junit/vintage/engine/package-summary.html">junit-vintage-engine</a></code>: A thin layer on top of JUnit 4 to allow running <em>vintage</em>
tests with the launcher infrastructure.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Third parties may also contribute their own <code>TestEngine</code> by implementing the interfaces
in the <a href="https://junit.org/junit5/docs/5.2.0/api/org/junit/platform/engine/package-summary.html">junit-platform-engine</a> module and <em>registering</em> their engine. Engine registration
is currently supported via Java&#8217;s <code>java.util.ServiceLoader</code> mechanism. For example, the
<code>junit-jupiter-engine</code> module registers its <code>org.junit.jupiter.engine.JupiterTestEngine</code>
in a file named <code>org.junit.platform.engine.TestEngine</code> within the <code>/META-INF/services</code> in
the <code>junit-jupiter-engine</code> JAR.</p>
</div>
</div>
<div class="sect3">
<h4 id="launcher-api-listeners-custom"><a class="anchor" href="#launcher-api-listeners-custom"></a>7.1.4. Plugging in Your Own Test Execution Listeners</h4>
<div class="paragraph">
<p>In addition to the public <code><a href="https://junit.org/junit5/docs/5.2.0/api/org/junit/platform/launcher/Launcher.html">Launcher</a></code> API method for registering test execution
listeners programmatically, custom <code><a href="https://junit.org/junit5/docs/5.2.0/api/org/junit/platform/launcher/TestExecutionListener.html">TestExecutionListener</a></code> implementations discovered
at runtime via Java&#8217;s <code>java.util.ServiceLoader</code> facility are automatically registered
with the <code>DefaultLauncher</code>. For example, an <code>example.TestInfoPrinter</code> class
implementing <code><a href="https://junit.org/junit5/docs/5.2.0/api/org/junit/platform/launcher/TestExecutionListener.html">TestExecutionListener</a></code> and declared within the
<code>/META-INF/services/org.junit.platform.launcher.TestExecutionListener</code> file is loaded
and registered automatically.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="api-evolution"><a class="anchor" href="#api-evolution"></a>8. APIの進化</h2>
<div class="sectionbody">
<div class="paragraph">
<p>JUnit 5の主要な目的の1つは、JUnitが多くのプロジェクトで使われていたとしても、
メンテナがJUnitを進化させられるようにすることです。
JUnit 4では多くの部品が元々は内部用途で追加されましたが、
外部の拡張機能やツールの作者から使われることになりました。
そのせいで、JUnit 4の変更はとりわけ難しく、ときには不可能になりました。</p>
</div>
<div class="paragraph">
<p>JUnit 5がすべての公開インターフェースやクラス、メソッドに対して明確に定義された
ライフサイクルを導入したのはこのためです。</p>
</div>
<div class="sect2">
<h3 id="api-evolution-version-and-status"><a class="anchor" href="#api-evolution-version-and-status"></a>8.1. APIバージョンとステータス</h3>
<div class="paragraph">
<p>公開されているモジュールは <code>&lt;major&gt;.&lt;minor&gt;.&lt;patch&gt;</code> というバージョン番号をもち、
すべての公開インターフェース、クラス、メソッドには <a href="https://github.com/apiguardian-team/apiguardian">@API Guardian</a> プロジェクトの
<a href="https://apiguardian-team.github.io/apiguardian/docs/current/api/">@API</a> アノテーションが付与されています。このアノテーションの <code>status</code> 属性には、
次のいずれかの値が設定されています。</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">ステータス</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>INTERNAL</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">JUnit自身以外のコードで使ってはならない。事前予告なしに削除されうる。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>DEPRECATED</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">もう使うべきではない。次のマイナー (minor) リリースで削除されうる。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>EXPERIMENTAL</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">フィードバックがほしい実験的な新機能を意味する。注意して使うべき。<br>
                     将来 <code>MAINTAINED</code> または <code>STABLE</code> に昇格される可能性がある一方で、
                     パッチ (patch) リリースでも事前予告なしに削除されうる。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>MAINTAINED</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">現在のメジャー (major) バージョンの <strong>少なくとも</strong> 次のマイナー (minor)
                     リリースでは、後方互換性がない方法で変更されることがない機能を意味する。
                     削除予定になった場合は、まず最初に <code>DEPRECATED</code> に降格される。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>STABLE</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">現在のメジャーバージョン (<code>5.*</code>) の間は、
                     後方互換性がない方法で変更されることがない機能を意味する。</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><code>@API</code> アノテーションが型に付与された場合、その型のすべての公開メンバーに適用されているとみなします。
個々のメンバーは、より低い安定度をもつ異なる <code>status</code> 属性を宣言することができます。</p>
</div>
</div>
<div class="sect2">
<h3 id="api-evolution-experimental-apis"><a class="anchor" href="#api-evolution-experimental-apis"></a>8.2. 実験的なAPI</h3>
<div class="paragraph">
<p>次の表は、現在 <em>実験的</em> (<code>@API(status = EXPERIMENTAL)</code>) と指定されたAPIを一覧しています。
これらのAPIを使う場合は注意してください。</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Package Name</th>
<th class="tableblock halign-left valign-top">Class Name</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.jupiter.api</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>AssertionsKt</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>class</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.jupiter.api</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>DynamicContainer</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>class</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.jupiter.api</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>DynamicNode</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>class</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.jupiter.api</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>DynamicTest</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>class</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.jupiter.api</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>TestFactory</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>annotation</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.jupiter.api.condition</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>DisabledIf</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>annotation</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.jupiter.api.condition</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>EnabledIf</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>annotation</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.jupiter.api.extension</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ScriptEvaluationException</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>class</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.jupiter.params</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ParameterizedTest</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>annotation</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.jupiter.params.aggregator</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>AggregateWith</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>annotation</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.jupiter.params.aggregator</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ArgumentAccessException</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>class</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.jupiter.params.aggregator</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ArgumentsAccessor</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>interface</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.jupiter.params.aggregator</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ArgumentsAggregationException</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>class</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.jupiter.params.aggregator</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ArgumentsAggregator</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>interface</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.jupiter.params.converter</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ArgumentConversionException</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>class</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.jupiter.params.converter</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ArgumentConverter</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>interface</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.jupiter.params.converter</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ConvertWith</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>annotation</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.jupiter.params.converter</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>JavaTimeConversionPattern</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>annotation</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.jupiter.params.converter</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SimpleArgumentConverter</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>class</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.jupiter.params.provider</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Arguments</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>interface</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.jupiter.params.provider</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ArgumentsProvider</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>interface</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.jupiter.params.provider</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ArgumentsSource</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>annotation</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.jupiter.params.provider</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ArgumentsSources</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>annotation</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.jupiter.params.provider</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CsvFileSource</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>annotation</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.jupiter.params.provider</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CsvSource</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>annotation</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.jupiter.params.provider</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>EnumSource</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>annotation</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.jupiter.params.provider</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>MethodSource</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>annotation</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.jupiter.params.provider</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ValueSource</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>annotation</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.jupiter.params.support</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>AnnotationConsumer</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>interface</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.junit.platform.engine.discovery</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ModuleSelector</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>class</code></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="api-evolution-tooling"><a class="anchor" href="#api-evolution-tooling"></a>8.3. @APIツールサポート</h3>
<div class="paragraph">
<p><a href="https://github.com/apiguardian-team/apiguardian">@API Guardian</a> プロジェクトは、 <a href="https://apiguardian-team.github.io/apiguardian/docs/current/api/">@API</a> アノテーションが付与されたAPIの提供者や利用者のために、
ツールによるサポートを計画しています。例えば、JUnitのAPIが <code>@API</code>
アノテーションの宣言にしたがって使われているかをチェックする手段を提供するなどです。</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="contributors"><a class="anchor" href="#contributors"></a>9. コントリビューター</h2>
<div class="sectionbody">
<div class="paragraph">
<p>GitHubで直接 <a href="https://github.com/junit-team/junit5/graphs/contributors">現在のコントリビューター</a> を参照してください。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="release-notes"><a class="anchor" href="#release-notes"></a>10. リリースノート</h2>
<div class="sectionbody">
<div class="paragraph">
<p>リリースノートは、 <a href="../release-notes/index.html#release-notes">こちら</a> から参照できます。</p>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Version 5.2.0<br>
Last updated 2018-06-08 23:12:27 JST
</div>
</div>
</body>
</html>